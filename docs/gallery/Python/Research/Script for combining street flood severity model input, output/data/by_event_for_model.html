

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Intro &mdash; CUAHSI Gallery</title>
  

  
  <link rel="stylesheet" href="../../../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../_static/graphviz.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../_static/copybutton.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../_static/tabs.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../_static/css/custom.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../_static/panels-bootstrap.5fd3999ee7762ccc51105388f4a9d115.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../_static/contentui.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../_static/sphinxcontrib-images/LightBox2/lightbox2/css/lightbox.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../../../" src="../../../../../_static/documentation_options.js"></script>
        <script src="../../../../../_static/jquery.js"></script>
        <script src="../../../../../_static/underscore.js"></script>
        <script src="../../../../../_static/doctools.js"></script>
        <script src="../../../../../_static/language_data.js"></script>
        <script src="../../../../../_static/clipboard.min.js"></script>
        <script src="../../../../../_static/copybutton.js"></script>
        <script src="../../../../../_static/js/custom.js"></script>
        <script src="../../../../../_static/contentui.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
        <script src="../../../../../_static/sphinxcontrib-images/LightBox2/lightbox2/js/jquery-1.11.0.min.js"></script>
        <script src="../../../../../_static/sphinxcontrib-images/LightBox2/lightbox2/js/lightbox.min.js"></script>
        <script src="../../../../../_static/sphinxcontrib-images/LightBox2/lightbox2-customize/jquery-noconflict.js"></script>
    
    <script type="text/javascript" src="../../../../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../../../index.html">
          

          
            
            <img src="../../../../../_static/cuahsi-logo.png" class="logo" alt="Logo"/>
          
          </a>

          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Galleries</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../index.html">Python</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../index.html#research-examples">Research Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../index.html#reproducible-science-examples">Reproducible Science Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../index.html#instructional-examples">Instructional Examples</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../R/index.html">R</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../R/index.html#instructional-examples">Instructional Examples</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../RShiny/index.html">RShiny</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../RShiny/index.html#research-examples">Research Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../RShiny/index.html#instructional-examples">Instructional Examples</a></li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../../index.html">CUAHSI Gallery</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          <!--
The purpose of this template is to override (i.e. supress) the breadcrumbs that appear at the top of each page.
-->


          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container,
div.nbinput.container div.prompt,
div.nbinput.container div.input_area,
div.nbinput.container div[class*=highlight],
div.nbinput.container div[class*=highlight] pre,
div.nboutput.container,
div.nboutput.container div.prompt,
div.nboutput.container div.output_area,
div.nboutput.container div[class*=highlight],
div.nboutput.container div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    background: #f5f5f5;
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="Intro">
<h1>Intro<a class="headerlink" href="#Intro" title="Permalink to this headline">¶</a></h1>
<p>This notebook aggregates the environmental data by event whereas before we were looking at the data by date.</p>
<div class="section" id="Calculate-number-of-locations-that-flooded">
<h2>Calculate number of locations that flooded<a class="headerlink" href="#Calculate-number-of-locations-that-flooded" title="Permalink to this headline">¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="n">module_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;..&#39;</span><span class="p">))</span>
<span class="k">if</span> <span class="n">module_path</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="p">:</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">module_path</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">focus_intersection</span> <span class="kn">import</span> <span class="n">subset_floods</span><span class="p">,</span> <span class="n">flood_df</span><span class="p">,</span> <span class="n">subset_locations</span>
<span class="kn">from</span> <span class="nn">main_db_script</span> <span class="kn">import</span> <span class="n">data_dir</span><span class="p">,</span> <span class="n">db_filename</span>
<span class="kn">from</span> <span class="nn">hr_db_scripts.main_db_script</span> <span class="kn">import</span> <span class="n">get_table_for_variable_code</span><span class="p">,</span> <span class="n">get_db_table_as_df</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">sqlite3</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="n">con</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">db_filename</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">mode</span><span class="o">.</span><span class="n">chained_assignment</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># default=&#39;warn&#39;</span>
</pre></div>
</div>
</div>
<p>In this case we are just focusing on the subset of points that is in the downtown area thus the “subset_floods.”</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="n">flood_events</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;flood_events.csv&#39;</span><span class="p">)</span>
<span class="n">flood_events</span><span class="p">[</span><span class="s1">&#39;event_date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">flood_events</span><span class="p">[</span><span class="s1">&#39;event_date&#39;</span><span class="p">])</span>
<span class="n">flood_events</span><span class="p">[</span><span class="s1">&#39;event_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">flood_events</span><span class="p">[</span><span class="s1">&#39;event_name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
<span class="n">flood_events</span><span class="p">[</span><span class="s1">&#39;dates&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">flood_events</span><span class="p">[</span><span class="s1">&#39;dates&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="n">grouped</span> <span class="o">=</span> <span class="n">flood_events</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;event_date&#39;</span><span class="p">,</span> <span class="s1">&#39;event_name&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<p>Get the number of dates the event spanned, the number of unique locations that were flooded during the event and the total number of locations flooded on all event dates.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="n">event_total_flooded</span> <span class="o">=</span> <span class="n">grouped</span><span class="o">.</span><span class="n">size</span><span class="p">()</span>
<span class="n">event_dates</span> <span class="o">=</span> <span class="n">grouped</span><span class="p">[</span><span class="s1">&#39;dates&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
<span class="n">num_event_dates</span> <span class="o">=</span> <span class="n">grouped</span><span class="p">[</span><span class="s1">&#39;dates&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span>
<span class="n">num_locations</span> <span class="o">=</span> <span class="n">grouped</span><span class="p">[</span><span class="s1">&#39;location&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="n">event_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">event_dates</span><span class="p">,</span> <span class="n">event_total_flooded</span><span class="p">,</span> <span class="n">num_event_dates</span><span class="p">,</span> <span class="n">num_locations</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">event_df</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;dates&#39;</span><span class="p">,</span> <span class="s1">&#39;num_flooded&#39;</span><span class="p">,</span> <span class="s1">&#39;num_dates&#39;</span><span class="p">,</span> <span class="s1">&#39;num_locations&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="n">event_df</span><span class="o">.</span><span class="n">tail</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>dates</th>
      <th>num_flooded</th>
      <th>num_dates</th>
      <th>num_locations</th>
    </tr>
    <tr>
      <th>event_date</th>
      <th>event_name</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2016-07-31</th>
      <th>Thunderstorm-2016-07-31</th>
      <td>[2016-07-31T00:00:00.000000000]</td>
      <td>8</td>
      <td>1</td>
      <td>8</td>
    </tr>
    <tr>
      <th>2016-09-02</th>
      <th>HERMINE-2016-09-02</th>
      <td>[2016-09-03T00:00:00.000000000, 2016-09-04T00:...</td>
      <td>40</td>
      <td>2</td>
      <td>40</td>
    </tr>
    <tr>
      <th>2016-09-19</th>
      <th>HEAVY RAIN-2016-09-19</th>
      <td>[2016-09-19T00:00:00.000000000]</td>
      <td>11</td>
      <td>1</td>
      <td>11</td>
    </tr>
    <tr>
      <th>2016-09-20</th>
      <th>unnamed-2016-09-20</th>
      <td>[2016-09-21T00:00:00.000000000, 2016-09-22T00:...</td>
      <td>101</td>
      <td>4</td>
      <td>101</td>
    </tr>
    <tr>
      <th>2016-10-05</th>
      <th>Hurricane Matthew-2016-10-05</th>
      <td>[2016-10-05T00:00:00.000000000, 2016-10-08T00:...</td>
      <td>111</td>
      <td>7</td>
      <td>109</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</div>
<div class="section" id="Where-num_flooded-does-not-equal-num_locations-investigation">
<h2>Where num_flooded does not equal num_locations <em>investigation</em><a class="headerlink" href="#Where-num_flooded-does-not-equal-num_locations-investigation" title="Permalink to this headline">¶</a></h2>
<p>Let’s checkout one of the events where the num_flooded is greater than the num_locations. I would expect this to mean that one location was flooded on multiple days of the same event. But for ‘2014-07-24’ the event is only on one day so that isn’t what I expected.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="n">idx</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">IndexSlice</span>
<span class="n">event_df</span><span class="o">.</span><span class="n">sort_index</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">event_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span><span class="p">[</span><span class="s1">&#39;2014-07-24&#39;</span><span class="p">,</span> <span class="p">:],</span> <span class="p">:]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>dates</th>
      <th>num_flooded</th>
      <th>num_dates</th>
      <th>num_locations</th>
    </tr>
    <tr>
      <th>event_date</th>
      <th>event_name</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2014-07-24</th>
      <th>unnamed-2014-07-24</th>
      <td>[2014-07-24T00:00:00.000000000, 2014-07-26T00:...</td>
      <td>18</td>
      <td>2</td>
      <td>17</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="n">fl_724</span> <span class="o">=</span> <span class="n">flood_events</span><span class="p">[</span><span class="n">flood_events</span><span class="p">[</span><span class="s1">&#39;dates&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;2014-07-24&#39;</span><span class="p">]</span>
<span class="n">fl_724</span><span class="p">[</span><span class="n">fl_724</span><span class="p">[</span><span class="s1">&#39;location&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">duplicated</span><span class="p">(</span><span class="n">keep</span><span class="o">=</span><span class="kc">False</span><span class="p">)]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Unnamed: 0</th>
      <th>location</th>
      <th>eventType</th>
      <th>dt</th>
      <th>event_name</th>
      <th>event_date</th>
      <th>dates</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>444</th>
      <td>444</td>
      <td>HAMPTON BOULEVARD &amp; W 21ST STREET</td>
      <td>Flooded street</td>
      <td>2014-07-24 20:29:25</td>
      <td>unnamed-2014-07-24</td>
      <td>2014-07-24</td>
      <td>2014-07-24</td>
    </tr>
    <tr>
      <th>445</th>
      <td>445</td>
      <td>HAMPTON BOULEVARD &amp; W 21ST STREET</td>
      <td>Flooded underpass</td>
      <td>2014-07-24 20:29:25</td>
      <td>unnamed-2014-07-24</td>
      <td>2014-07-24</td>
      <td>2014-07-24</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>So <em>here’s</em> what is happening. The location name is the same in two rows but there are two different event types: “flooded street” and “flooded underpass.” Now that I think about it, that may explain all the differences between the num_location and num_flooded columns. Let’s try another one, this time one that spans more than one day: Irene.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="n">event_df</span><span class="o">.</span><span class="n">sort_index</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">event_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span><span class="p">[:,</span> <span class="s1">&#39;Irene-2011-08-27&#39;</span><span class="p">],</span> <span class="p">:]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>dates</th>
      <th>num_flooded</th>
      <th>num_dates</th>
      <th>num_locations</th>
    </tr>
    <tr>
      <th>event_date</th>
      <th>event_name</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2011-08-27</th>
      <th>Irene-2011-08-27</th>
      <td>[2011-08-24T00:00:00.000000000, 2011-08-27T00:...</td>
      <td>110</td>
      <td>4</td>
      <td>108</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="n">irene</span> <span class="o">=</span> <span class="n">flood_events</span><span class="p">[</span><span class="n">flood_events</span><span class="p">[</span><span class="s1">&#39;event_name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;Irene&#39;</span><span class="p">)]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;location&#39;</span><span class="p">)</span>
<span class="n">irene</span><span class="p">[</span><span class="n">irene</span><span class="p">[</span><span class="s1">&#39;location&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">duplicated</span><span class="p">(</span><span class="n">keep</span><span class="o">=</span><span class="kc">False</span><span class="p">)]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Unnamed: 0</th>
      <th>location</th>
      <th>eventType</th>
      <th>dt</th>
      <th>event_name</th>
      <th>event_date</th>
      <th>dates</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>181</th>
      <td>181</td>
      <td>1000 BLOCK OF E VIRGINIA BEACH BOULEVARD</td>
      <td>Flooded street</td>
      <td>2011-08-28 04:18:01</td>
      <td>Irene-2011-08-27</td>
      <td>2011-08-27</td>
      <td>2011-08-28</td>
    </tr>
    <tr>
      <th>182</th>
      <td>182</td>
      <td>1000 BLOCK OF E VIRGINIA BEACH BOULEVARD</td>
      <td>Flooded underpass</td>
      <td>2011-08-28 04:18:01</td>
      <td>Irene-2011-08-27</td>
      <td>2011-08-27</td>
      <td>2011-08-28</td>
    </tr>
    <tr>
      <th>185</th>
      <td>185</td>
      <td>E 21ST STREET &amp; MONTICELLO AVENUE</td>
      <td>Flooded underpass</td>
      <td>2011-08-28 08:44:35</td>
      <td>Irene-2011-08-27</td>
      <td>2011-08-27</td>
      <td>2011-08-28</td>
    </tr>
    <tr>
      <th>104</th>
      <td>104</td>
      <td>E 21ST STREET &amp; MONTICELLO AVENUE</td>
      <td>Flooded street</td>
      <td>2011-08-27 06:08:00</td>
      <td>Irene-2011-08-27</td>
      <td>2011-08-27</td>
      <td>2011-08-27</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>Looks like that’s it. Which is not what I was hoping to show. I was thinking that that tell me something about the variety of locations that were flooded over the days but that’s not the case.</p>
<p>Let’s try this one more time with Hurricane Joaquin</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="n">jqn</span> <span class="o">=</span> <span class="n">flood_df</span><span class="p">[</span><span class="n">flood_df</span><span class="p">[</span><span class="s1">&#39;event&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;Joaquin&#39;</span><span class="p">)]</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="n">jqn</span><span class="p">[</span><span class="n">jqn</span><span class="p">[</span><span class="s1">&#39;location&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">duplicated</span><span class="p">(</span><span class="n">keep</span><span class="o">=</span><span class="kc">False</span><span class="p">)]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Unnamed: 0</th>
      <th>﻿recid</th>
      <th>location</th>
      <th>event</th>
      <th>eventType</th>
      <th>xcoord</th>
      <th>ycoord</th>
      <th>dt</th>
      <th>_date</th>
      <th>_time</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
</div></div>
</div>
<p>So that is interesting. Even though for hurricanes Matthew and Joaquin, the seven and six days respectively, none of the flooded locations were reported twice for one event. Very interesting. So to me, this means we really should be looking at these things by ‘event’ and not by ‘_date’. It also means that the num_locations col doesn’t add any information. So imma delete that.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="k">del</span> <span class="n">event_df</span><span class="p">[</span><span class="s1">&#39;num_locations&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Looking-into-date-in-“event”-column-versus-dates-in-“_date”-column">
<h2>Looking into date in “event” column versus dates in “_date” column<a class="headerlink" href="#Looking-into-date-in-“event”-column-versus-dates-in-“_date”-column" title="Permalink to this headline">¶</a></h2>
<p>Sometimes the date listed in the “event” column is quite different than the date(s) listed in the “_date” column. A good example of this is the event “unnamed (2/25/2016)” where the dates in the “_date” column are 2016-05-05, 2016-05-06, and 2016-05-31”</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="n">flood_df</span><span class="p">[</span><span class="n">flood_df</span><span class="p">[</span><span class="s1">&#39;event&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;2/25/2016&#39;</span><span class="p">)]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Unnamed: 0</th>
      <th>﻿recid</th>
      <th>location</th>
      <th>event</th>
      <th>eventType</th>
      <th>xcoord</th>
      <th>ycoord</th>
      <th>dt</th>
      <th>_date</th>
      <th>_time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>760</th>
      <td>760</td>
      <td>4815</td>
      <td>19TH BAY STREET &amp; PLEASANT AVENUE</td>
      <td>unnamed  (2/25/2016)</td>
      <td>Flooded street</td>
      <td>1.215646e+07</td>
      <td>3.505946e+06</td>
      <td>2016-05-05 20:43:53.000</td>
      <td>2016-05-05</td>
      <td>2016-05-05 20:43:53.000</td>
    </tr>
    <tr>
      <th>761</th>
      <td>761</td>
      <td>4816</td>
      <td>20TH BAY STREET &amp; PLEASANT AVENUE</td>
      <td>unnamed  (2/25/2016)</td>
      <td>Flooded street</td>
      <td>1.215680e+07</td>
      <td>3.505887e+06</td>
      <td>2016-05-05 20:44:41.000</td>
      <td>2016-05-05</td>
      <td>2016-05-05 20:44:41.000</td>
    </tr>
    <tr>
      <th>762</th>
      <td>762</td>
      <td>4817</td>
      <td>BOUSH STREET &amp; W OLNEY ROAD</td>
      <td>unnamed  (2/25/2016)</td>
      <td>Flooded street</td>
      <td>1.212921e+07</td>
      <td>3.478803e+06</td>
      <td>2016-05-05 20:46:10.000</td>
      <td>2016-05-05</td>
      <td>2016-05-05 20:46:10.000</td>
    </tr>
    <tr>
      <th>763</th>
      <td>763</td>
      <td>4818</td>
      <td>900 BLOCK OF E CHARLOTTE STREET</td>
      <td>unnamed  (2/25/2016)</td>
      <td>Flooded street</td>
      <td>1.213223e+07</td>
      <td>3.476292e+06</td>
      <td>2016-05-05 20:51:34.000</td>
      <td>2016-05-05</td>
      <td>2016-05-05 20:51:34.000</td>
    </tr>
    <tr>
      <th>764</th>
      <td>764</td>
      <td>4819</td>
      <td>LLEWELLYN AVENUE &amp; W VIRGINIA BEACH BOULEVARD</td>
      <td>unnamed  (2/25/2016)</td>
      <td>Flooded street</td>
      <td>1.212906e+07</td>
      <td>3.479121e+06</td>
      <td>2016-05-05 20:52:17.000</td>
      <td>2016-05-05</td>
      <td>2016-05-05 20:52:17.000</td>
    </tr>
    <tr>
      <th>765</th>
      <td>765</td>
      <td>4820</td>
      <td>ORLEANS STREET &amp; LAFAYETTE AVENUE</td>
      <td>unnamed  (2/25/2016)</td>
      <td>Flooded street</td>
      <td>1.213787e+07</td>
      <td>3.513103e+06</td>
      <td>2016-05-06 20:51:41.000</td>
      <td>2016-05-06</td>
      <td>2016-05-06 20:51:41.000</td>
    </tr>
    <tr>
      <th>766</th>
      <td>766</td>
      <td>4821</td>
      <td>GRANBY STREET &amp; LLEWELLYN AVENUE</td>
      <td>unnamed  (2/25/2016)</td>
      <td>Flooded street</td>
      <td>1.213187e+07</td>
      <td>3.490070e+06</td>
      <td>2016-05-06 20:52:52.000</td>
      <td>2016-05-06</td>
      <td>2016-05-06 20:52:52.000</td>
    </tr>
    <tr>
      <th>767</th>
      <td>767</td>
      <td>4823</td>
      <td>DUKE STREET &amp; W OLNEY ROAD</td>
      <td>unnamed  (2/25/2016)</td>
      <td>Flooded street</td>
      <td>1.212885e+07</td>
      <td>3.478992e+06</td>
      <td>2016-05-31 08:45:33.000</td>
      <td>2016-05-31</td>
      <td>2016-05-31 08:45:33.000</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>So to look at this more closely, I will calculate the difference in days between the “event” column date and the dates in the “_date” column.</p>
<p>When I tried to calculate the time between the ‘event_date’ and the ‘dates’ to see how far off these were I found that two events had the same ‘event_date’. So I think it’s appropriate to drop the ‘unnamed’ one based on the fact that the dates in the “_date” column are further from the “event_date”.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="n">event_df</span><span class="o">.</span><span class="n">sort_index</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">event_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;2016-07-30&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>dates</th>
      <th>num_flooded</th>
      <th>num_dates</th>
    </tr>
    <tr>
      <th>event_date</th>
      <th>event_name</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">2016-07-30</th>
      <th>Thunderstorm-2016-07-30</th>
      <td>[2016-07-30T00:00:00.000000000]</td>
      <td>4</td>
      <td>1</td>
    </tr>
    <tr>
      <th>unnamed-2016-07-30</th>
      <td>[2016-08-02T00:00:00.000000000, 2016-08-31T00:...</td>
      <td>9</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="n">i</span> <span class="o">=</span> <span class="n">event_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;2016-07-30&#39;</span><span class="p">,</span> <span class="s1">&#39;unnamed-2016-07-30&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">name</span>
<span class="n">event_df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">i</span> <span class="o">=</span> <span class="n">event_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;2014-09-13&#39;</span><span class="p">,</span> <span class="s2">&quot;NAPSG-2014-09-13&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">name</span>
<span class="n">event_df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="n">event_df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">event_df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;event_date&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">event_df</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>event_name</th>
      <th>dates</th>
      <th>num_flooded</th>
      <th>num_dates</th>
    </tr>
    <tr>
      <th>event_date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2010-09-30</th>
      <td>Nicole-2010-09-30</td>
      <td>[2010-09-30T00:00:00.000000000, 2010-10-01T00:...</td>
      <td>101</td>
      <td>3</td>
    </tr>
    <tr>
      <th>2010-12-16</th>
      <td>Snow-2010-12-16</td>
      <td>[2010-12-16T00:00:00.000000000]</td>
      <td>2</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2011-08-27</th>
      <td>Irene-2011-08-27</td>
      <td>[2011-08-24T00:00:00.000000000, 2011-08-27T00:...</td>
      <td>110</td>
      <td>4</td>
    </tr>
    <tr>
      <th>2012-10-28</th>
      <td>Sandy-2012-10-28</td>
      <td>[2012-10-27T00:00:00.000000000, 2012-10-28T00:...</td>
      <td>105</td>
      <td>3</td>
    </tr>
    <tr>
      <th>2013-10-09</th>
      <td>Heavy Rain-2013-10-09</td>
      <td>[2013-10-08T00:00:00.000000000, 2013-10-09T00:...</td>
      <td>36</td>
      <td>3</td>
    </tr>
    <tr>
      <th>2014-05-16</th>
      <td>Heavy Rain-2014-05-16</td>
      <td>[2014-05-16T00:00:00.000000000]</td>
      <td>35</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2014-06-09</th>
      <td>unnamed-2014-06-09</td>
      <td>[2014-06-09T00:00:00.000000000]</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2014-06-19</th>
      <td>Thunderstorms-2014-06-19</td>
      <td>[2014-06-20T00:00:00.000000000]</td>
      <td>5</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2014-07-03</th>
      <td>Arthur-2014-07-03</td>
      <td>[2014-07-04T00:00:00.000000000]</td>
      <td>8</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2014-07-09</th>
      <td>Thunderstorms-2014-07-09</td>
      <td>[2014-07-09T00:00:00.000000000]</td>
      <td>2</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2014-07-10</th>
      <td>7/10 Thunderstorms-2014-07-10</td>
      <td>[2014-07-10T00:00:00.000000000]</td>
      <td>39</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2014-07-24</th>
      <td>unnamed-2014-07-24</td>
      <td>[2014-07-24T00:00:00.000000000, 2014-07-26T00:...</td>
      <td>18</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2014-08-18</th>
      <td>AUG 18 2014-2014-08-18</td>
      <td>[2014-08-18T00:00:00.000000000]</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2014-09-04</th>
      <td>Thunderstorm-2014-09-04</td>
      <td>[2014-09-04T00:00:00.000000000]</td>
      <td>5</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2014-09-08</th>
      <td>Rainy Monday-2014-09-08</td>
      <td>[2014-09-08T00:00:00.000000000, 2014-09-09T00:...</td>
      <td>31</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2014-09-13</th>
      <td>Saturday Storm 9/13-2014-09-13</td>
      <td>[2014-09-13T00:00:00.000000000]</td>
      <td>3</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2014-09-24</th>
      <td>HEAVY RAIN-2014-09-24</td>
      <td>[2014-09-24T00:00:00.000000000]</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2014-09-29</th>
      <td>unnamed-2014-09-29</td>
      <td>[2014-11-01T00:00:00.000000000]</td>
      <td>2</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2014-11-17</th>
      <td>STORM 11/17/14-2014-11-17</td>
      <td>[2014-11-17T00:00:00.000000000]</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2014-11-23</th>
      <td>unnamed-2014-11-23</td>
      <td>[2014-12-24T00:00:00.000000000, 2015-01-18T00:...</td>
      <td>4</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2015-03-02</th>
      <td>unnamed-2015-03-02</td>
      <td>[2015-04-14T00:00:00.000000000, 2015-06-02T00:...</td>
      <td>10</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2015-07-02</th>
      <td>unnamed-2015-07-02</td>
      <td>[2015-07-04T00:00:00.000000000, 2015-07-11T00:...</td>
      <td>7</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2015-07-11</th>
      <td>Thunderstorm-2015-07-11</td>
      <td>[2015-07-11T00:00:00.000000000]</td>
      <td>10</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2015-09-02</th>
      <td>09/02/15-2015-09-02</td>
      <td>[2015-09-02T00:00:00.000000000]</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2015-09-17</th>
      <td>unnamed-2015-09-17</td>
      <td>[2015-09-23T00:00:00.000000000]</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2015-09-24</th>
      <td>Noreaster-2015-09-24</td>
      <td>[2015-09-24T00:00:00.000000000, 2015-09-25T00:...</td>
      <td>16</td>
      <td>4</td>
    </tr>
    <tr>
      <th>2015-09-29</th>
      <td>Joaquin-2015-09-29</td>
      <td>[2015-09-30T00:00:00.000000000, 2015-10-01T00:...</td>
      <td>159</td>
      <td>6</td>
    </tr>
    <tr>
      <th>2015-10-30</th>
      <td>unnamed-2015-10-30</td>
      <td>[2015-12-10T00:00:00.000000000]</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2015-12-30</th>
      <td>Heavy Rainfall-2015-12-30</td>
      <td>[2015-12-30T00:00:00.000000000]</td>
      <td>3</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2016-01-15</th>
      <td>01/15/2016-2016-01-15</td>
      <td>[2016-01-15T00:00:00.000000000]</td>
      <td>6</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2016-01-20</th>
      <td>Jan Winter Weather-2016-01-20</td>
      <td>[2016-01-22T00:00:00.000000000, 2016-01-23T00:...</td>
      <td>26</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2016-02-01</th>
      <td>unnamed-2016-02-01</td>
      <td>[2016-02-04T00:00:00.000000000, 2016-02-05T00:...</td>
      <td>5</td>
      <td>3</td>
    </tr>
    <tr>
      <th>2016-02-24</th>
      <td>February 24th Storm-2016-02-24</td>
      <td>[2016-02-24T00:00:00.000000000]</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2016-02-25</th>
      <td>unnamed-2016-02-25</td>
      <td>[2016-05-05T00:00:00.000000000, 2016-05-06T00:...</td>
      <td>8</td>
      <td>3</td>
    </tr>
    <tr>
      <th>2016-06-03</th>
      <td>Severe Weather - 6/5-2016-06-03</td>
      <td>[2016-06-05T00:00:00.000000000]</td>
      <td>6</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2016-06-10</th>
      <td>unnamed-2016-06-10</td>
      <td>[2016-07-01T00:00:00.000000000]</td>
      <td>2</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2016-07-19</th>
      <td>Thunderstorm-2016-07-19</td>
      <td>[2016-07-19T00:00:00.000000000]</td>
      <td>9</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2016-07-20</th>
      <td>unnamed-2016-07-20</td>
      <td>[2016-07-20T00:00:00.000000000]</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2016-07-25</th>
      <td>Bernie (Training)-2016-07-25</td>
      <td>[2016-07-25T00:00:00.000000000]</td>
      <td>2</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2016-07-30</th>
      <td>Thunderstorm-2016-07-30</td>
      <td>[2016-07-30T00:00:00.000000000]</td>
      <td>4</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2016-07-31</th>
      <td>Thunderstorm-2016-07-31</td>
      <td>[2016-07-31T00:00:00.000000000]</td>
      <td>8</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2016-09-02</th>
      <td>HERMINE-2016-09-02</td>
      <td>[2016-09-03T00:00:00.000000000, 2016-09-04T00:...</td>
      <td>40</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2016-09-19</th>
      <td>HEAVY RAIN-2016-09-19</td>
      <td>[2016-09-19T00:00:00.000000000]</td>
      <td>11</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2016-09-20</th>
      <td>unnamed-2016-09-20</td>
      <td>[2016-09-21T00:00:00.000000000, 2016-09-22T00:...</td>
      <td>101</td>
      <td>4</td>
    </tr>
    <tr>
      <th>2016-10-05</th>
      <td>Hurricane Matthew-2016-10-05</td>
      <td>[2016-10-05T00:00:00.000000000, 2016-10-08T00:...</td>
      <td>111</td>
      <td>7</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="n">days_away</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">max_days</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">event_df</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">ar</span> <span class="o">=</span> <span class="n">event_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">d</span><span class="p">,</span> <span class="s1">&#39;dates&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">datetime64</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
        <span class="n">ar</span> <span class="o">=</span> <span class="n">ar</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;timedelta64[D]&#39;</span><span class="p">)</span>
        <span class="n">days</span> <span class="o">=</span> <span class="n">ar</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">timedelta64</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">)</span>
        <span class="n">days_away</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">days</span><span class="p">)</span>
        <span class="n">max_days</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">days</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
        <span class="nb">print</span> <span class="n">d</span>
<span class="n">event_df</span><span class="p">[</span><span class="s1">&#39;days_away_from_event&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">days_away</span>
<span class="n">event_df</span><span class="p">[</span><span class="s1">&#39;max_days_away&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">max_days</span>
<span class="nb">print</span> <span class="n">event_df</span><span class="o">.</span><span class="n">shape</span>
<span class="n">event_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(45, 6)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>event_name</th>
      <th>dates</th>
      <th>num_flooded</th>
      <th>num_dates</th>
      <th>days_away_from_event</th>
      <th>max_days_away</th>
    </tr>
    <tr>
      <th>event_date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2010-09-30</th>
      <td>Nicole-2010-09-30</td>
      <td>[2010-09-30T00:00:00.000000000, 2010-10-01T00:...</td>
      <td>101</td>
      <td>3</td>
      <td>[0.0, 1.0, 4.0]</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>2010-12-16</th>
      <td>Snow-2010-12-16</td>
      <td>[2010-12-16T00:00:00.000000000]</td>
      <td>2</td>
      <td>1</td>
      <td>[0.0]</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2011-08-27</th>
      <td>Irene-2011-08-27</td>
      <td>[2011-08-24T00:00:00.000000000, 2011-08-27T00:...</td>
      <td>110</td>
      <td>4</td>
      <td>[-3.0, 0.0, 1.0, 2.0]</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>2012-10-28</th>
      <td>Sandy-2012-10-28</td>
      <td>[2012-10-27T00:00:00.000000000, 2012-10-28T00:...</td>
      <td>105</td>
      <td>3</td>
      <td>[-1.0, 0.0, 1.0]</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>2013-10-09</th>
      <td>Heavy Rain-2013-10-09</td>
      <td>[2013-10-08T00:00:00.000000000, 2013-10-09T00:...</td>
      <td>36</td>
      <td>3</td>
      <td>[-1.0, 0.0, 1.0]</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>I don’t trust the events that have higher days away so I will disregard any event with a “max_days_away” greater than 10. Five events fall under this category.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># event_df = event_df[event_df[&#39;max_days_away&#39;]&lt;10]</span>
<span class="nb">print</span> <span class="n">event_df</span><span class="o">.</span><span class="n">shape</span>
<span class="n">event_df</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(45, 6)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>event_name</th>
      <th>dates</th>
      <th>num_flooded</th>
      <th>num_dates</th>
      <th>days_away_from_event</th>
      <th>max_days_away</th>
    </tr>
    <tr>
      <th>event_date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2010-09-30</th>
      <td>Nicole-2010-09-30</td>
      <td>[2010-09-30T00:00:00.000000000, 2010-10-01T00:...</td>
      <td>101</td>
      <td>3</td>
      <td>[0.0, 1.0, 4.0]</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>2010-12-16</th>
      <td>Snow-2010-12-16</td>
      <td>[2010-12-16T00:00:00.000000000]</td>
      <td>2</td>
      <td>1</td>
      <td>[0.0]</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2011-08-27</th>
      <td>Irene-2011-08-27</td>
      <td>[2011-08-24T00:00:00.000000000, 2011-08-27T00:...</td>
      <td>110</td>
      <td>4</td>
      <td>[-3.0, 0.0, 1.0, 2.0]</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>2012-10-28</th>
      <td>Sandy-2012-10-28</td>
      <td>[2012-10-27T00:00:00.000000000, 2012-10-28T00:...</td>
      <td>105</td>
      <td>3</td>
      <td>[-1.0, 0.0, 1.0]</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>2013-10-09</th>
      <td>Heavy Rain-2013-10-09</td>
      <td>[2013-10-08T00:00:00.000000000, 2013-10-09T00:...</td>
      <td>36</td>
      <td>3</td>
      <td>[-1.0, 0.0, 1.0]</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>2014-05-16</th>
      <td>Heavy Rain-2014-05-16</td>
      <td>[2014-05-16T00:00:00.000000000]</td>
      <td>35</td>
      <td>1</td>
      <td>[0.0]</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2014-06-09</th>
      <td>unnamed-2014-06-09</td>
      <td>[2014-06-09T00:00:00.000000000]</td>
      <td>1</td>
      <td>1</td>
      <td>[0.0]</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2014-06-19</th>
      <td>Thunderstorms-2014-06-19</td>
      <td>[2014-06-20T00:00:00.000000000]</td>
      <td>5</td>
      <td>1</td>
      <td>[1.0]</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>2014-07-03</th>
      <td>Arthur-2014-07-03</td>
      <td>[2014-07-04T00:00:00.000000000]</td>
      <td>8</td>
      <td>1</td>
      <td>[1.0]</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>2014-07-09</th>
      <td>Thunderstorms-2014-07-09</td>
      <td>[2014-07-09T00:00:00.000000000]</td>
      <td>2</td>
      <td>1</td>
      <td>[0.0]</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2014-07-10</th>
      <td>7/10 Thunderstorms-2014-07-10</td>
      <td>[2014-07-10T00:00:00.000000000]</td>
      <td>39</td>
      <td>1</td>
      <td>[0.0]</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2014-07-24</th>
      <td>unnamed-2014-07-24</td>
      <td>[2014-07-24T00:00:00.000000000, 2014-07-26T00:...</td>
      <td>18</td>
      <td>2</td>
      <td>[0.0, 2.0]</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>2014-08-18</th>
      <td>AUG 18 2014-2014-08-18</td>
      <td>[2014-08-18T00:00:00.000000000]</td>
      <td>1</td>
      <td>1</td>
      <td>[0.0]</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2014-09-04</th>
      <td>Thunderstorm-2014-09-04</td>
      <td>[2014-09-04T00:00:00.000000000]</td>
      <td>5</td>
      <td>1</td>
      <td>[0.0]</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2014-09-08</th>
      <td>Rainy Monday-2014-09-08</td>
      <td>[2014-09-08T00:00:00.000000000, 2014-09-09T00:...</td>
      <td>31</td>
      <td>2</td>
      <td>[0.0, 1.0]</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>2014-09-13</th>
      <td>Saturday Storm 9/13-2014-09-13</td>
      <td>[2014-09-13T00:00:00.000000000]</td>
      <td>3</td>
      <td>1</td>
      <td>[0.0]</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2014-09-24</th>
      <td>HEAVY RAIN-2014-09-24</td>
      <td>[2014-09-24T00:00:00.000000000]</td>
      <td>1</td>
      <td>1</td>
      <td>[0.0]</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2014-09-29</th>
      <td>unnamed-2014-09-29</td>
      <td>[2014-11-01T00:00:00.000000000]</td>
      <td>2</td>
      <td>1</td>
      <td>[33.0]</td>
      <td>33.0</td>
    </tr>
    <tr>
      <th>2014-11-17</th>
      <td>STORM 11/17/14-2014-11-17</td>
      <td>[2014-11-17T00:00:00.000000000]</td>
      <td>1</td>
      <td>1</td>
      <td>[0.0]</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2014-11-23</th>
      <td>unnamed-2014-11-23</td>
      <td>[2014-12-24T00:00:00.000000000, 2015-01-18T00:...</td>
      <td>4</td>
      <td>2</td>
      <td>[31.0, 56.0]</td>
      <td>56.0</td>
    </tr>
    <tr>
      <th>2015-03-02</th>
      <td>unnamed-2015-03-02</td>
      <td>[2015-04-14T00:00:00.000000000, 2015-06-02T00:...</td>
      <td>10</td>
      <td>2</td>
      <td>[43.0, 92.0]</td>
      <td>92.0</td>
    </tr>
    <tr>
      <th>2015-07-02</th>
      <td>unnamed-2015-07-02</td>
      <td>[2015-07-04T00:00:00.000000000, 2015-07-11T00:...</td>
      <td>7</td>
      <td>2</td>
      <td>[2.0, 9.0]</td>
      <td>9.0</td>
    </tr>
    <tr>
      <th>2015-07-11</th>
      <td>Thunderstorm-2015-07-11</td>
      <td>[2015-07-11T00:00:00.000000000]</td>
      <td>10</td>
      <td>1</td>
      <td>[0.0]</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2015-09-02</th>
      <td>09/02/15-2015-09-02</td>
      <td>[2015-09-02T00:00:00.000000000]</td>
      <td>1</td>
      <td>1</td>
      <td>[0.0]</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2015-09-17</th>
      <td>unnamed-2015-09-17</td>
      <td>[2015-09-23T00:00:00.000000000]</td>
      <td>1</td>
      <td>1</td>
      <td>[6.0]</td>
      <td>6.0</td>
    </tr>
    <tr>
      <th>2015-09-24</th>
      <td>Noreaster-2015-09-24</td>
      <td>[2015-09-24T00:00:00.000000000, 2015-09-25T00:...</td>
      <td>16</td>
      <td>4</td>
      <td>[0.0, 1.0, 2.0, 3.0]</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>2015-09-29</th>
      <td>Joaquin-2015-09-29</td>
      <td>[2015-09-30T00:00:00.000000000, 2015-10-01T00:...</td>
      <td>159</td>
      <td>6</td>
      <td>[1.0, 2.0, 3.0, 4.0, 5.0, 6.0]</td>
      <td>6.0</td>
    </tr>
    <tr>
      <th>2015-10-30</th>
      <td>unnamed-2015-10-30</td>
      <td>[2015-12-10T00:00:00.000000000]</td>
      <td>1</td>
      <td>1</td>
      <td>[41.0]</td>
      <td>41.0</td>
    </tr>
    <tr>
      <th>2015-12-30</th>
      <td>Heavy Rainfall-2015-12-30</td>
      <td>[2015-12-30T00:00:00.000000000]</td>
      <td>3</td>
      <td>1</td>
      <td>[0.0]</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2016-01-15</th>
      <td>01/15/2016-2016-01-15</td>
      <td>[2016-01-15T00:00:00.000000000]</td>
      <td>6</td>
      <td>1</td>
      <td>[0.0]</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2016-01-20</th>
      <td>Jan Winter Weather-2016-01-20</td>
      <td>[2016-01-22T00:00:00.000000000, 2016-01-23T00:...</td>
      <td>26</td>
      <td>2</td>
      <td>[2.0, 3.0]</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>2016-02-01</th>
      <td>unnamed-2016-02-01</td>
      <td>[2016-02-04T00:00:00.000000000, 2016-02-05T00:...</td>
      <td>5</td>
      <td>3</td>
      <td>[3.0, 4.0, 8.0]</td>
      <td>8.0</td>
    </tr>
    <tr>
      <th>2016-02-24</th>
      <td>February 24th Storm-2016-02-24</td>
      <td>[2016-02-24T00:00:00.000000000]</td>
      <td>1</td>
      <td>1</td>
      <td>[0.0]</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2016-02-25</th>
      <td>unnamed-2016-02-25</td>
      <td>[2016-05-05T00:00:00.000000000, 2016-05-06T00:...</td>
      <td>8</td>
      <td>3</td>
      <td>[70.0, 71.0, 96.0]</td>
      <td>96.0</td>
    </tr>
    <tr>
      <th>2016-06-03</th>
      <td>Severe Weather - 6/5-2016-06-03</td>
      <td>[2016-06-05T00:00:00.000000000]</td>
      <td>6</td>
      <td>1</td>
      <td>[2.0]</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>2016-06-10</th>
      <td>unnamed-2016-06-10</td>
      <td>[2016-07-01T00:00:00.000000000]</td>
      <td>2</td>
      <td>1</td>
      <td>[21.0]</td>
      <td>21.0</td>
    </tr>
    <tr>
      <th>2016-07-19</th>
      <td>Thunderstorm-2016-07-19</td>
      <td>[2016-07-19T00:00:00.000000000]</td>
      <td>9</td>
      <td>1</td>
      <td>[0.0]</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2016-07-20</th>
      <td>unnamed-2016-07-20</td>
      <td>[2016-07-20T00:00:00.000000000]</td>
      <td>1</td>
      <td>1</td>
      <td>[0.0]</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2016-07-25</th>
      <td>Bernie (Training)-2016-07-25</td>
      <td>[2016-07-25T00:00:00.000000000]</td>
      <td>2</td>
      <td>1</td>
      <td>[0.0]</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2016-07-30</th>
      <td>Thunderstorm-2016-07-30</td>
      <td>[2016-07-30T00:00:00.000000000]</td>
      <td>4</td>
      <td>1</td>
      <td>[0.0]</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2016-07-31</th>
      <td>Thunderstorm-2016-07-31</td>
      <td>[2016-07-31T00:00:00.000000000]</td>
      <td>8</td>
      <td>1</td>
      <td>[0.0]</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2016-09-02</th>
      <td>HERMINE-2016-09-02</td>
      <td>[2016-09-03T00:00:00.000000000, 2016-09-04T00:...</td>
      <td>40</td>
      <td>2</td>
      <td>[1.0, 2.0]</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>2016-09-19</th>
      <td>HEAVY RAIN-2016-09-19</td>
      <td>[2016-09-19T00:00:00.000000000]</td>
      <td>11</td>
      <td>1</td>
      <td>[0.0]</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2016-09-20</th>
      <td>unnamed-2016-09-20</td>
      <td>[2016-09-21T00:00:00.000000000, 2016-09-22T00:...</td>
      <td>101</td>
      <td>4</td>
      <td>[1.0, 2.0, 11.0, 15.0]</td>
      <td>15.0</td>
    </tr>
    <tr>
      <th>2016-10-05</th>
      <td>Hurricane Matthew-2016-10-05</td>
      <td>[2016-10-05T00:00:00.000000000, 2016-10-08T00:...</td>
      <td>111</td>
      <td>7</td>
      <td>[0.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0]</td>
      <td>8.0</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="n">feature_df</span> <span class="o">=</span> <span class="n">get_db_table_as_df</span><span class="p">(</span><span class="s1">&#39;nor_daily_observations&#39;</span><span class="p">,</span> <span class="n">dbfilename</span><span class="o">=</span><span class="n">db_filename</span><span class="p">)</span>
<span class="n">feature_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;nor_daily_observations.csv&#39;</span><span class="p">)</span>
<span class="n">feature_df</span><span class="p">[</span><span class="s1">&#39;Datetime&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">feature_df</span><span class="p">[</span><span class="s1">&#39;Datetime&#39;</span><span class="p">])</span>
<span class="n">feature_df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;Datetime&#39;</span><span class="p">,</span> <span class="n">inplace</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">feature_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>WDF2-19</th>
      <th>WDF2-20</th>
      <th>WSF2-19</th>
      <th>WSF2-20</th>
      <th>AWDR-19</th>
      <th>AWND-19</th>
      <th>AWND-20</th>
      <th>WGF6-18</th>
      <th>AWND-18</th>
      <th>AWDR-18</th>
      <th>...</th>
      <th>r3d-1</th>
      <th>r3d-2</th>
      <th>r3d-7</th>
      <th>r3d-11</th>
      <th>r3d-12</th>
      <th>r3d-13</th>
      <th>r3d-14</th>
      <th>r3d-15</th>
      <th>r3d-16</th>
      <th>r3d-21</th>
    </tr>
    <tr>
      <th>Datetime</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2010-09-15</th>
      <td>140.0</td>
      <td>110.0</td>
      <td>13.0</td>
      <td>15.0</td>
      <td>119.0</td>
      <td>5.1</td>
      <td>5.6</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2.200000e-01</td>
      <td>2.400000e-01</td>
      <td>2.600000e-01</td>
      <td>2.200000e-01</td>
      <td>3.100000e-01</td>
      <td>2.400000e-01</td>
      <td>3.600000e-01</td>
      <td>2.400000e-01</td>
    </tr>
    <tr>
      <th>2010-09-16</th>
      <td>220.0</td>
      <td>200.0</td>
      <td>25.9</td>
      <td>19.9</td>
      <td>210.0</td>
      <td>15.2</td>
      <td>9.6</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.000000e-02</td>
      <td>-3.053113e-16</td>
      <td>-2.220446e-16</td>
      <td>-3.608225e-16</td>
      <td>3.330669e-16</td>
      <td>-1.110223e-15</td>
      <td>-1.554312e-15</td>
      <td>-5.551115e-17</td>
    </tr>
    <tr>
      <th>2010-09-17</th>
      <td>220.0</td>
      <td>200.0</td>
      <td>21.0</td>
      <td>16.1</td>
      <td>41.0</td>
      <td>11.0</td>
      <td>9.4</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-1.351350e-15</td>
      <td>-3.053113e-16</td>
      <td>-2.220446e-16</td>
      <td>-3.608225e-16</td>
      <td>3.330669e-16</td>
      <td>-1.110223e-15</td>
      <td>-1.554312e-15</td>
      <td>-5.551115e-17</td>
    </tr>
    <tr>
      <th>2010-09-18</th>
      <td>30.0</td>
      <td>30.0</td>
      <td>16.1</td>
      <td>18.1</td>
      <td>37.0</td>
      <td>8.5</td>
      <td>9.4</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-1.351350e-15</td>
      <td>-3.053113e-16</td>
      <td>-2.220446e-16</td>
      <td>-3.608225e-16</td>
      <td>3.330669e-16</td>
      <td>-1.110223e-15</td>
      <td>-1.554312e-15</td>
      <td>-5.551115e-17</td>
    </tr>
    <tr>
      <th>2010-09-19</th>
      <td>40.0</td>
      <td>10.0</td>
      <td>10.1</td>
      <td>12.1</td>
      <td>58.0</td>
      <td>4.3</td>
      <td>4.7</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-1.351350e-15</td>
      <td>-3.053113e-16</td>
      <td>-2.220446e-16</td>
      <td>-3.608225e-16</td>
      <td>3.330669e-16</td>
      <td>-1.110223e-15</td>
      <td>-1.554312e-15</td>
      <td>-5.551115e-17</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 113 columns</p>
</div></div>
</div>
</div>
<div class="section" id="Combine-env.-data-with-event-data">
<h2>Combine env. data with event data<a class="headerlink" href="#Combine-env.-data-with-event-data" title="Permalink to this headline">¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">add_event_data</span><span class="p">(</span><span class="n">evnt_data</span><span class="p">,</span> <span class="n">evnt_df</span><span class="p">,</span> <span class="n">col_name</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="n">idx</span><span class="p">):</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="n">evnt_data</span><span class="p">[</span><span class="n">col_name</span><span class="p">])</span>
    <span class="n">evnt_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="n">col_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">res</span>
    <span class="k">return</span> <span class="n">evnt_df</span>
</pre></div>
</div>
</div>
<p>Now for each event we get an aggregate of the different variables for the given dates</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="n">event_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">event_df</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">feature_df</span><span class="o">.</span><span class="n">columns</span><span class="p">)])</span>

<span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="n">event_df</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
    <span class="c1"># get the dates of the event and include the date in the &quot;event&quot; column</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">event_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">ind</span><span class="p">,</span> <span class="s1">&#39;dates&#39;</span><span class="p">]</span>
    <span class="n">ind</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">datetime64</span><span class="p">(</span><span class="n">ind</span><span class="p">)</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">ind</span><span class="p">)</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">ind</span> <span class="ow">in</span> <span class="n">ds</span> <span class="k">else</span> <span class="n">ds</span>

    <span class="n">event_data</span> <span class="o">=</span> <span class="n">feature_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">ds</span><span class="p">]</span>

    <span class="c1"># combining data on event scale</span>
    <span class="c1"># get max over the event for these features</span>
    <span class="n">max_cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;rhrmx&#39;</span><span class="p">,</span> <span class="s1">&#39;r15mx&#39;</span><span class="p">,</span> <span class="s1">&#39;wind_vel_daily_avg&#39;</span><span class="p">,</span> <span class="s1">&#39;wind_vel_hourly_max_avg&#39;</span><span class="p">,</span> <span class="s1">&#39;ht&#39;</span><span class="p">,</span> <span class="s1">&#39;hht&#39;</span><span class="p">,</span> <span class="s1">&#39;lt&#39;</span><span class="p">,</span> <span class="s1">&#39;llt&#39;</span><span class="p">]</span>

    <span class="c1"># get mean over the event for these features</span>
    <span class="n">mean_cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;W&#39;</span><span class="p">,</span> <span class="s1">&#39;td&#39;</span><span class="p">,</span> <span class="s1">&#39;gw&#39;</span><span class="p">,</span> <span class="s1">&#39;AWDR&#39;</span><span class="p">,</span> <span class="s1">&#39;AWND&#39;</span><span class="p">]</span>

    <span class="c1"># get sum over the event for these features</span>
    <span class="n">sum_cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;rd&#39;</span><span class="p">]</span>

    <span class="k">for</span> <span class="n">feat</span> <span class="ow">in</span> <span class="n">feature_df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">feat</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">col</span><span class="p">)</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">max_cols</span><span class="p">):</span>
            <span class="n">event_df</span> <span class="o">=</span> <span class="n">add_event_data</span><span class="p">(</span><span class="n">event_data</span><span class="p">,</span> <span class="n">event_df</span><span class="p">,</span> <span class="n">feat</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">,</span> <span class="n">ind</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">any</span><span class="p">(</span><span class="n">feat</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">col</span><span class="p">)</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">mean_cols</span><span class="p">):</span>
            <span class="n">event_df</span> <span class="o">=</span> <span class="n">add_event_data</span><span class="p">(</span><span class="n">event_data</span><span class="p">,</span> <span class="n">event_df</span><span class="p">,</span> <span class="n">feat</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span> <span class="n">ind</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">any</span><span class="p">(</span><span class="n">feat</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">col</span><span class="p">)</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">sum_cols</span><span class="p">):</span>
            <span class="n">event_df</span> <span class="o">=</span> <span class="n">add_event_data</span><span class="p">(</span><span class="n">event_data</span><span class="p">,</span> <span class="n">event_df</span><span class="p">,</span> <span class="n">feat</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">,</span> <span class="n">ind</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">feat</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;r3d&#39;</span><span class="p">):</span>
            <span class="n">event_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">ind</span><span class="p">,</span> <span class="n">feat</span><span class="p">]</span> <span class="o">=</span> <span class="n">event_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">ind</span><span class="p">,</span> <span class="n">feat</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;r\w</span><span class="si">{2}</span><span class="s1">-\d+_td-\d+&#39;</span><span class="p">),</span> <span class="n">feat</span><span class="p">):</span>
            <span class="n">feat_spl</span> <span class="o">=</span> <span class="n">feat</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>
            <span class="n">var</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">mx-</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">feat_spl</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">feat_spl</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">max_ind</span> <span class="o">=</span> <span class="n">event_data</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">idxmax</span><span class="p">()</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">max_ind</span><span class="p">,</span> <span class="nb">float</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">math</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">max_ind</span><span class="p">):</span>
                    <span class="n">event_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">ind</span><span class="p">,</span> <span class="n">feat</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">val</span> <span class="o">=</span> <span class="n">event_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">max_ind</span><span class="p">,</span> <span class="n">feat</span><span class="p">]</span>
                <span class="n">event_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">ind</span><span class="p">,</span> <span class="n">feat</span><span class="p">]</span> <span class="o">=</span> <span class="n">event_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">max_ind</span><span class="p">,</span> <span class="n">feat</span><span class="p">]</span>

<span class="n">event_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>AWDR-18</th>
      <th>AWDR-19</th>
      <th>AWDR-3</th>
      <th>AWND-18</th>
      <th>AWND-19</th>
      <th>AWND-20</th>
      <th>AWND-3</th>
      <th>WDF2-19</th>
      <th>WDF2-20</th>
      <th>WGF6-18</th>
      <th>...</th>
      <th>rhrmx-12</th>
      <th>rhrmx-13</th>
      <th>rhrmx-14</th>
      <th>rhrmx-15</th>
      <th>rhrmx-16</th>
      <th>rhrmx-2</th>
      <th>rhrmx-21</th>
      <th>rhrmx-7</th>
      <th>td_av-17</th>
      <th>td_av-18</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2010-09-30</th>
      <td>NaN</td>
      <td>291.667</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>11.6</td>
      <td>12.6</td>
      <td>NaN</td>
      <td>83.3333</td>
      <td>160</td>
      <td>NaN</td>
      <td>...</td>
      <td>1.59</td>
      <td>1.4</td>
      <td>1.17</td>
      <td>0.9</td>
      <td>1.31</td>
      <td>NaN</td>
      <td>1.49</td>
      <td>1.43</td>
      <td>1.38399</td>
      <td>1.52196</td>
    </tr>
    <tr>
      <th>2010-12-16</th>
      <td>NaN</td>
      <td>213</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2.9</td>
      <td>2.5</td>
      <td>NaN</td>
      <td>210</td>
      <td>200</td>
      <td>NaN</td>
      <td>...</td>
      <td>0.07</td>
      <td>0.05</td>
      <td>0.12</td>
      <td>0.06</td>
      <td>0.12</td>
      <td>NaN</td>
      <td>0.03</td>
      <td>0.11</td>
      <td>-0.208504</td>
      <td>-0.195775</td>
    </tr>
    <tr>
      <th>2011-08-27</th>
      <td>133.611</td>
      <td>133</td>
      <td>NaN</td>
      <td>8.5641</td>
      <td>13.975</td>
      <td>14.725</td>
      <td>NaN</td>
      <td>130</td>
      <td>187.5</td>
      <td>13.9539</td>
      <td>...</td>
      <td>1.22</td>
      <td>1.12</td>
      <td>0.93</td>
      <td>1.02</td>
      <td>1.3</td>
      <td>NaN</td>
      <td>1.1</td>
      <td>1.03</td>
      <td>1.04581</td>
      <td>1.14569</td>
    </tr>
    <tr>
      <th>2012-10-28</th>
      <td>110.73</td>
      <td>123</td>
      <td>107.629</td>
      <td>11.924</td>
      <td>23.8</td>
      <td>24</td>
      <td>16.1683</td>
      <td>20</td>
      <td>16.6667</td>
      <td>20.0615</td>
      <td>...</td>
      <td>0.58</td>
      <td>0.4</td>
      <td>0.38</td>
      <td>0.52</td>
      <td>0.43</td>
      <td>NaN</td>
      <td>0.48</td>
      <td>0.23</td>
      <td>2.70266</td>
      <td>2.79603</td>
    </tr>
    <tr>
      <th>2013-10-09</th>
      <td>41.5125</td>
      <td>25.6667</td>
      <td>52.9563</td>
      <td>8.7694</td>
      <td>20.8</td>
      <td>21.5667</td>
      <td>12.8631</td>
      <td>36.6667</td>
      <td>26.6667</td>
      <td>15.3151</td>
      <td>...</td>
      <td>0.45</td>
      <td>0.47</td>
      <td>3.07</td>
      <td>0.56</td>
      <td>0.4</td>
      <td>NaN</td>
      <td>0.46</td>
      <td>0.5</td>
      <td>2.2125</td>
      <td>2.27723</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 119 columns</p>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="n">event_df</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(45, 119)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="n">event_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>AWDR-18</th>
      <th>AWDR-19</th>
      <th>AWDR-3</th>
      <th>AWND-18</th>
      <th>AWND-19</th>
      <th>AWND-20</th>
      <th>AWND-3</th>
      <th>WDF2-19</th>
      <th>WDF2-20</th>
      <th>WGF6-18</th>
      <th>...</th>
      <th>rhrmx-12</th>
      <th>rhrmx-13</th>
      <th>rhrmx-14</th>
      <th>rhrmx-15</th>
      <th>rhrmx-16</th>
      <th>rhrmx-2</th>
      <th>rhrmx-21</th>
      <th>rhrmx-7</th>
      <th>td_av-17</th>
      <th>td_av-18</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2010-09-30</th>
      <td>NaN</td>
      <td>291.667</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>11.6</td>
      <td>12.6</td>
      <td>NaN</td>
      <td>83.3333</td>
      <td>160</td>
      <td>NaN</td>
      <td>...</td>
      <td>1.59</td>
      <td>1.4</td>
      <td>1.17</td>
      <td>0.9</td>
      <td>1.31</td>
      <td>NaN</td>
      <td>1.49</td>
      <td>1.43</td>
      <td>1.38399</td>
      <td>1.52196</td>
    </tr>
    <tr>
      <th>2010-12-16</th>
      <td>NaN</td>
      <td>213</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2.9</td>
      <td>2.5</td>
      <td>NaN</td>
      <td>210</td>
      <td>200</td>
      <td>NaN</td>
      <td>...</td>
      <td>0.07</td>
      <td>0.05</td>
      <td>0.12</td>
      <td>0.06</td>
      <td>0.12</td>
      <td>NaN</td>
      <td>0.03</td>
      <td>0.11</td>
      <td>-0.208504</td>
      <td>-0.195775</td>
    </tr>
    <tr>
      <th>2011-08-27</th>
      <td>133.611</td>
      <td>133</td>
      <td>NaN</td>
      <td>8.5641</td>
      <td>13.975</td>
      <td>14.725</td>
      <td>NaN</td>
      <td>130</td>
      <td>187.5</td>
      <td>13.9539</td>
      <td>...</td>
      <td>1.22</td>
      <td>1.12</td>
      <td>0.93</td>
      <td>1.02</td>
      <td>1.3</td>
      <td>NaN</td>
      <td>1.1</td>
      <td>1.03</td>
      <td>1.04581</td>
      <td>1.14569</td>
    </tr>
    <tr>
      <th>2012-10-28</th>
      <td>110.73</td>
      <td>123</td>
      <td>107.629</td>
      <td>11.924</td>
      <td>23.8</td>
      <td>24</td>
      <td>16.1683</td>
      <td>20</td>
      <td>16.6667</td>
      <td>20.0615</td>
      <td>...</td>
      <td>0.58</td>
      <td>0.4</td>
      <td>0.38</td>
      <td>0.52</td>
      <td>0.43</td>
      <td>NaN</td>
      <td>0.48</td>
      <td>0.23</td>
      <td>2.70266</td>
      <td>2.79603</td>
    </tr>
    <tr>
      <th>2013-10-09</th>
      <td>41.5125</td>
      <td>25.6667</td>
      <td>52.9563</td>
      <td>8.7694</td>
      <td>20.8</td>
      <td>21.5667</td>
      <td>12.8631</td>
      <td>36.6667</td>
      <td>26.6667</td>
      <td>15.3151</td>
      <td>...</td>
      <td>0.45</td>
      <td>0.47</td>
      <td>3.07</td>
      <td>0.56</td>
      <td>0.4</td>
      <td>NaN</td>
      <td>0.46</td>
      <td>0.5</td>
      <td>2.2125</td>
      <td>2.27723</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 119 columns</p>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="n">cols</span> <span class="o">=</span> <span class="n">event_df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">lft_cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;event_name&#39;</span><span class="p">,</span> <span class="s1">&#39;dates&#39;</span><span class="p">,</span> <span class="s1">&#39;num_flooded&#39;</span><span class="p">,</span> <span class="s1">&#39;days_away_from_event&#39;</span><span class="p">,</span> <span class="s1">&#39;max_days_away&#39;</span><span class="p">,</span> <span class="s1">&#39;num_dates&#39;</span><span class="p">]</span>
<span class="n">lft_cols</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
<span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">lft_cols</span><span class="p">:</span>
    <span class="n">cols</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">cols</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">cols</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">c</span><span class="p">)))</span>
<span class="n">event_df</span> <span class="o">=</span> <span class="n">event_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">cols</span><span class="p">]</span>
<span class="n">event_df_for_storage</span> <span class="o">=</span> <span class="n">event_df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">event_df_for_storage</span><span class="p">[</span><span class="s1">&#39;dates&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">event_df_for_storage</span><span class="p">[</span><span class="s1">&#39;dates&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
<span class="n">event_df_for_storage</span><span class="p">[</span><span class="s1">&#39;days_away_from_event&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">event_df_for_storage</span><span class="p">[</span><span class="s1">&#39;days_away_from_event&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
<span class="n">event_df_for_storage</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;index&#39;</span><span class="p">:</span><span class="s1">&#39;event_date&#39;</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">event_df_for_storage</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>event_date</th>
      <th>event_name</th>
      <th>dates</th>
      <th>num_flooded</th>
      <th>days_away_from_event</th>
      <th>max_days_away</th>
      <th>num_dates</th>
      <th>AWDR-18</th>
      <th>AWDR-19</th>
      <th>AWDR-3</th>
      <th>...</th>
      <th>rhrmx-12</th>
      <th>rhrmx-13</th>
      <th>rhrmx-14</th>
      <th>rhrmx-15</th>
      <th>rhrmx-16</th>
      <th>rhrmx-2</th>
      <th>rhrmx-21</th>
      <th>rhrmx-7</th>
      <th>td_av-17</th>
      <th>td_av-18</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2010-09-30</td>
      <td>Nicole-2010-09-30</td>
      <td>['2010-09-30T00:00:00.000000000' '2010-10-01T0...</td>
      <td>101.0</td>
      <td>[ 0.  1.  4.]</td>
      <td>4.0</td>
      <td>3.0</td>
      <td>NaN</td>
      <td>291.667</td>
      <td>NaN</td>
      <td>...</td>
      <td>1.59</td>
      <td>1.4</td>
      <td>1.17</td>
      <td>0.9</td>
      <td>1.31</td>
      <td>NaN</td>
      <td>1.49</td>
      <td>1.43</td>
      <td>1.38399</td>
      <td>1.52196</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2010-12-16</td>
      <td>Snow-2010-12-16</td>
      <td>['2010-12-16T00:00:00.000000000']</td>
      <td>2.0</td>
      <td>[ 0.]</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>213</td>
      <td>NaN</td>
      <td>...</td>
      <td>0.07</td>
      <td>0.05</td>
      <td>0.12</td>
      <td>0.06</td>
      <td>0.12</td>
      <td>NaN</td>
      <td>0.03</td>
      <td>0.11</td>
      <td>-0.208504</td>
      <td>-0.195775</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2011-08-27</td>
      <td>Irene-2011-08-27</td>
      <td>['2011-08-24T00:00:00.000000000' '2011-08-27T0...</td>
      <td>110.0</td>
      <td>[-3.  0.  1.  2.]</td>
      <td>2.0</td>
      <td>4.0</td>
      <td>133.611</td>
      <td>133</td>
      <td>NaN</td>
      <td>...</td>
      <td>1.22</td>
      <td>1.12</td>
      <td>0.93</td>
      <td>1.02</td>
      <td>1.3</td>
      <td>NaN</td>
      <td>1.1</td>
      <td>1.03</td>
      <td>1.04581</td>
      <td>1.14569</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2012-10-28</td>
      <td>Sandy-2012-10-28</td>
      <td>['2012-10-27T00:00:00.000000000' '2012-10-28T0...</td>
      <td>105.0</td>
      <td>[-1.  0.  1.]</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>110.73</td>
      <td>123</td>
      <td>107.629</td>
      <td>...</td>
      <td>0.58</td>
      <td>0.4</td>
      <td>0.38</td>
      <td>0.52</td>
      <td>0.43</td>
      <td>NaN</td>
      <td>0.48</td>
      <td>0.23</td>
      <td>2.70266</td>
      <td>2.79603</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2013-10-09</td>
      <td>Heavy Rain-2013-10-09</td>
      <td>['2013-10-08T00:00:00.000000000' '2013-10-09T0...</td>
      <td>36.0</td>
      <td>[-1.  0.  1.]</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>41.5125</td>
      <td>25.6667</td>
      <td>52.9563</td>
      <td>...</td>
      <td>0.45</td>
      <td>0.47</td>
      <td>3.07</td>
      <td>0.56</td>
      <td>0.4</td>
      <td>NaN</td>
      <td>0.46</td>
      <td>0.5</td>
      <td>2.2125</td>
      <td>2.27723</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 120 columns</p>
</div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="n">event_df_for_storage</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">event_data.csv&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">data_dir</span><span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">event_df_for_storage</span><span class="o">.</span><span class="n">to_sql</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;event_data&#39;</span><span class="p">,</span> <span class="n">con</span><span class="o">=</span><span class="n">con</span><span class="p">,</span> <span class="n">if_exists</span><span class="o">=</span><span class="s1">&#39;replace&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Combining-with-the-non-flooding-event-data">
<h2>Combining with the non-flooding event data<a class="headerlink" href="#Combining-with-the-non-flooding-event-data" title="Permalink to this headline">¶</a></h2>
<p>First we have to combine all the dates in the “dates” column of the event_df into one array so we can filter those out of the overall dataset.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="n">flooded_dates</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">datetime64</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">event_df</span><span class="o">.</span><span class="n">index</span><span class="p">]</span>
<span class="n">flooded_dates</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">flooded_dates</span><span class="p">)</span>
<span class="n">fl_event_dates</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">event_df</span><span class="p">[</span><span class="s1">&#39;dates&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
<span class="n">all_fl_dates</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">fl_event_dates</span><span class="p">,</span> <span class="n">flooded_dates</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="n">non_flooded_records</span> <span class="o">=</span> <span class="n">feature_df</span><span class="p">[</span><span class="n">feature_df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">all_fl_dates</span><span class="p">)</span> <span class="o">!=</span> <span class="kc">True</span><span class="p">]</span>
<span class="n">non_flooded_records</span><span class="p">[</span><span class="s1">&#39;num_flooded&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">non_flooded_records</span><span class="p">[</span><span class="s1">&#39;flooded&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">non_flooded_records</span><span class="p">[</span><span class="s1">&#39;event_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
<span class="n">non_flooded_records</span><span class="p">[</span><span class="s1">&#39;event_date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">non_flooded_records</span><span class="o">.</span><span class="n">index</span>
<span class="n">non_flooded_records</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">non_flooded_records</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>WDF2-19</th>
      <th>WDF2-20</th>
      <th>WSF2-19</th>
      <th>WSF2-20</th>
      <th>AWDR-19</th>
      <th>AWND-19</th>
      <th>AWND-20</th>
      <th>WGF6-18</th>
      <th>AWND-18</th>
      <th>AWDR-18</th>
      <th>...</th>
      <th>r3d-12</th>
      <th>r3d-13</th>
      <th>r3d-14</th>
      <th>r3d-15</th>
      <th>r3d-16</th>
      <th>r3d-21</th>
      <th>num_flooded</th>
      <th>flooded</th>
      <th>event_name</th>
      <th>event_date</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>140.0</td>
      <td>110.0</td>
      <td>13.0</td>
      <td>15.0</td>
      <td>119.0</td>
      <td>5.1</td>
      <td>5.6</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>2.600000e-01</td>
      <td>2.200000e-01</td>
      <td>3.100000e-01</td>
      <td>2.400000e-01</td>
      <td>3.600000e-01</td>
      <td>2.400000e-01</td>
      <td>0</td>
      <td>False</td>
      <td>NaN</td>
      <td>2010-09-15</td>
    </tr>
    <tr>
      <th>1</th>
      <td>220.0</td>
      <td>200.0</td>
      <td>25.9</td>
      <td>19.9</td>
      <td>210.0</td>
      <td>15.2</td>
      <td>9.6</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>-2.220446e-16</td>
      <td>-3.608225e-16</td>
      <td>3.330669e-16</td>
      <td>-1.110223e-15</td>
      <td>-1.554312e-15</td>
      <td>-5.551115e-17</td>
      <td>0</td>
      <td>False</td>
      <td>NaN</td>
      <td>2010-09-16</td>
    </tr>
    <tr>
      <th>2</th>
      <td>220.0</td>
      <td>200.0</td>
      <td>21.0</td>
      <td>16.1</td>
      <td>41.0</td>
      <td>11.0</td>
      <td>9.4</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>-2.220446e-16</td>
      <td>-3.608225e-16</td>
      <td>3.330669e-16</td>
      <td>-1.110223e-15</td>
      <td>-1.554312e-15</td>
      <td>-5.551115e-17</td>
      <td>0</td>
      <td>False</td>
      <td>NaN</td>
      <td>2010-09-17</td>
    </tr>
    <tr>
      <th>3</th>
      <td>30.0</td>
      <td>30.0</td>
      <td>16.1</td>
      <td>18.1</td>
      <td>37.0</td>
      <td>8.5</td>
      <td>9.4</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>-2.220446e-16</td>
      <td>-3.608225e-16</td>
      <td>3.330669e-16</td>
      <td>-1.110223e-15</td>
      <td>-1.554312e-15</td>
      <td>-5.551115e-17</td>
      <td>0</td>
      <td>False</td>
      <td>NaN</td>
      <td>2010-09-18</td>
    </tr>
    <tr>
      <th>4</th>
      <td>40.0</td>
      <td>10.0</td>
      <td>10.1</td>
      <td>12.1</td>
      <td>58.0</td>
      <td>4.3</td>
      <td>4.7</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>-2.220446e-16</td>
      <td>-3.608225e-16</td>
      <td>3.330669e-16</td>
      <td>-1.110223e-15</td>
      <td>-1.554312e-15</td>
      <td>-5.551115e-17</td>
      <td>0</td>
      <td>False</td>
      <td>NaN</td>
      <td>2010-09-19</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 117 columns</p>
</div></div>
</div>
<p>Combine with flooded events</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="n">event_df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">flooded_records</span> <span class="o">=</span> <span class="n">event_df</span>
<span class="n">flooded_records</span><span class="p">[</span><span class="s1">&#39;event_date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">event_df</span><span class="p">[</span><span class="s1">&#39;index&#39;</span><span class="p">]</span>
<span class="n">flooded_records</span><span class="p">[</span><span class="s1">&#39;flooded&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">flooded_records</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>event_name</th>
      <th>dates</th>
      <th>num_flooded</th>
      <th>days_away_from_event</th>
      <th>max_days_away</th>
      <th>num_dates</th>
      <th>AWDR-18</th>
      <th>AWDR-19</th>
      <th>AWDR-3</th>
      <th>...</th>
      <th>rhrmx-14</th>
      <th>rhrmx-15</th>
      <th>rhrmx-16</th>
      <th>rhrmx-2</th>
      <th>rhrmx-21</th>
      <th>rhrmx-7</th>
      <th>td_av-17</th>
      <th>td_av-18</th>
      <th>event_date</th>
      <th>flooded</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2010-09-30</td>
      <td>Nicole-2010-09-30</td>
      <td>[2010-09-30T00:00:00.000000000, 2010-10-01T00:...</td>
      <td>101.0</td>
      <td>[0.0, 1.0, 4.0]</td>
      <td>4.0</td>
      <td>3.0</td>
      <td>NaN</td>
      <td>291.667</td>
      <td>NaN</td>
      <td>...</td>
      <td>1.17</td>
      <td>0.9</td>
      <td>1.31</td>
      <td>NaN</td>
      <td>1.49</td>
      <td>1.43</td>
      <td>1.38399</td>
      <td>1.52196</td>
      <td>2010-09-30</td>
      <td>True</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2010-12-16</td>
      <td>Snow-2010-12-16</td>
      <td>[2010-12-16T00:00:00.000000000]</td>
      <td>2.0</td>
      <td>[0.0]</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>213</td>
      <td>NaN</td>
      <td>...</td>
      <td>0.12</td>
      <td>0.06</td>
      <td>0.12</td>
      <td>NaN</td>
      <td>0.03</td>
      <td>0.11</td>
      <td>-0.208504</td>
      <td>-0.195775</td>
      <td>2010-12-16</td>
      <td>True</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2011-08-27</td>
      <td>Irene-2011-08-27</td>
      <td>[2011-08-24T00:00:00.000000000, 2011-08-27T00:...</td>
      <td>110.0</td>
      <td>[-3.0, 0.0, 1.0, 2.0]</td>
      <td>2.0</td>
      <td>4.0</td>
      <td>133.611</td>
      <td>133</td>
      <td>NaN</td>
      <td>...</td>
      <td>0.93</td>
      <td>1.02</td>
      <td>1.3</td>
      <td>NaN</td>
      <td>1.1</td>
      <td>1.03</td>
      <td>1.04581</td>
      <td>1.14569</td>
      <td>2011-08-27</td>
      <td>True</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2012-10-28</td>
      <td>Sandy-2012-10-28</td>
      <td>[2012-10-27T00:00:00.000000000, 2012-10-28T00:...</td>
      <td>105.0</td>
      <td>[-1.0, 0.0, 1.0]</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>110.73</td>
      <td>123</td>
      <td>107.629</td>
      <td>...</td>
      <td>0.38</td>
      <td>0.52</td>
      <td>0.43</td>
      <td>NaN</td>
      <td>0.48</td>
      <td>0.23</td>
      <td>2.70266</td>
      <td>2.79603</td>
      <td>2012-10-28</td>
      <td>True</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2013-10-09</td>
      <td>Heavy Rain-2013-10-09</td>
      <td>[2013-10-08T00:00:00.000000000, 2013-10-09T00:...</td>
      <td>36.0</td>
      <td>[-1.0, 0.0, 1.0]</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>41.5125</td>
      <td>25.6667</td>
      <td>52.9563</td>
      <td>...</td>
      <td>3.07</td>
      <td>0.56</td>
      <td>0.4</td>
      <td>NaN</td>
      <td>0.46</td>
      <td>0.5</td>
      <td>2.2125</td>
      <td>2.27723</td>
      <td>2013-10-09</td>
      <td>True</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 122 columns</p>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="n">reformat</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">flooded_records</span><span class="p">,</span> <span class="n">non_flooded_records</span><span class="p">],</span> <span class="n">join</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">)</span>
<span class="n">reformat</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">reformat</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>event_name</th>
      <th>num_flooded</th>
      <th>AWDR-18</th>
      <th>AWDR-19</th>
      <th>AWDR-3</th>
      <th>AWND-18</th>
      <th>AWND-19</th>
      <th>AWND-20</th>
      <th>AWND-3</th>
      <th>WDF2-19</th>
      <th>...</th>
      <th>rhrmx-14</th>
      <th>rhrmx-15</th>
      <th>rhrmx-16</th>
      <th>rhrmx-2</th>
      <th>rhrmx-21</th>
      <th>rhrmx-7</th>
      <th>td_av-17</th>
      <th>td_av-18</th>
      <th>event_date</th>
      <th>flooded</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Nicole-2010-09-30</td>
      <td>101.0</td>
      <td>NaN</td>
      <td>291.667</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>11.6</td>
      <td>12.6</td>
      <td>NaN</td>
      <td>83.3333</td>
      <td>...</td>
      <td>1.17</td>
      <td>0.9</td>
      <td>1.31</td>
      <td>NaN</td>
      <td>1.49</td>
      <td>1.43</td>
      <td>1.38399</td>
      <td>1.52196</td>
      <td>2010-09-30</td>
      <td>True</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Snow-2010-12-16</td>
      <td>2.0</td>
      <td>NaN</td>
      <td>213</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2.9</td>
      <td>2.5</td>
      <td>NaN</td>
      <td>210</td>
      <td>...</td>
      <td>0.12</td>
      <td>0.06</td>
      <td>0.12</td>
      <td>NaN</td>
      <td>0.03</td>
      <td>0.11</td>
      <td>-0.208504</td>
      <td>-0.195775</td>
      <td>2010-12-16</td>
      <td>True</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Irene-2011-08-27</td>
      <td>110.0</td>
      <td>133.611</td>
      <td>133</td>
      <td>NaN</td>
      <td>8.5641</td>
      <td>13.975</td>
      <td>14.725</td>
      <td>NaN</td>
      <td>130</td>
      <td>...</td>
      <td>0.93</td>
      <td>1.02</td>
      <td>1.3</td>
      <td>NaN</td>
      <td>1.1</td>
      <td>1.03</td>
      <td>1.04581</td>
      <td>1.14569</td>
      <td>2011-08-27</td>
      <td>True</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Sandy-2012-10-28</td>
      <td>105.0</td>
      <td>110.73</td>
      <td>123</td>
      <td>107.629</td>
      <td>11.924</td>
      <td>23.8</td>
      <td>24</td>
      <td>16.1683</td>
      <td>20</td>
      <td>...</td>
      <td>0.38</td>
      <td>0.52</td>
      <td>0.43</td>
      <td>NaN</td>
      <td>0.48</td>
      <td>0.23</td>
      <td>2.70266</td>
      <td>2.79603</td>
      <td>2012-10-28</td>
      <td>True</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Heavy Rain-2013-10-09</td>
      <td>36.0</td>
      <td>41.5125</td>
      <td>25.6667</td>
      <td>52.9563</td>
      <td>8.7694</td>
      <td>20.8</td>
      <td>21.5667</td>
      <td>12.8631</td>
      <td>36.6667</td>
      <td>...</td>
      <td>3.07</td>
      <td>0.56</td>
      <td>0.4</td>
      <td>NaN</td>
      <td>0.46</td>
      <td>0.5</td>
      <td>2.2125</td>
      <td>2.27723</td>
      <td>2013-10-09</td>
      <td>True</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 117 columns</p>
</div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="n">reformat</span><span class="o">.</span><span class="n">to_sql</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;for_model&quot;</span><span class="p">,</span> <span class="n">con</span><span class="o">=</span><span class="n">con</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">if_exists</span><span class="o">=</span><span class="s1">&#39;replace&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="Make-average-table">
<h1>Make average table<a class="headerlink" href="#Make-average-table" title="Permalink to this headline">¶</a></h1>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="n">cols</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">feature_df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
<span class="n">cols_splt</span> <span class="o">=</span> <span class="n">cols</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">expand</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="c1"># do this to make sure the tide when the hourly and 15-min max rains have unique col names</span>
<span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">cols_splt</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
    <span class="k">if</span> <span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;\d_td&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">cols_splt</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">0</span><span class="p">]</span> <span class="o">+=</span> <span class="s2">&quot;_td&quot;</span>
<span class="n">col_vars</span> <span class="o">=</span> <span class="n">cols_splt</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
<span class="n">col_vars</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([&#39;WDF2&#39;, &#39;WSF2&#39;, &#39;AWDR&#39;, &#39;AWND&#39;, &#39;WGF6&#39;, &#39;ht&#39;, &#39;hht&#39;, &#39;lt&#39;, &#39;llt&#39;,
       &#39;r15_td&#39;, &#39;rhr_td&#39;, &#39;td_av&#39;, &#39;gw_av&#39;, &#39;r15mx&#39;, &#39;rhrmx&#39;, &#39;rd&#39;, &#39;r3d&#39;], dtype=object)
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[33]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="n">avdf</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">col_vars</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">v</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;r15_td&#39;</span><span class="p">,</span> <span class="s1">&#39;rhr_td&#39;</span><span class="p">]:</span>
        <span class="n">avdf</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">reformat</span><span class="p">[[</span><span class="n">a</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">feature_df</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">a</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">v</span><span class="p">)]]</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">avdf</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">reformat</span><span class="p">[</span><span class="n">cols</span><span class="p">[</span><span class="n">cols</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">-\d+_td-\d+&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]))]]</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[34]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="n">avdf</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">reformat</span><span class="p">[[</span><span class="s1">&#39;event_date&#39;</span><span class="p">,</span> <span class="s1">&#39;event_name&#39;</span><span class="p">,</span> <span class="s1">&#39;num_flooded&#39;</span><span class="p">]],</span> <span class="n">avdf</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[35]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="n">avdf</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[35]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>event_date</th>
      <th>event_name</th>
      <th>num_flooded</th>
      <th>WDF2</th>
      <th>WSF2</th>
      <th>AWDR</th>
      <th>AWND</th>
      <th>WGF6</th>
      <th>ht</th>
      <th>hht</th>
      <th>lt</th>
      <th>llt</th>
      <th>r15_td</th>
      <th>rhr_td</th>
      <th>td_av</th>
      <th>gw_av</th>
      <th>r15mx</th>
      <th>rhrmx</th>
      <th>rd</th>
      <th>r3d</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2010-09-30</td>
      <td>Nicole-2010-09-30</td>
      <td>101.0</td>
      <td>121.666667</td>
      <td>25.966667</td>
      <td>291.666667</td>
      <td>12.100000</td>
      <td>NaN</td>
      <td>3.2105</td>
      <td>3.6175</td>
      <td>1.1860</td>
      <td>0.5330</td>
      <td>1.156938</td>
      <td>0.926854</td>
      <td>1.452974</td>
      <td>4.340699</td>
      <td>0.605</td>
      <td>1.32250</td>
      <td>7.732500</td>
      <td>3.518</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2010-12-16</td>
      <td>Snow-2010-12-16</td>
      <td>2.0</td>
      <td>205.000000</td>
      <td>15.000000</td>
      <td>213.000000</td>
      <td>2.700000</td>
      <td>NaN</td>
      <td>0.6610</td>
      <td>0.8610</td>
      <td>-1.1300</td>
      <td>-1.2235</td>
      <td>-0.039190</td>
      <td>0.132667</td>
      <td>-0.202140</td>
      <td>2.208326</td>
      <td>0.030</td>
      <td>0.07000</td>
      <td>0.227500</td>
      <td>0.045</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2011-08-27</td>
      <td>Irene-2011-08-27</td>
      <td>110.0</td>
      <td>158.750000</td>
      <td>27.125000</td>
      <td>133.305686</td>
      <td>12.421368</td>
      <td>13.953947</td>
      <td>2.2375</td>
      <td>4.9680</td>
      <td>2.6985</td>
      <td>-0.6925</td>
      <td>3.204875</td>
      <td>3.158667</td>
      <td>1.095753</td>
      <td>2.334049</td>
      <td>0.350</td>
      <td>1.10125</td>
      <td>6.294167</td>
      <td>0.308</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2012-10-28</td>
      <td>Sandy-2012-10-28</td>
      <td>105.0</td>
      <td>18.333333</td>
      <td>38.316667</td>
      <td>113.786208</td>
      <td>18.973074</td>
      <td>20.061461</td>
      <td>5.2280</td>
      <td>5.5760</td>
      <td>3.2840</td>
      <td>1.5810</td>
      <td>4.753823</td>
      <td>4.328802</td>
      <td>2.749344</td>
      <td>2.998493</td>
      <td>0.140</td>
      <td>0.42625</td>
      <td>4.805833</td>
      <td>0.341</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2013-10-09</td>
      <td>Heavy Rain-2013-10-09</td>
      <td>36.0</td>
      <td>31.666667</td>
      <td>32.550000</td>
      <td>40.045150</td>
      <td>15.999780</td>
      <td>15.315069</td>
      <td>3.4925</td>
      <td>4.2125</td>
      <td>2.0830</td>
      <td>1.0845</td>
      <td>3.835031</td>
      <td>3.914865</td>
      <td>2.244865</td>
      <td>2.141837</td>
      <td>0.375</td>
      <td>0.80000</td>
      <td>3.671667</td>
      <td>0.924</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[36]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="n">avdf</span><span class="p">[</span><span class="s1">&#39;ht&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">avdf</span><span class="p">[</span><span class="s1">&#39;ht&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">(),</span> <span class="n">avdf</span><span class="p">[</span><span class="s1">&#39;hht&#39;</span><span class="p">],</span> <span class="n">avdf</span><span class="p">[</span><span class="s1">&#39;ht&#39;</span><span class="p">])</span>
<span class="n">avdf</span><span class="p">[</span><span class="s1">&#39;hht&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">avdf</span><span class="p">[</span><span class="s1">&#39;hht&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">(),</span> <span class="n">avdf</span><span class="p">[</span><span class="s1">&#39;ht&#39;</span><span class="p">],</span> <span class="n">avdf</span><span class="p">[</span><span class="s1">&#39;hht&#39;</span><span class="p">])</span>
<span class="n">avdf</span><span class="p">[</span><span class="s1">&#39;lt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">avdf</span><span class="p">[</span><span class="s1">&#39;lt&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">(),</span> <span class="n">avdf</span><span class="p">[</span><span class="s1">&#39;llt&#39;</span><span class="p">],</span> <span class="n">avdf</span><span class="p">[</span><span class="s1">&#39;lt&#39;</span><span class="p">])</span>
<span class="n">avdf</span><span class="p">[</span><span class="s1">&#39;llt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">avdf</span><span class="p">[</span><span class="s1">&#39;llt&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">(),</span> <span class="n">avdf</span><span class="p">[</span><span class="s1">&#39;lt&#39;</span><span class="p">],</span> <span class="n">avdf</span><span class="p">[</span><span class="s1">&#39;llt&#39;</span><span class="p">])</span>
<span class="n">avdf</span><span class="p">[</span><span class="s1">&#39;WGF6&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">avdf</span><span class="p">[</span><span class="s1">&#39;WGF6&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">(),</span> <span class="n">avdf</span><span class="p">[</span><span class="s1">&#39;AWND&#39;</span><span class="p">],</span> <span class="n">avdf</span><span class="p">[</span><span class="s1">&#39;WGF6&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[37]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="n">avdf</span><span class="o">.</span><span class="n">to_sql</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;for_model_avgs&#39;</span><span class="p">,</span> <span class="n">con</span><span class="o">=</span><span class="n">con</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">if_exists</span><span class="o">=</span><span class="s1">&#39;replace&#39;</span><span class="p">)</span>
<span class="n">avdf</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;for_model_avgs.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[38]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span><span class="n">avdf</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[38]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>event_date</th>
      <th>event_name</th>
      <th>num_flooded</th>
      <th>WDF2</th>
      <th>WSF2</th>
      <th>AWDR</th>
      <th>AWND</th>
      <th>WGF6</th>
      <th>ht</th>
      <th>hht</th>
      <th>lt</th>
      <th>llt</th>
      <th>r15_td</th>
      <th>rhr_td</th>
      <th>td_av</th>
      <th>gw_av</th>
      <th>r15mx</th>
      <th>rhrmx</th>
      <th>rd</th>
      <th>r3d</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2010-09-30</td>
      <td>Nicole-2010-09-30</td>
      <td>101.0</td>
      <td>121.666667</td>
      <td>25.966667</td>
      <td>291.666667</td>
      <td>12.100000</td>
      <td>12.100000</td>
      <td>3.21050</td>
      <td>3.61750</td>
      <td>1.18600</td>
      <td>0.53300</td>
      <td>1.156938</td>
      <td>0.926854</td>
      <td>1.452974</td>
      <td>4.340699</td>
      <td>0.605000</td>
      <td>1.322500e+00</td>
      <td>7.732500</td>
      <td>3.518000e+00</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2010-12-16</td>
      <td>Snow-2010-12-16</td>
      <td>2.0</td>
      <td>205.000000</td>
      <td>15.000000</td>
      <td>213.000000</td>
      <td>2.700000</td>
      <td>2.700000</td>
      <td>0.66100</td>
      <td>0.86100</td>
      <td>-1.13000</td>
      <td>-1.22350</td>
      <td>-0.039190</td>
      <td>0.132667</td>
      <td>-0.202140</td>
      <td>2.208326</td>
      <td>0.030000</td>
      <td>7.000000e-02</td>
      <td>0.227500</td>
      <td>4.500000e-02</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2011-08-27</td>
      <td>Irene-2011-08-27</td>
      <td>110.0</td>
      <td>158.750000</td>
      <td>27.125000</td>
      <td>133.305686</td>
      <td>12.421368</td>
      <td>13.953947</td>
      <td>2.23750</td>
      <td>4.96800</td>
      <td>2.69850</td>
      <td>-0.69250</td>
      <td>3.204875</td>
      <td>3.158667</td>
      <td>1.095753</td>
      <td>2.334049</td>
      <td>0.350000</td>
      <td>1.101250e+00</td>
      <td>6.294167</td>
      <td>3.080000e-01</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2012-10-28</td>
      <td>Sandy-2012-10-28</td>
      <td>105.0</td>
      <td>18.333333</td>
      <td>38.316667</td>
      <td>113.786208</td>
      <td>18.973074</td>
      <td>20.061461</td>
      <td>5.22800</td>
      <td>5.57600</td>
      <td>3.28400</td>
      <td>1.58100</td>
      <td>4.753823</td>
      <td>4.328802</td>
      <td>2.749344</td>
      <td>2.998493</td>
      <td>0.140000</td>
      <td>4.262500e-01</td>
      <td>4.805833</td>
      <td>3.410000e-01</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2013-10-09</td>
      <td>Heavy Rain-2013-10-09</td>
      <td>36.0</td>
      <td>31.666667</td>
      <td>32.550000</td>
      <td>40.045150</td>
      <td>15.999780</td>
      <td>15.315069</td>
      <td>3.49250</td>
      <td>4.21250</td>
      <td>2.08300</td>
      <td>1.08450</td>
      <td>3.835031</td>
      <td>3.914865</td>
      <td>2.244865</td>
      <td>2.141837</td>
      <td>0.375000</td>
      <td>8.000000e-01</td>
      <td>3.671667</td>
      <td>9.240000e-01</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2014-05-16</td>
      <td>Heavy Rain-2014-05-16</td>
      <td>35.0</td>
      <td>200.000000</td>
      <td>22.450000</td>
      <td>217.404042</td>
      <td>6.933247</td>
      <td>9.721000</td>
      <td>1.84200</td>
      <td>2.63900</td>
      <td>-0.98425</td>
      <td>-0.98425</td>
      <td>0.614093</td>
      <td>0.818426</td>
      <td>0.560302</td>
      <td>3.620773</td>
      <td>0.498889</td>
      <td>1.413333e+00</td>
      <td>2.923333</td>
      <td>1.272727e-02</td>
    </tr>
    <tr>
      <th>6</th>
      <td>2014-06-09</td>
      <td>unnamed-2014-06-09</td>
      <td>1.0</td>
      <td>170.000000</td>
      <td>16.000000</td>
      <td>197.291344</td>
      <td>7.485292</td>
      <td>8.440377</td>
      <td>1.04650</td>
      <td>1.80950</td>
      <td>-0.88900</td>
      <td>-1.01400</td>
      <td>0.772417</td>
      <td>0.805500</td>
      <td>0.306098</td>
      <td>2.362913</td>
      <td>0.015556</td>
      <td>1.888889e-02</td>
      <td>0.016667</td>
      <td>2.727273e-03</td>
    </tr>
    <tr>
      <th>7</th>
      <td>2014-06-19</td>
      <td>Thunderstorms-2014-06-19</td>
      <td>5.0</td>
      <td>152.500000</td>
      <td>20.800000</td>
      <td>172.140479</td>
      <td>6.515842</td>
      <td>7.648271</td>
      <td>1.85100</td>
      <td>2.11200</td>
      <td>-0.74300</td>
      <td>-0.76450</td>
      <td>1.340093</td>
      <td>1.100796</td>
      <td>0.581874</td>
      <td>2.432714</td>
      <td>0.556667</td>
      <td>8.611111e-01</td>
      <td>0.747500</td>
      <td>2.727273e-03</td>
    </tr>
    <tr>
      <th>8</th>
      <td>2014-07-03</td>
      <td>Arthur-2014-07-03</td>
      <td>8.0</td>
      <td>260.000000</td>
      <td>25.775000</td>
      <td>222.405868</td>
      <td>11.009788</td>
      <td>13.990583</td>
      <td>1.83550</td>
      <td>2.14250</td>
      <td>0.66950</td>
      <td>0.01800</td>
      <td>1.343537</td>
      <td>1.352315</td>
      <td>0.668728</td>
      <td>2.162596</td>
      <td>0.223333</td>
      <td>3.833333e-01</td>
      <td>1.039167</td>
      <td>1.363636e-02</td>
    </tr>
    <tr>
      <th>9</th>
      <td>2014-07-09</td>
      <td>Thunderstorms-2014-07-09</td>
      <td>2.0</td>
      <td>260.000000</td>
      <td>34.000000</td>
      <td>224.827356</td>
      <td>9.101778</td>
      <td>10.333042</td>
      <td>0.38750</td>
      <td>1.35500</td>
      <td>-1.76125</td>
      <td>-1.76125</td>
      <td>0.903926</td>
      <td>0.982981</td>
      <td>-0.288448</td>
      <td>0.710830</td>
      <td>0.463333</td>
      <td>9.066667e-01</td>
      <td>1.367500</td>
      <td>2.727273e-03</td>
    </tr>
    <tr>
      <th>10</th>
      <td>2014-07-10</td>
      <td>7/10 Thunderstorms-2014-07-10</td>
      <td>39.0</td>
      <td>285.000000</td>
      <td>21.450000</td>
      <td>210.890667</td>
      <td>4.966701</td>
      <td>5.531208</td>
      <td>1.06800</td>
      <td>1.79950</td>
      <td>-1.45650</td>
      <td>-1.38800</td>
      <td>-0.957500</td>
      <td>-0.593889</td>
      <td>0.001204</td>
      <td>0.926804</td>
      <td>0.893333</td>
      <td>1.747778e+00</td>
      <td>2.010833</td>
      <td>1.493636e+00</td>
    </tr>
    <tr>
      <th>11</th>
      <td>2014-07-24</td>
      <td>unnamed-2014-07-24</td>
      <td>18.0</td>
      <td>102.500000</td>
      <td>25.500000</td>
      <td>159.163405</td>
      <td>5.955519</td>
      <td>7.173125</td>
      <td>1.48150</td>
      <td>2.34050</td>
      <td>-0.88400</td>
      <td>-0.94000</td>
      <td>1.670667</td>
      <td>1.982657</td>
      <td>0.408778</td>
      <td>2.574194</td>
      <td>0.637778</td>
      <td>1.372222e+00</td>
      <td>2.191667</td>
      <td>1.818182e-03</td>
    </tr>
    <tr>
      <th>12</th>
      <td>2014-08-18</td>
      <td>AUG 18 2014-2014-08-18</td>
      <td>1.0</td>
      <td>300.000000</td>
      <td>22.500000</td>
      <td>215.288944</td>
      <td>3.689635</td>
      <td>4.885292</td>
      <td>1.41750</td>
      <td>2.02600</td>
      <td>-0.72850</td>
      <td>-0.60050</td>
      <td>1.795750</td>
      <td>1.863167</td>
      <td>0.550702</td>
      <td>2.407198</td>
      <td>0.511111</td>
      <td>9.666667e-01</td>
      <td>0.904167</td>
      <td>6.190909e-01</td>
    </tr>
    <tr>
      <th>13</th>
      <td>2014-09-04</td>
      <td>Thunderstorm-2014-09-04</td>
      <td>5.0</td>
      <td>120.000000</td>
      <td>17.000000</td>
      <td>188.727611</td>
      <td>4.663819</td>
      <td>5.959750</td>
      <td>1.34350</td>
      <td>1.85700</td>
      <td>-0.87100</td>
      <td>-0.87100</td>
      <td>1.165885</td>
      <td>1.422385</td>
      <td>0.461850</td>
      <td>2.043983</td>
      <td>0.322222</td>
      <td>7.788889e-01</td>
      <td>1.052500</td>
      <td>-1.059758e-16</td>
    </tr>
    <tr>
      <th>14</th>
      <td>2014-09-08</td>
      <td>Rainy Monday-2014-09-08</td>
      <td>31.0</td>
      <td>45.000000</td>
      <td>27.000000</td>
      <td>75.697774</td>
      <td>9.935909</td>
      <td>8.687821</td>
      <td>3.50900</td>
      <td>3.52200</td>
      <td>-0.08600</td>
      <td>-0.08650</td>
      <td>0.572093</td>
      <td>0.594898</td>
      <td>1.504349</td>
      <td>2.830470</td>
      <td>0.592222</td>
      <td>1.478889e+00</td>
      <td>4.058333</td>
      <td>2.454545e-02</td>
    </tr>
    <tr>
      <th>15</th>
      <td>2014-09-13</td>
      <td>Saturday Storm 9/13-2014-09-13</td>
      <td>3.0</td>
      <td>180.000000</td>
      <td>22.000000</td>
      <td>92.508083</td>
      <td>5.992295</td>
      <td>6.320750</td>
      <td>2.40825</td>
      <td>2.47000</td>
      <td>-0.33875</td>
      <td>-0.33875</td>
      <td>1.321167</td>
      <td>1.193426</td>
      <td>1.082190</td>
      <td>2.874893</td>
      <td>0.195556</td>
      <td>2.822222e-01</td>
      <td>0.329167</td>
      <td>2.272727e-02</td>
    </tr>
    <tr>
      <th>16</th>
      <td>2014-09-24</td>
      <td>HEAVY RAIN-2014-09-24</td>
      <td>1.0</td>
      <td>65.000000</td>
      <td>27.950000</td>
      <td>57.001569</td>
      <td>14.154351</td>
      <td>12.695833</td>
      <td>2.96175</td>
      <td>2.96175</td>
      <td>0.52800</td>
      <td>-0.51300</td>
      <td>2.342056</td>
      <td>2.002852</td>
      <td>1.425225</td>
      <td>2.639212</td>
      <td>0.147778</td>
      <td>3.066667e-01</td>
      <td>1.155833</td>
      <td>1.136364e-01</td>
    </tr>
    <tr>
      <th>17</th>
      <td>2014-09-29</td>
      <td>unnamed-2014-09-29</td>
      <td>2.0</td>
      <td>342.500000</td>
      <td>21.725000</td>
      <td>254.847430</td>
      <td>8.409333</td>
      <td>9.590143</td>
      <td>2.40150</td>
      <td>3.84850</td>
      <td>0.89650</td>
      <td>-0.80900</td>
      <td>2.736531</td>
      <td>3.161510</td>
      <td>1.292521</td>
      <td>2.515861</td>
      <td>0.011111</td>
      <td>1.777778e-02</td>
      <td>0.035000</td>
      <td>2.000000e-02</td>
    </tr>
    <tr>
      <th>18</th>
      <td>2014-11-17</td>
      <td>STORM 11/17/14-2014-11-17</td>
      <td>1.0</td>
      <td>250.000000</td>
      <td>27.950000</td>
      <td>219.905497</td>
      <td>9.485922</td>
      <td>11.606500</td>
      <td>1.10550</td>
      <td>1.56000</td>
      <td>-0.68100</td>
      <td>-0.68700</td>
      <td>0.938167</td>
      <td>0.944278</td>
      <td>0.359335</td>
      <td>2.021128</td>
      <td>0.104444</td>
      <td>1.577778e-01</td>
      <td>0.175000</td>
      <td>1.672727e-01</td>
    </tr>
    <tr>
      <th>19</th>
      <td>2014-11-23</td>
      <td>unnamed-2014-11-23</td>
      <td>4.0</td>
      <td>171.666667</td>
      <td>21.850000</td>
      <td>191.674478</td>
      <td>6.530780</td>
      <td>7.766125</td>
      <td>2.03900</td>
      <td>2.78550</td>
      <td>-0.86525</td>
      <td>-1.90750</td>
      <td>0.295287</td>
      <td>0.736574</td>
      <td>0.021980</td>
      <td>2.875690</td>
      <td>0.338889</td>
      <td>7.311111e-01</td>
      <td>2.433333</td>
      <td>9.545455e-02</td>
    </tr>
    <tr>
      <th>20</th>
      <td>2015-03-02</td>
      <td>unnamed-2015-03-02</td>
      <td>10.0</td>
      <td>121.666667</td>
      <td>22.016667</td>
      <td>151.691163</td>
      <td>6.923044</td>
      <td>6.586247</td>
      <td>1.43350</td>
      <td>2.38875</td>
      <td>-0.88750</td>
      <td>-1.26800</td>
      <td>0.761667</td>
      <td>0.676241</td>
      <td>0.047581</td>
      <td>3.301304</td>
      <td>0.687778</td>
      <td>1.195556e+00</td>
      <td>3.129167</td>
      <td>3.430000e-01</td>
    </tr>
    <tr>
      <th>21</th>
      <td>2015-07-02</td>
      <td>unnamed-2015-07-02</td>
      <td>7.0</td>
      <td>200.000000</td>
      <td>22.033333</td>
      <td>197.385860</td>
      <td>6.563332</td>
      <td>7.392972</td>
      <td>1.83200</td>
      <td>2.43950</td>
      <td>-0.96950</td>
      <td>-0.83150</td>
      <td>0.078315</td>
      <td>0.456028</td>
      <td>0.505675</td>
      <td>2.621138</td>
      <td>0.701111</td>
      <td>1.686667e+00</td>
      <td>2.077500</td>
      <td>4.545455e-03</td>
    </tr>
    <tr>
      <th>22</th>
      <td>2015-07-11</td>
      <td>Thunderstorm-2015-07-11</td>
      <td>10.0</td>
      <td>50.000000</td>
      <td>21.450000</td>
      <td>121.077398</td>
      <td>5.114062</td>
      <td>5.403833</td>
      <td>1.66200</td>
      <td>2.39050</td>
      <td>-0.83150</td>
      <td>-0.83150</td>
      <td>0.258481</td>
      <td>0.545657</td>
      <td>0.723729</td>
      <td>2.661766</td>
      <td>0.665556</td>
      <td>1.667778e+00</td>
      <td>1.745000</td>
      <td>1.090909e-02</td>
    </tr>
    <tr>
      <th>23</th>
      <td>2015-09-02</td>
      <td>09/02/15-2015-09-02</td>
      <td>1.0</td>
      <td>230.000000</td>
      <td>23.050000</td>
      <td>225.087134</td>
      <td>4.230049</td>
      <td>4.260750</td>
      <td>1.89300</td>
      <td>2.25600</td>
      <td>-1.09900</td>
      <td>-1.45650</td>
      <td>-0.696593</td>
      <td>-0.769759</td>
      <td>0.383665</td>
      <td>1.760070</td>
      <td>0.314444</td>
      <td>4.622222e-01</td>
      <td>0.404167</td>
      <td>1.500000e-01</td>
    </tr>
    <tr>
      <th>24</th>
      <td>2015-09-17</td>
      <td>unnamed-2015-09-17</td>
      <td>1.0</td>
      <td>57.500000</td>
      <td>17.800000</td>
      <td>79.987343</td>
      <td>8.224828</td>
      <td>8.630750</td>
      <td>2.63650</td>
      <td>3.02650</td>
      <td>-1.02500</td>
      <td>0.66400</td>
      <td>-0.162833</td>
      <td>-0.162833</td>
      <td>1.094373</td>
      <td>1.758351</td>
      <td>0.001000</td>
      <td>1.000000e-03</td>
      <td>0.000833</td>
      <td>2.181818e-02</td>
    </tr>
    <tr>
      <th>25</th>
      <td>2015-09-24</td>
      <td>Noreaster-2015-09-24</td>
      <td>16.0</td>
      <td>58.750000</td>
      <td>24.200000</td>
      <td>42.764968</td>
      <td>9.875646</td>
      <td>11.669104</td>
      <td>3.79250</td>
      <td>3.78875</td>
      <td>0.63150</td>
      <td>0.50850</td>
      <td>1.838700</td>
      <td>1.420792</td>
      <td>1.925629</td>
      <td>1.766086</td>
      <td>0.068000</td>
      <td>1.320000e-01</td>
      <td>0.615833</td>
      <td>2.583333e-02</td>
    </tr>
    <tr>
      <th>26</th>
      <td>2015-09-29</td>
      <td>Joaquin-2015-09-29</td>
      <td>159.0</td>
      <td>72.857143</td>
      <td>28.514286</td>
      <td>55.291666</td>
      <td>10.502948</td>
      <td>13.143893</td>
      <td>4.59350</td>
      <td>5.29050</td>
      <td>3.03450</td>
      <td>2.76900</td>
      <td>2.076292</td>
      <td>2.497942</td>
      <td>2.419092</td>
      <td>2.935735</td>
      <td>0.255000</td>
      <td>6.180000e-01</td>
      <td>6.339167</td>
      <td>5.508333e-01</td>
    </tr>
    <tr>
      <th>27</th>
      <td>2015-10-30</td>
      <td>unnamed-2015-10-30</td>
      <td>1.0</td>
      <td>217.500000</td>
      <td>15.775000</td>
      <td>147.523074</td>
      <td>5.494538</td>
      <td>5.033875</td>
      <td>1.82400</td>
      <td>2.59200</td>
      <td>-0.65600</td>
      <td>-1.16000</td>
      <td>-0.564508</td>
      <td>-0.603183</td>
      <td>0.599771</td>
      <td>2.476362</td>
      <td>0.022000</td>
      <td>3.400000e-02</td>
      <td>0.035833</td>
      <td>2.150000e-01</td>
    </tr>
    <tr>
      <th>28</th>
      <td>2015-12-30</td>
      <td>Heavy Rainfall-2015-12-30</td>
      <td>3.0</td>
      <td>205.000000</td>
      <td>18.000000</td>
      <td>128.655127</td>
      <td>5.136507</td>
      <td>4.397442</td>
      <td>2.11950</td>
      <td>2.22950</td>
      <td>-0.11850</td>
      <td>-0.53150</td>
      <td>1.624617</td>
      <td>1.257808</td>
      <td>0.759690</td>
      <td>3.008229</td>
      <td>0.080000</td>
      <td>2.580000e-01</td>
      <td>0.724167</td>
      <td>2.208333e-01</td>
    </tr>
    <tr>
      <th>29</th>
      <td>2016-01-15</td>
      <td>01/15/2016-2016-01-15</td>
      <td>6.0</td>
      <td>355.000000</td>
      <td>24.050000</td>
      <td>117.412718</td>
      <td>7.494908</td>
      <td>7.799319</td>
      <td>0.96600</td>
      <td>0.88450</td>
      <td>-1.60600</td>
      <td>-1.95050</td>
      <td>-0.953500</td>
      <td>-0.615533</td>
      <td>-0.259944</td>
      <td>2.720648</td>
      <td>0.220000</td>
      <td>6.690000e-01</td>
      <td>1.062500</td>
      <td>9.166667e-03</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2142</th>
      <td>2016-09-01</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>170.000000</td>
      <td>23.900000</td>
      <td>219.272910</td>
      <td>6.915144</td>
      <td>6.915144</td>
      <td>2.20250</td>
      <td>2.14900</td>
      <td>-0.59050</td>
      <td>-1.05150</td>
      <td>-0.269533</td>
      <td>-0.043000</td>
      <td>0.703694</td>
      <td>1.966689</td>
      <td>0.239000</td>
      <td>3.240000e-01</td>
      <td>0.363333</td>
      <td>1.666667e-03</td>
    </tr>
    <tr>
      <th>2143</th>
      <td>2016-09-05</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>185.000000</td>
      <td>17.550000</td>
      <td>236.900312</td>
      <td>8.762227</td>
      <td>8.762227</td>
      <td>3.11650</td>
      <td>3.20700</td>
      <td>0.57600</td>
      <td>0.39700</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.778340</td>
      <td>2.628968</td>
      <td>0.000000</td>
      <td>-1.154805e-15</td>
      <td>0.000000</td>
      <td>3.314167e+00</td>
    </tr>
    <tr>
      <th>2144</th>
      <td>2016-09-06</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>290.000000</td>
      <td>19.000000</td>
      <td>268.079479</td>
      <td>8.265968</td>
      <td>8.265968</td>
      <td>2.53300</td>
      <td>2.99200</td>
      <td>0.78750</td>
      <td>0.15400</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.616696</td>
      <td>2.572870</td>
      <td>0.000000</td>
      <td>-1.154805e-15</td>
      <td>0.000000</td>
      <td>3.080000e+00</td>
    </tr>
    <tr>
      <th>2145</th>
      <td>2016-09-07</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>265.000000</td>
      <td>16.100000</td>
      <td>253.658799</td>
      <td>6.779097</td>
      <td>6.779097</td>
      <td>2.46400</td>
      <td>2.60000</td>
      <td>0.25300</td>
      <td>0.06200</td>
      <td>1.691458</td>
      <td>1.758167</td>
      <td>1.281285</td>
      <td>2.513385</td>
      <td>0.004000</td>
      <td>5.000000e-03</td>
      <td>0.005000</td>
      <td>1.666667e-03</td>
    </tr>
    <tr>
      <th>2146</th>
      <td>2016-09-08</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>220.000000</td>
      <td>18.000000</td>
      <td>227.405014</td>
      <td>6.639528</td>
      <td>6.639528</td>
      <td>1.72250</td>
      <td>1.86050</td>
      <td>-0.29550</td>
      <td>-0.32650</td>
      <td>0.227350</td>
      <td>0.103058</td>
      <td>0.717969</td>
      <td>2.518023</td>
      <td>0.124000</td>
      <td>2.450000e-01</td>
      <td>0.341667</td>
      <td>5.000000e-03</td>
    </tr>
    <tr>
      <th>2147</th>
      <td>2016-09-09</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>200.000000</td>
      <td>15.550000</td>
      <td>216.664076</td>
      <td>8.535810</td>
      <td>8.535810</td>
      <td>1.29250</td>
      <td>1.52900</td>
      <td>-0.49200</td>
      <td>-0.62200</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.433669</td>
      <td>2.496469</td>
      <td>0.000000</td>
      <td>-1.163479e-15</td>
      <td>0.000000</td>
      <td>3.466667e-01</td>
    </tr>
    <tr>
      <th>2148</th>
      <td>2016-09-10</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>210.000000</td>
      <td>16.550000</td>
      <td>207.154319</td>
      <td>9.490588</td>
      <td>9.490588</td>
      <td>1.02850</td>
      <td>1.48800</td>
      <td>-0.65300</td>
      <td>-0.79550</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.337860</td>
      <td>2.428361</td>
      <td>0.000000</td>
      <td>-1.163479e-15</td>
      <td>0.000000</td>
      <td>3.466667e-01</td>
    </tr>
    <tr>
      <th>2149</th>
      <td>2016-09-11</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>195.000000</td>
      <td>16.550000</td>
      <td>86.181326</td>
      <td>9.627574</td>
      <td>9.627574</td>
      <td>0.67750</td>
      <td>1.79950</td>
      <td>-0.45900</td>
      <td>-0.78900</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.309885</td>
      <td>2.378088</td>
      <td>0.000000</td>
      <td>-1.163479e-15</td>
      <td>0.000000</td>
      <td>3.416667e-01</td>
    </tr>
    <tr>
      <th>2150</th>
      <td>2016-09-12</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>55.000000</td>
      <td>17.000000</td>
      <td>69.988778</td>
      <td>8.600306</td>
      <td>8.600306</td>
      <td>1.40900</td>
      <td>1.93900</td>
      <td>-0.67600</td>
      <td>-0.43300</td>
      <td>-0.161833</td>
      <td>-0.161833</td>
      <td>0.691865</td>
      <td>2.304528</td>
      <td>0.001000</td>
      <td>1.000000e-03</td>
      <td>0.000833</td>
      <td>-2.243576e-16</td>
    </tr>
    <tr>
      <th>2151</th>
      <td>2016-09-13</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>85.000000</td>
      <td>13.550000</td>
      <td>118.482812</td>
      <td>5.494542</td>
      <td>5.494542</td>
      <td>1.82250</td>
      <td>1.97500</td>
      <td>-0.37875</td>
      <td>-0.37875</td>
      <td>0.083500</td>
      <td>0.083500</td>
      <td>0.744329</td>
      <td>2.264659</td>
      <td>0.002000</td>
      <td>2.000000e-03</td>
      <td>0.001667</td>
      <td>8.333333e-04</td>
    </tr>
    <tr>
      <th>2152</th>
      <td>2016-09-14</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>250.000000</td>
      <td>14.550000</td>
      <td>222.045771</td>
      <td>7.139278</td>
      <td>7.139278</td>
      <td>1.56350</td>
      <td>1.90750</td>
      <td>-0.99250</td>
      <td>-0.95800</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.410285</td>
      <td>2.234130</td>
      <td>0.000000</td>
      <td>-1.163479e-15</td>
      <td>0.000000</td>
      <td>2.500000e-03</td>
    </tr>
    <tr>
      <th>2153</th>
      <td>2016-09-15</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>45.000000</td>
      <td>20.900000</td>
      <td>76.136049</td>
      <td>11.042051</td>
      <td>11.042051</td>
      <td>2.08000</td>
      <td>2.94150</td>
      <td>-0.87125</td>
      <td>-0.87125</td>
      <td>0.830583</td>
      <td>0.830583</td>
      <td>0.865510</td>
      <td>2.196416</td>
      <td>0.011000</td>
      <td>1.100000e-02</td>
      <td>0.009167</td>
      <td>2.500000e-03</td>
    </tr>
    <tr>
      <th>2154</th>
      <td>2016-09-16</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>65.000000</td>
      <td>17.100000</td>
      <td>59.530472</td>
      <td>10.448505</td>
      <td>10.448505</td>
      <td>2.82650</td>
      <td>2.92000</td>
      <td>-0.42500</td>
      <td>-0.42500</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.259379</td>
      <td>2.158913</td>
      <td>0.000000</td>
      <td>-1.163826e-15</td>
      <td>0.000000</td>
      <td>1.083333e-02</td>
    </tr>
    <tr>
      <th>2155</th>
      <td>2016-09-17</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>70.000000</td>
      <td>16.550000</td>
      <td>81.309458</td>
      <td>6.657028</td>
      <td>6.657028</td>
      <td>2.48850</td>
      <td>2.72950</td>
      <td>-0.79750</td>
      <td>-0.59700</td>
      <td>0.406000</td>
      <td>0.406000</td>
      <td>0.969788</td>
      <td>2.125492</td>
      <td>0.001000</td>
      <td>1.000000e-03</td>
      <td>0.000833</td>
      <td>9.166667e-03</td>
    </tr>
    <tr>
      <th>2156</th>
      <td>2016-09-18</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>135.000000</td>
      <td>15.100000</td>
      <td>142.528799</td>
      <td>4.651894</td>
      <td>4.651894</td>
      <td>2.13750</td>
      <td>2.54750</td>
      <td>-1.02050</td>
      <td>-1.11350</td>
      <td>2.080000</td>
      <td>2.080000</td>
      <td>0.656565</td>
      <td>2.114475</td>
      <td>0.002000</td>
      <td>2.000000e-03</td>
      <td>0.001667</td>
      <td>1.000000e-02</td>
    </tr>
    <tr>
      <th>2157</th>
      <td>2016-09-23</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>185.000000</td>
      <td>15.100000</td>
      <td>43.685465</td>
      <td>5.534912</td>
      <td>5.534912</td>
      <td>2.21250</td>
      <td>2.43250</td>
      <td>-0.34950</td>
      <td>-0.34650</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.031713</td>
      <td>4.749323</td>
      <td>0.000000</td>
      <td>-1.128091e-15</td>
      <td>0.000000</td>
      <td>7.117500e+00</td>
    </tr>
    <tr>
      <th>2158</th>
      <td>2016-09-24</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>20.000000</td>
      <td>20.450000</td>
      <td>98.906889</td>
      <td>8.135833</td>
      <td>8.135833</td>
      <td>1.90800</td>
      <td>2.62600</td>
      <td>0.09650</td>
      <td>-0.57250</td>
      <td>-0.553333</td>
      <td>-0.553333</td>
      <td>1.062175</td>
      <td>4.378923</td>
      <td>0.001000</td>
      <td>1.000000e-03</td>
      <td>0.000833</td>
      <td>4.700833e+00</td>
    </tr>
    <tr>
      <th>2159</th>
      <td>2016-09-25</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>40.000000</td>
      <td>15.100000</td>
      <td>64.520576</td>
      <td>6.468889</td>
      <td>6.468889</td>
      <td>2.29350</td>
      <td>2.38350</td>
      <td>-0.15750</td>
      <td>-0.15750</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.201619</td>
      <td>4.091864</td>
      <td>0.000000</td>
      <td>-1.128091e-15</td>
      <td>0.000833</td>
      <td>5.491667e-01</td>
    </tr>
    <tr>
      <th>2160</th>
      <td>2016-09-26</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>200.000000</td>
      <td>12.100000</td>
      <td>155.280458</td>
      <td>4.588694</td>
      <td>4.588694</td>
      <td>1.94050</td>
      <td>2.04850</td>
      <td>-0.27550</td>
      <td>-0.64500</td>
      <td>0.294000</td>
      <td>0.294000</td>
      <td>0.794265</td>
      <td>3.822561</td>
      <td>0.010000</td>
      <td>1.000000e-02</td>
      <td>0.008333</td>
      <td>1.666667e-03</td>
    </tr>
    <tr>
      <th>2161</th>
      <td>2016-09-27</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>205.000000</td>
      <td>13.550000</td>
      <td>198.577694</td>
      <td>4.767412</td>
      <td>4.767412</td>
      <td>1.85850</td>
      <td>2.15400</td>
      <td>-0.59050</td>
      <td>-0.72200</td>
      <td>-0.473483</td>
      <td>-0.421200</td>
      <td>0.711148</td>
      <td>3.596045</td>
      <td>0.041000</td>
      <td>6.200000e-02</td>
      <td>0.057500</td>
      <td>1.000000e-02</td>
    </tr>
    <tr>
      <th>2162</th>
      <td>2016-09-28</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>125.000000</td>
      <td>16.100000</td>
      <td>129.953285</td>
      <td>4.938190</td>
      <td>4.938190</td>
      <td>2.26450</td>
      <td>2.26450</td>
      <td>-0.55300</td>
      <td>-0.67250</td>
      <td>0.454389</td>
      <td>0.521250</td>
      <td>0.884054</td>
      <td>3.378904</td>
      <td>0.015000</td>
      <td>1.900000e-02</td>
      <td>0.015833</td>
      <td>6.666667e-02</td>
    </tr>
    <tr>
      <th>2163</th>
      <td>2016-09-29</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>60.000000</td>
      <td>19.550000</td>
      <td>78.537792</td>
      <td>6.956380</td>
      <td>6.956380</td>
      <td>3.42100</td>
      <td>3.42100</td>
      <td>0.73650</td>
      <td>0.23450</td>
      <td>2.129242</td>
      <td>2.247075</td>
      <td>1.940133</td>
      <td>3.337218</td>
      <td>0.162000</td>
      <td>2.270000e-01</td>
      <td>0.240833</td>
      <td>8.166667e-02</td>
    </tr>
    <tr>
      <th>2164</th>
      <td>2016-09-30</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>110.000000</td>
      <td>14.000000</td>
      <td>88.550007</td>
      <td>5.250759</td>
      <td>5.250759</td>
      <td>3.49575</td>
      <td>3.49575</td>
      <td>0.71850</td>
      <td>0.63150</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2.121179</td>
      <td>3.331116</td>
      <td>0.000000</td>
      <td>-1.122366e-15</td>
      <td>0.000000</td>
      <td>3.141667e-01</td>
    </tr>
    <tr>
      <th>2165</th>
      <td>2016-10-02</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>55.000000</td>
      <td>14.100000</td>
      <td>49.696854</td>
      <td>6.488991</td>
      <td>6.488991</td>
      <td>2.63450</td>
      <td>2.63450</td>
      <td>0.24100</td>
      <td>-0.02800</td>
      <td>0.159760</td>
      <td>0.084542</td>
      <td>1.410452</td>
      <td>3.214233</td>
      <td>0.094000</td>
      <td>1.260000e-01</td>
      <td>0.124167</td>
      <td>3.341667e-01</td>
    </tr>
    <tr>
      <th>2166</th>
      <td>2016-10-03</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>25.000000</td>
      <td>12.550000</td>
      <td>52.292257</td>
      <td>6.059440</td>
      <td>6.059440</td>
      <td>2.31300</td>
      <td>2.61350</td>
      <td>-0.06050</td>
      <td>-0.18200</td>
      <td>1.708833</td>
      <td>1.642875</td>
      <td>1.179992</td>
      <td>3.170898</td>
      <td>0.011000</td>
      <td>1.200000e-02</td>
      <td>0.011667</td>
      <td>2.175000e-01</td>
    </tr>
    <tr>
      <th>2167</th>
      <td>2016-10-04</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>50.000000</td>
      <td>22.450000</td>
      <td>52.709250</td>
      <td>12.837861</td>
      <td>12.837861</td>
      <td>2.76400</td>
      <td>2.76400</td>
      <td>0.43450</td>
      <td>-0.06600</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.425225</td>
      <td>3.046787</td>
      <td>0.000000</td>
      <td>-1.127397e-15</td>
      <td>0.000000</td>
      <td>2.291667e-01</td>
    </tr>
    <tr>
      <th>2168</th>
      <td>2016-10-06</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>50.000000</td>
      <td>22.450000</td>
      <td>47.287896</td>
      <td>15.603421</td>
      <td>15.603421</td>
      <td>2.97750</td>
      <td>3.24350</td>
      <td>1.02700</td>
      <td>0.93150</td>
      <td>1.361767</td>
      <td>1.293017</td>
      <td>1.974862</td>
      <td>2.935604</td>
      <td>0.013000</td>
      <td>2.300000e-02</td>
      <td>0.049167</td>
      <td>2.000000e-02</td>
    </tr>
    <tr>
      <th>2169</th>
      <td>2016-10-07</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>75.000000</td>
      <td>21.000000</td>
      <td>77.900743</td>
      <td>11.376537</td>
      <td>11.376537</td>
      <td>2.47550</td>
      <td>2.48850</td>
      <td>0.48400</td>
      <td>0.39850</td>
      <td>2.358639</td>
      <td>2.358639</td>
      <td>1.408690</td>
      <td>2.906700</td>
      <td>0.003000</td>
      <td>6.000000e-03</td>
      <td>0.002500</td>
      <td>5.750000e-02</td>
    </tr>
    <tr>
      <th>2170</th>
      <td>2016-10-14</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>20.000000</td>
      <td>19.550000</td>
      <td>42.823597</td>
      <td>9.788102</td>
      <td>9.788102</td>
      <td>2.47500</td>
      <td>2.82950</td>
      <td>-0.45300</td>
      <td>-0.45300</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.165987</td>
      <td>4.206564</td>
      <td>0.000000</td>
      <td>-1.066335e-15</td>
      <td>0.000000</td>
      <td>8.333333e-04</td>
    </tr>
    <tr>
      <th>2171</th>
      <td>2016-10-15</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>65.000000</td>
      <td>14.550000</td>
      <td>69.724743</td>
      <td>3.915750</td>
      <td>3.915750</td>
      <td>2.57850</td>
      <td>2.62450</td>
      <td>-0.79850</td>
      <td>-0.90550</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.893731</td>
      <td>3.946949</td>
      <td>0.000000</td>
      <td>-1.066335e-15</td>
      <td>0.000000</td>
      <td>8.333333e-04</td>
    </tr>
  </tbody>
</table>
<p>2172 rows × 20 columns</p>
</div></div>
</div>
</div>


           </div>
           
          </div>
          <!-- 
This file modifies the default sphinx_rtd_theme footer
-->



<footer>
  

  <hr/>

  <div role="contentinfo">
    <p>

    </p>
  </div>
  <!-- your html code here -->


</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>