

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Reuse a published regional Landlab shallow landslide model to explore changes in forest cover at a subcatchment within the study area &mdash; CUAHSI Gallery</title>
  

  
  <link rel="stylesheet" href="../../../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../_static/graphviz.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../_static/copybutton.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../_static/tabs.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../_static/css/custom.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../_static/panels-bootstrap.5fd3999ee7762ccc51105388f4a9d115.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../_static/contentui.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../_static/sphinxcontrib-images/LightBox2/lightbox2/css/lightbox.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../../../" src="../../../../../_static/documentation_options.js"></script>
        <script src="../../../../../_static/jquery.js"></script>
        <script src="../../../../../_static/underscore.js"></script>
        <script src="../../../../../_static/doctools.js"></script>
        <script src="../../../../../_static/language_data.js"></script>
        <script src="../../../../../_static/clipboard.min.js"></script>
        <script src="../../../../../_static/copybutton.js"></script>
        <script src="../../../../../_static/js/custom.js"></script>
        <script src="../../../../../_static/contentui.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
        <script src="../../../../../_static/sphinxcontrib-images/LightBox2/lightbox2/js/jquery-1.11.0.min.js"></script>
        <script src="../../../../../_static/sphinxcontrib-images/LightBox2/lightbox2/js/lightbox.min.js"></script>
        <script src="../../../../../_static/sphinxcontrib-images/LightBox2/lightbox2-customize/jquery-noconflict.js"></script>
    
    <script type="text/javascript" src="../../../../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../../../index.html">
          

          
            
            <img src="../../../../../_static/cuahsi-logo.png" class="logo" alt="Logo"/>
          
          </a>

          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Galleries</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../index.html">Python</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../index.html#research-examples">Research Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../index.html#reproducible-science-examples">Reproducible Science Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../index.html#instructional-examples">Instructional Examples</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../R/index.html">R</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../R/index.html#instructional-examples">Instructional Examples</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../RShiny/index.html">RShiny</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../RShiny/index.html#research-examples">Research Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../RShiny/index.html#instructional-examples">Instructional Examples</a></li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../../index.html">CUAHSI Gallery</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          <!--
The purpose of this template is to override (i.e. supress) the breadcrumbs that appear at the top of each page.
-->


          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container,
div.nbinput.container div.prompt,
div.nbinput.container div.input_area,
div.nbinput.container div[class*=highlight],
div.nbinput.container div[class*=highlight] pre,
div.nboutput.container,
div.nboutput.container div.prompt,
div.nboutput.container div.output_area,
div.nboutput.container div[class*=highlight],
div.nboutput.container div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    background: #f5f5f5;
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<p><img alt="image.png" src="../../../../../_images/enabling-collaborative-landlab.png" /> <img alt="image1" src="../../../../../_images/enabling-collaborative-udub.png" /></p>
<div class="section" id="Reuse-a-published-regional-Landlab-shallow-landslide-model-to-explore-changes-in-forest-cover-at-a-subcatchment-within-the-study-area">
<h1>Reuse a published regional Landlab shallow landslide model to explore changes in forest cover at a subcatchment within the study area<a class="headerlink" href="#Reuse-a-published-regional-Landlab-shallow-landslide-model-to-explore-changes-in-forest-cover-at-a-subcatchment-within-the-study-area" title="Permalink to this headline">¶</a></h1>
<p><strong>You will explore how to reuse model code and data in a subregion within a larger region where the model was developed</strong></p>
<ul class="simple">
<li><p>Load data from a regional Landlab landslide model (Strauch et al., 2018) developed for the North Cascades National Park, WA USA, published on HydroShare.</p></li>
<li><p>Define a geographic subset (Thunder Creek watershed) within the study region.</p></li>
<li><p>Explore landslide probability sensitivity to fire by adjusting the cohesion parameter for Thunder Creek.</p></li>
<li><p>Save results to a new HydroShare resource.</p></li>
</ul>
<p>The shallow landslide model you will is based on a spatially distributed Monte Carlo solution of the infinite slope stability model. Detailes of the model and the study site are described in Strauch et al. (2018). Please see the end of this Notebook for Acknowledgements and Citation information.</p>
<p><strong>To run this notebook:</strong></p>
<p>Click in each shaded cell below and “shift + enter” to run each code block. Alternatively, you can run groups of cells by clicking “Cell” on the menu above and selecting your run options from the pull-down menu. This is also where you can clear outputs from previous runs.</p>
<p>If an error occurs, click on <em>Kernal</em> and <em>Restart and Clear Outputs</em> in the menu above.</p>
<div class="section" id="1.-Introduction">
<h2>1. Introduction<a class="headerlink" href="#1.-Introduction" title="Permalink to this headline">¶</a></h2>
<div class="section" id="1.1-Infinite-Slope-Factor-of-Safety-Equation">
<h3>1.1 Infinite Slope Factor of Safety Equation<a class="headerlink" href="#1.1-Infinite-Slope-Factor-of-Safety-Equation" title="Permalink to this headline">¶</a></h3>
<p>This equation predicts the ratio of stabilizing to destabilizing forces on a hillslope plane. The properties are assumed to represent an infinte plane, neglecting the boundary conditions around the landslide location. When FS&lt;1, the slope is instable.</p>
<img alt="image.png" src="../../../../../_images/enabling-collaborative-eq1.png" />
<img alt="image.png" src="../../../../../_images/enabling-collaborative-eq1-text.png" />
<p>C* can be calculated by the ratio of the sum of root cohesion, Cr, and soil cohesion, Cs, to the product of soil depth, density, and gravity.</p>
<img alt="image.png" src="../../../../../_images/enabling-collaborative-eq2.png" />
<p>Relative wetness is the ratio of depth of water subsurface flow above an impervious layer to the depth of soil.</p>
<img alt="image.png" src="../../../../../_images/enabling-collaborative-eq3.png" />
<p>R: recharge rate to water table (m/d) T: soil transmissivity (m^2/d) a: specific catchment area (m).</p>
</div>
<div class="section" id="1.2-Monte-Carlo-solution-of-the-FS-equation">
<h3>1.2 Monte Carlo solution of the FS equation<a class="headerlink" href="#1.2-Monte-Carlo-solution-of-the-FS-equation" title="Permalink to this headline">¶</a></h3>
<p>Below the Monte Carlo approach used by Strauch et al. (2018) is illustrated in a figure. At each node of the model grid variables for soil and vegetation are generated from triangular distributions. Recharge to water table is obtained from hydrologic model simulations by selecting the largest daily value for each year. Probability of shallow landslide initiation is defined as the ratio of number of times FS&lt;1 to the total sample size of FS calculations.</p>
<img alt="image.png" src="../../../../../_images/enabling-collaborative-diagram1.png" />
</div>
<div class="section" id="Module-overview-for-a-Landlab-Modeling-Toolkit-Landslide-Introduction">
<h3>Module overview for a Landlab Modeling Toolkit Landslide Introduction<a class="headerlink" href="#Module-overview-for-a-Landlab-Modeling-Toolkit-Landslide-Introduction" title="Permalink to this headline">¶</a></h3>
<p>This Jupyter Notebook runs the Landlab LandslideProbability component on a 30-m digital elevation model (DEM) for Thunder Creek, a subwaterhsed in the larger study domain developed by Strauch et al. (2018), using <em>data driven spatial</em> recharge distribution as described in the paper (<a class="reference external" href="https://www.earth-surf-dynam.net/6/1/2018/">https://www.earth-surf-dynam.net/6/1/2018/</a>).</p>
<p>To run a landslide demonstration using the paper data and approach we will: 1) Import data from North Cascades National Park (NOCA: study area) 2) Review data needed as input for the landslide model 3) Create a RasterModelGrid based on a 30-m DEM - subset to Thunder Creek watershed 4) Assign data fields used to calculate landslide probability 5) Specify recharge option as <em>data driven spatial</em> and access Python dictionaries to generate recharge distributions 6) Set Number of iterations to run
Monte Carlo simulation 7) Run Landlab LandslideProbability component 8) Run the model again to simulate post-fire conditions, 9) Display and visualize results of stability analysis 10) Save Notebook and Results back to HydroShare</p>
<p>The estimated time to run this Notebook is 30-60 minutes with 20 minutes of computation time.</p>
</div>
</div>
<div class="section" id="2.0-Data-Science-&amp;-Cyberinfrastructure-Methods">
<h2>2.0 Data Science &amp; Cyberinfrastructure Methods<a class="headerlink" href="#2.0-Data-Science-&-Cyberinfrastructure-Methods" title="Permalink to this headline">¶</a></h2>
<p>Update or add libraries that are not installed on the CUAHSI JupyterHub server. At the time of publication, the Landlab library was dependent on a different numpy library than installed in the software environment. The code block below was added as an example of how to update a library to a new version and restart the notebook kernel. If this update is not needed, comment with a &lt;#&gt;. If other updates are needed, add them below.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># comment this out if this update is not needed</span>
<span class="o">!</span>conda update -y numpy
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">display_html</span>
<span class="n">display_html</span><span class="p">(</span><span class="s2">&quot;&lt;script&gt;Jupyter.notebook.kernel.restart()&lt;/script&gt;&quot;</span><span class="p">,</span><span class="n">raw</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="2.1-Data-Science-Methods">
<h3>2.1 Data Science Methods<a class="headerlink" href="#2.1-Data-Science-Methods" title="Permalink to this headline">¶</a></h3>
<div class="section" id="2.1.1-Import-Landlab-components,-functions-for-importing-data,-plotting-tools,-and-HydroShare-utilities">
<h4>2.1.1 Import Landlab components, functions for importing data, plotting tools, and HydroShare utilities<a class="headerlink" href="#2.1.1-Import-Landlab-components,-functions-for-importing-data,-plotting-tools,-and-HydroShare-utilities" title="Permalink to this headline">¶</a></h4>
<p>To run this notebook, we must import several libraries. The hs_utils library provides functions for interacting with HydroShare, including resource querying, dowloading. and creation. Additional libraries support the functions of Landlab. The CUAHSI JupyterHub server provides many Python packages and libraries, but to add additional libraries to your personal user space, use the cell below. To request an Installation to the server, visit <a class="reference external" href="https://github.com/hydroshare/hydroshare-jupyterhub">https://github.com/hydroshare/hydroshare-jupyterhub</a>,
create a New Issue, and add the label ‘Installation Request’.</p>
</div>
<div class="section" id="2.1.2-Import-Python-libraries">
<h4>2.1.2 Import Python libraries<a class="headerlink" href="#2.1.2-Import-Python-libraries" title="Permalink to this headline">¶</a></h4>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#Import standard Python utilities for calculating and plotting</span>
<span class="kn">import</span> <span class="nn">six</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="kn">import</span> <span class="nn">matplotlib</span> <span class="k">as</span> <span class="nn">mpl</span>
<span class="n">mpl</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;agg&#39;</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">pickle</span> <span class="k">as</span> <span class="nn">pickle</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span><span class="p">,</span> <span class="n">timedelta</span>
<span class="kn">import</span> <span class="nn">geopandas</span> <span class="k">as</span> <span class="nn">gpd</span>

<span class="c1"># Import Landlab libraries</span>
<span class="kn">from</span> <span class="nn">landlab.components</span> <span class="kn">import</span> <span class="n">LandslideProbability</span>
<span class="kn">from</span> <span class="nn">landlab</span> <span class="kn">import</span> <span class="n">imshow_grid_at_node</span>
<span class="kn">from</span> <span class="nn">landlab.io</span> <span class="kn">import</span> <span class="n">read_esri_ascii</span>
<span class="kn">from</span> <span class="nn">landlab.io</span> <span class="kn">import</span> <span class="n">write_esri_ascii</span>
<span class="kn">from</span> <span class="nn">landlab.plot</span> <span class="kn">import</span> <span class="n">imshow_grid</span>
<span class="kn">from</span> <span class="nn">landlab</span> <span class="kn">import</span> <span class="n">CORE_NODE</span><span class="p">,</span> <span class="n">CLOSED_BOUNDARY</span>

<span class="c1">#Import utilities for importing and exporting to HydroShare</span>
<span class="kn">from</span> <span class="nn">hstools</span> <span class="kn">import</span> <span class="n">hydroshare</span>

<span class="c1"># Import general tools</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">defaultdict</span>


<span class="n">st</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

<span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>
</div>
</div>
</div>
<div class="section" id="2.1.3-Connection-with-HydroShare">
<h4>2.1.3 Connection with HydroShare<a class="headerlink" href="#2.1.3-Connection-with-HydroShare" title="Permalink to this headline">¶</a></h4>
<p>After importing libraires, we now establish a secure connection with HydroShare by instantiating the hydroshare class that is defined within hs_utils. In addition to connecting with HydroShare, this command also sets and prints environment variables for several parameters that will be useful for saving work back to HydroShare.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">hs</span><span class="o">=</span><span class="n">hydroshare</span><span class="o">.</span><span class="n">hydroshare</span><span class="p">()</span>
<span class="n">homedir</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>
<span class="c1">#homedir = os.path.join(&#39;/home/jovyan/work/notebooks/data&#39;, str(homeresid),str(homeresid),&#39;data/contents/&#39;)</span>
<span class="c1">#print(&#39;This is a basic Unix folder structure.&#39;)</span>
<span class="c1">#print(&#39;Data will be loaded from and saved to:&#39;+homedir)</span>
</pre></div>
</div>
</div>
<p>If you are curious about where the data is being downloaded, click on the Jupyter Notebook dashboard icon in upper rigth corner to see a File System view. The homedir directory location printed above is where you can find the data and contents you will download to a HydroShare JupyterHub server. At the end of this work session, you can migrate this data to the HydroShare iRods server as a Generic Resource.</p>
</div>
</div>
<div class="section" id="2.2-Cyberinfrastructure-methods">
<h3>2.2 Cyberinfrastructure methods<a class="headerlink" href="#2.2-Cyberinfrastructure-methods" title="Permalink to this headline">¶</a></h3>
<p>Strauch et al (2018) pre-processed the data for the North Cascades National Park Complex case study and is on HydroShare as <a class="reference external" href="https://www.hydroshare.org/resource/a5b52c0e1493401a815f4e77b09d352b/">Regional landslide hazard using Landlab - NOCA Data</a>. Here the first task is find this resource on Hydrohsare. We will click on the link to see the published data repository on HydroShare and collect the resource ID of the data. The resource ID can be found in the “How to cite” box, and it will be
the series of numbers and letters following “hs.”. Here’s the copied resource: <a class="reference external" href="http://dx.doi.org/10.4211/hs.a5b52c0e1493401a815f4e77b09d352b">http://dx.doi.org/10.4211/hs.a5b52c0e1493401a815f4e77b09d352b</a> citation. Now we copy this ID and introduce it as “Data_ResourceID=” in the code below.</p>
<div class="section" id="2.2.1-Set-DEM-data-download-variable-name">
<h4>2.2.1 Set DEM data download variable name<a class="headerlink" href="#2.2.1-Set-DEM-data-download-variable-name" title="Permalink to this headline">¶</a></h4>
<p>To learn more about this data visit <a class="reference external" href="https://www.hydroshare.org/resource/a5b52c0e1493401a815f4e77b09d352b/">Regional landslide hazard using Landlab - NOCA Data</a></p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">Data_ResourceID</span><span class="o">=</span><span class="s1">&#39;a5b52c0e1493401a815f4e77b09d352b&#39;</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="2.2.2-Download-Data">
<h4>2.2.2 Download Data<a class="headerlink" href="#2.2.2-Download-Data" title="Permalink to this headline">¶</a></h4>
<p>We will execute the next cell to download data from HydroShare iRods database to your personal user space - this may take a few minutes.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">hs</span><span class="o">.</span><span class="n">getResourceFromHydroShare</span><span class="p">(</span><span class="n">Data_ResourceID</span><span class="p">)</span>
<span class="n">data_folder</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">(),</span> <span class="n">hs</span><span class="o">.</span><span class="n">getContentPath</span><span class="p">(</span><span class="n">Data_ResourceID</span><span class="p">),</span> <span class="s1">&#39;Data files&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;This HydroShare resource has been downloaded to: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">data_folder</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="line-block">
<div class="line">### 2.3. Review data needed as input for the landslide model This section loads metadata associated with the Landlab component.</div>
<div class="line">To view the code source for this component, visit <a class="reference external" href="https://github.com/landlab/">Landlab on Github</a> or <a class="reference external" href="https://github.com/landlab/landlab/blob/master/landlab/components/landslides/landslide_probability.py">Download the landslide_probability.py python file</a></div>
</div>
<p>Check the list of data inputs that the component needs.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">sorted</span><span class="p">(</span><span class="n">LandslideProbability</span><span class="o">.</span><span class="n">input_var_names</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Review the details of what each variable represents.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">LandslideProbability</span><span class="o">.</span><span class="n">_var_doc</span>
</pre></div>
</div>
</div>
<p>Check the units of each variable.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">LandslideProbability</span><span class="o">.</span><span class="n">_var_units</span>
</pre></div>
</div>
</div>
<p>Now we will establish a RasterModelGrid based on a DEM for assigning our variables to. Nodes are the center point of grid cells or pixels that are 30 m by 30 m in this example.</p>
</div>
</div>
<div class="section" id="2.4.-Create-a-watershed-subset-using-a-regional-RasterModelGrid">
<h3>2.4. Create a watershed subset using a regional RasterModelGrid<a class="headerlink" href="#2.4.-Create-a-watershed-subset-using-a-regional-RasterModelGrid" title="Permalink to this headline">¶</a></h3>
<p>The shapefile that you will download is a GIS point file with a table containing a grid_code for each 30m DEM cell in the Thunder Creek watershed. We import this table to generate a list of locations we want to keep “Open” as active nodes in this Landlab application for Thunder Creek.</p>
<p>Here we will establish the watershed domain for our modeling study. In step 2.2.2, we have downloaded the DEM of the entire NOCA study region of Strauch et al. (2018) as well as other input data. This includes NoData resource that was created using a mask of Thunder Creek will be downladed and used to set no data nodes as inactive nodes (e.g., -9999). This step will establish boundary conditions. In your final run when you output modeled probability of landslide initiation, you will notice gaps
in the model results at some ridge tops and peaks. This results from excluding glaciated areas and bedrock. This might take a few minutes as the park is large (2,757 km2).</p>
<p>This shapefile resource was uploaded to HydroShare to generate an interoperable Notebook. To learn more about this data visit <a class="reference external" href="https://www.hydroshare.org/resource/8bf8de77227c4dcba4816dbe15e55687/">Thunder Creek Landlab Node ID Point Shapefile</a></p>
<div class="section" id="2.4.1-Get-shapefile-of-ThunderCreek-watershed">
<h4>2.4.1 Get shapefile of ThunderCreek watershed<a class="headerlink" href="#2.4.1-Get-shapefile-of-ThunderCreek-watershed" title="Permalink to this headline">¶</a></h4>
<p>The shapefile table contains Landlab Gridcode value and Albers Conical X and Y values, spatial projection is WGS84.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">Data_ResourceID</span><span class="o">=</span><span class="s1">&#39;8bf8de77227c4dcba4816dbe15e55687&#39;</span>
<span class="n">hs</span><span class="o">.</span><span class="n">getResourceFromHydroShare</span><span class="p">(</span><span class="n">Data_ResourceID</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">Node_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">hs</span><span class="o">.</span><span class="n">getContentPath</span><span class="p">(</span><span class="n">Data_ResourceID</span><span class="p">),</span> <span class="s1">&#39;Thunder_node_id_WGS.shp&#39;</span><span class="p">)</span>
<span class="n">NodeID_shpfile</span><span class="o">=</span><span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="n">Node_path</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Print a sample portion (bottom) of the table * Col 1 = FID or POINTID * Col 2 = landlab grid code for NOCA region * Col 3 Point_X - the Alber Conical Latitude (original dataset) * Col 4 Point_Y - the Alber Conical Longitude (original dataset) * Geometry of lat/lon in WGS coordinate system of this GIS point file for launching in HydroShareGIS App</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">NodeID_shpfile</span><span class="o">.</span><span class="n">tail</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p>Make an array using Grid_Code column to develop a node based mask. No output from this command.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">filtercriteria</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">NodeID_shpfile</span><span class="o">.</span><span class="n">GRID_CODE</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Load-spatial-landslide-model-inputs-from-ASCII-textfile-(ArcGIS-raster-conversion)-into-Landlab-grid">
<h4>Load spatial landslide model inputs from ASCII textfile (ArcGIS raster conversion) into Landlab grid<a class="headerlink" href="#Load-spatial-landslide-model-inputs-from-ASCII-textfile-(ArcGIS-raster-conversion)-into-Landlab-grid" title="Permalink to this headline">¶</a></h4>
<p>Create Landlab RasterModelGrid using DEM grid with elevation - this takes approximately 60 sec for the North Cascades National Park (NOCA).</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span> <span class="o">=</span> <span class="n">read_esri_ascii</span><span class="p">(</span><span class="n">data_folder</span><span class="o">+</span><span class="s1">&#39;/elevation.txt&#39;</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;topographic__elevation&#39;</span><span class="p">)</span>
<span class="n">grid</span><span class="o">.</span><span class="n">at_node</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p>The original NOCA dem dataset has nodes closed outside of NOCA. All nodes insides of NOCA are open. To close all all nodes except those inside Thunder Creek: * Close all nodes in the landlab RasterModelGrid. * Open the Landlab RasterModelGrid only within the Thunder Creek watershed. * Assign Core Nodes (these are the only nodes where computation will be executed).</p>
<p>Plot the elevation grid of NOCA</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">imshow_grid</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="s1">&#39;topographic__elevation&#39;</span><span class="p">,</span> <span class="n">limits</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3000</span><span class="p">))</span>
</pre></div>
</div>
</div>
<p>Plot where the watershed is witin NOCA and zoom in.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">grid</span><span class="o">.</span><span class="n">status_at_node</span><span class="p">[</span><span class="n">grid</span><span class="o">.</span><span class="n">nodes</span><span class="o">.</span><span class="n">flatten</span><span class="p">()]</span> <span class="o">=</span> <span class="n">CLOSED_BOUNDARY</span>
<span class="n">grid</span><span class="o">.</span><span class="n">status_at_node</span><span class="p">[</span><span class="n">filtercriteria</span><span class="p">]</span> <span class="o">=</span> <span class="n">CORE_NODE</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># In case the DEM has no data values inside the subset area, set boundary conditions closed.</span>
<span class="n">grid</span><span class="o">.</span><span class="n">set_nodata_nodes_to_closed</span><span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">at_node</span><span class="p">[</span><span class="s1">&#39;topographic__elevation&#39;</span><span class="p">],</span> <span class="o">-</span><span class="mi">9999</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="s1">&#39;Limit NOCA computational nodes to Thunder Creek extent&#39;</span><span class="p">)</span>
<span class="n">xticks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">)</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">221</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">imshow_grid</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="s1">&#39;topographic__elevation&#39;</span><span class="p">,</span> <span class="n">limits</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3000</span><span class="p">),</span><span class="n">plot_name</span><span class="o">=</span><span class="s1">&#39;NOCA extent&#39;</span><span class="p">,</span>
                    <span class="n">allow_colorbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">color_for_closed</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
<span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">222</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">imshow_grid</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="s1">&#39;topographic__elevation&#39;</span><span class="p">,</span> <span class="n">limits</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3000</span><span class="p">),</span><span class="n">plot_name</span><span class="o">=</span><span class="s1">&#39;Thunder Creek extent&#39;</span><span class="p">,</span><span class="n">color_for_closed</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">25000</span><span class="p">,</span> <span class="mi">55000</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">30000</span><span class="p">,</span> <span class="mi">55000</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Confirm the size of the grid, nodes located every 30 m.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">grid</span><span class="o">.</span><span class="n">number_of_nodes</span>
</pre></div>
</div>
</div>
<p>Confirm the size of the core nodes where we’ll run our model, a subset of the nodes for the watershed.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">grid</span><span class="o">.</span><span class="n">number_of_core_nodes</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="2.5.-Attach-data-(e.g.,-soil-and-vegetation-variables)-to-the-Landlab-rastermodelgrid">
<h3>2.5. Attach data (e.g., soil and vegetation variables) to the Landlab rastermodelgrid<a class="headerlink" href="#2.5.-Attach-data-(e.g.,-soil-and-vegetation-variables)-to-the-Landlab-rastermodelgrid" title="Permalink to this headline">¶</a></h3>
<p>This will be used to calculate shallow landslide probability and set boundary conditions. THe data we attach in this step was downloaded in Step 2.2.2.</p>
<p><strong>For each input below</strong> 1. Load data from ascii text file 2. Add this data as node variable to the Thunder Creek grid 3. Set boundary conditions</p>
<p>For the entire NOCA extent, this takes ~60 sec to load each file using the CUAHSI JupyterHub server.</p>
<div class="section" id="2.5.1-Load-slope">
<h4>2.5.1 Load slope<a class="headerlink" href="#2.5.1-Load-slope" title="Permalink to this headline">¶</a></h4>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="p">(</span><span class="n">grid1</span><span class="p">,</span> <span class="n">slope</span><span class="p">)</span> <span class="o">=</span> <span class="n">read_esri_ascii</span><span class="p">(</span><span class="n">data_folder</span><span class="o">+</span><span class="s1">&#39;/slope_tang17d.txt&#39;</span><span class="p">)</span>
<span class="n">grid</span><span class="o">.</span><span class="n">add_field</span><span class="p">(</span><span class="s1">&#39;node&#39;</span><span class="p">,</span> <span class="s1">&#39;topographic__slope&#39;</span><span class="p">,</span> <span class="n">slope</span><span class="p">)</span>
<span class="n">grid</span><span class="o">.</span><span class="n">set_nodata_nodes_to_closed</span><span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">at_node</span><span class="p">[</span><span class="s1">&#39;topographic__slope&#39;</span><span class="p">],</span> <span class="o">-</span><span class="mi">9999</span><span class="p">)</span>
<span class="n">grid</span><span class="o">.</span><span class="n">set_nodata_nodes_to_closed</span><span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">at_node</span><span class="p">[</span><span class="s1">&#39;topographic__slope&#39;</span><span class="p">],</span> <span class="mf">0.0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">at_node</span><span class="p">[</span><span class="s1">&#39;topographic__slope&#39;</span><span class="p">][</span><span class="n">grid</span><span class="o">.</span><span class="n">core_nodes</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">at_node</span><span class="p">[</span><span class="s1">&#39;topographic__slope&#39;</span><span class="p">][</span><span class="n">grid</span><span class="o">.</span><span class="n">core_nodes</span><span class="p">]))</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="2.5.2-Load-contributing-area">
<h4>2.5.2 Load contributing area<a class="headerlink" href="#2.5.2-Load-contributing-area" title="Permalink to this headline">¶</a></h4>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="p">(</span><span class="n">grid1</span><span class="p">,</span> <span class="n">ca</span><span class="p">)</span> <span class="o">=</span> <span class="n">read_esri_ascii</span><span class="p">(</span><span class="n">data_folder</span><span class="o">+</span><span class="s1">&#39;/cont_area.txt&#39;</span><span class="p">)</span>
<span class="n">grid</span><span class="o">.</span><span class="n">add_field</span><span class="p">(</span><span class="s1">&#39;node&#39;</span><span class="p">,</span> <span class="s1">&#39;topographic__specific_contributing_area&#39;</span><span class="p">,</span> <span class="n">ca</span><span class="p">)</span>
<span class="n">grid</span><span class="o">.</span><span class="n">set_nodata_nodes_to_closed</span><span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">at_node</span><span class="p">[</span><span class="s1">&#39;topographic__specific_contributing_area&#39;</span><span class="p">],</span> <span class="o">-</span><span class="mi">9999</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="2.5.3-Load-transmissivity">
<h4>2.5.3 Load transmissivity<a class="headerlink" href="#2.5.3-Load-transmissivity" title="Permalink to this headline">¶</a></h4>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="p">(</span><span class="n">grid1</span><span class="p">,</span> <span class="n">T</span><span class="p">)</span> <span class="o">=</span> <span class="n">read_esri_ascii</span><span class="p">(</span><span class="n">data_folder</span><span class="o">+</span><span class="s1">&#39;/transmis.txt&#39;</span><span class="p">)</span>
<span class="n">grid</span><span class="o">.</span><span class="n">add_field</span><span class="p">(</span><span class="s1">&#39;node&#39;</span><span class="p">,</span> <span class="s1">&#39;soil__transmissivity&#39;</span><span class="p">,</span> <span class="n">T</span><span class="p">)</span>
<span class="n">grid</span><span class="o">.</span><span class="n">set_nodata_nodes_to_closed</span><span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">at_node</span><span class="p">[</span><span class="s1">&#39;soil__transmissivity&#39;</span><span class="p">],</span> <span class="o">-</span><span class="mi">9999</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="2.5.4-Load-cohesion-(mode,-min,-and-max)">
<h4>2.5.4 Load cohesion (mode, min, and max)<a class="headerlink" href="#2.5.4-Load-cohesion-(mode,-min,-and-max)" title="Permalink to this headline">¶</a></h4>
<p>This takes ~3 minutes because 3 cohesion fields are provided to create more flexibility in how cohesion is distributed on the landscape with different vegetation.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="p">(</span><span class="n">grid1</span><span class="p">,</span> <span class="n">C</span><span class="p">)</span> <span class="o">=</span> <span class="n">read_esri_ascii</span><span class="p">(</span><span class="n">data_folder</span><span class="o">+</span><span class="s1">&#39;/cohesion_mode.txt&#39;</span><span class="p">)</span>
<span class="n">C</span><span class="p">[</span><span class="n">C</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span>  <span class="c1"># ensure minimum is &gt;0 Pa for use in distributions generation</span>
<span class="n">grid</span><span class="o">.</span><span class="n">add_field</span><span class="p">(</span><span class="s1">&#39;node&#39;</span><span class="p">,</span> <span class="s1">&#39;soil__mode_total_cohesion&#39;</span><span class="p">,</span> <span class="n">C</span><span class="p">)</span>
<span class="n">grid</span><span class="o">.</span><span class="n">set_nodata_nodes_to_closed</span><span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">at_node</span><span class="p">[</span><span class="s1">&#39;soil__mode_total_cohesion&#39;</span><span class="p">],</span> <span class="o">-</span><span class="mi">9999</span><span class="p">)</span>

<span class="p">(</span><span class="n">grid1</span><span class="p">,</span> <span class="n">C_min</span><span class="p">)</span> <span class="o">=</span> <span class="n">read_esri_ascii</span><span class="p">(</span><span class="n">data_folder</span><span class="o">+</span><span class="s1">&#39;/cohesion_min.txt&#39;</span><span class="p">)</span>
<span class="n">grid</span><span class="o">.</span><span class="n">add_field</span><span class="p">(</span><span class="s1">&#39;node&#39;</span><span class="p">,</span> <span class="s1">&#39;soil__minimum_total_cohesion&#39;</span><span class="p">,</span> <span class="n">C_min</span><span class="p">)</span>
<span class="n">grid</span><span class="o">.</span><span class="n">set_nodata_nodes_to_closed</span><span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">at_node</span><span class="p">[</span><span class="s1">&#39;soil__minimum_total_cohesion&#39;</span><span class="p">],</span> <span class="o">-</span><span class="mi">9999</span><span class="p">)</span>

<span class="p">(</span><span class="n">grid1</span><span class="p">,</span> <span class="n">C_max</span><span class="p">)</span> <span class="o">=</span> <span class="n">read_esri_ascii</span><span class="p">(</span><span class="n">data_folder</span><span class="o">+</span><span class="s1">&#39;/cohesion_max.txt&#39;</span><span class="p">)</span>
<span class="n">grid</span><span class="o">.</span><span class="n">add_field</span><span class="p">(</span><span class="s1">&#39;node&#39;</span><span class="p">,</span> <span class="s1">&#39;soil__maximum_total_cohesion&#39;</span><span class="p">,</span> <span class="n">C_max</span><span class="p">)</span>
<span class="n">grid</span><span class="o">.</span><span class="n">set_nodata_nodes_to_closed</span><span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">at_node</span><span class="p">[</span><span class="s1">&#39;soil__maximum_total_cohesion&#39;</span><span class="p">],</span> <span class="o">-</span><span class="mi">9999</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="2.5.5-Load-internal-angle-of-friction">
<h4>2.5.5 Load internal angle of friction<a class="headerlink" href="#2.5.5-Load-internal-angle-of-friction" title="Permalink to this headline">¶</a></h4>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="p">(</span><span class="n">grid1</span><span class="p">,</span> <span class="n">phi</span><span class="p">)</span> <span class="o">=</span> <span class="n">read_esri_ascii</span><span class="p">(</span><span class="n">data_folder</span><span class="o">+</span><span class="s1">&#39;/frict_angle.txt&#39;</span><span class="p">)</span>
<span class="n">grid</span><span class="o">.</span><span class="n">add_field</span><span class="p">(</span><span class="s1">&#39;node&#39;</span><span class="p">,</span> <span class="s1">&#39;soil__internal_friction_angle&#39;</span><span class="p">,</span> <span class="n">phi</span><span class="p">)</span>
<span class="n">grid</span><span class="o">.</span><span class="n">set_nodata_nodes_to_closed</span><span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">at_node</span><span class="p">[</span><span class="s1">&#39;soil__internal_friction_angle&#39;</span><span class="p">],</span> <span class="o">-</span><span class="mi">9999</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="2.5.6-Set-soil-density-values">
<h4>2.5.6 Set soil density values<a class="headerlink" href="#2.5.6-Set-soil-density-values" title="Permalink to this headline">¶</a></h4>
<p>In this example, we assign all nodes a constant value.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">grid</span><span class="p">[</span><span class="s1">&#39;node&#39;</span><span class="p">][</span><span class="s1">&#39;soil__density&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2000</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">number_of_nodes</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="2.5.7-Load-soil-thickness">
<h4>2.5.7 Load soil thickness<a class="headerlink" href="#2.5.7-Load-soil-thickness" title="Permalink to this headline">¶</a></h4>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="p">(</span><span class="n">grid1</span><span class="p">,</span> <span class="n">hs</span><span class="p">)</span> <span class="o">=</span> <span class="n">read_esri_ascii</span><span class="p">(</span><span class="n">data_folder</span><span class="o">+</span><span class="s1">&#39;/soil_depth.txt&#39;</span><span class="p">)</span>
<span class="n">grid</span><span class="o">.</span><span class="n">add_field</span><span class="p">(</span><span class="s1">&#39;node&#39;</span><span class="p">,</span> <span class="s1">&#39;soil__thickness&#39;</span><span class="p">,</span> <span class="n">hs</span><span class="p">)</span>
<span class="n">grid</span><span class="o">.</span><span class="n">set_nodata_nodes_to_closed</span><span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">at_node</span><span class="p">[</span><span class="s1">&#39;soil__thickness&#39;</span><span class="p">],</span> <span class="o">-</span><span class="mi">9999</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="2.5.8-Load-observed-landslide-inventory.-Class-1-5-are-landslides,-8-is-no-landslide-mapped-for-later-plotting">
<h4>2.5.8 Load observed landslide inventory. Class 1-5 are landslides, 8 is no landslide mapped for later plotting<a class="headerlink" href="#2.5.8-Load-observed-landslide-inventory.-Class-1-5-are-landslides,-8-is-no-landslide-mapped-for-later-plotting" title="Permalink to this headline">¶</a></h4>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="p">(</span><span class="n">grid1</span><span class="p">,</span> <span class="n">slides</span><span class="p">)</span> <span class="o">=</span> <span class="n">read_esri_ascii</span><span class="p">(</span><span class="n">data_folder</span><span class="o">+</span><span class="s1">&#39;/landslide_type.txt&#39;</span><span class="p">)</span>
<span class="n">grid</span><span class="o">.</span><span class="n">add_field</span><span class="p">(</span><span class="s1">&#39;node&#39;</span><span class="p">,</span> <span class="s1">&#39;landslides&#39;</span><span class="p">,</span> <span class="n">slides</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="2.6.-Specify-recharge-option-as-data-driven-spatial-and-access-Python-dictionaries-to-generate-recharge-distributions">
<h3>2.6. Specify recharge option as <em>data driven spatial</em> and access Python dictionaries to generate recharge distributions<a class="headerlink" href="#2.6.-Specify-recharge-option-as-data-driven-spatial-and-access-Python-dictionaries-to-generate-recharge-distributions" title="Permalink to this headline">¶</a></h3>
<p>Recharge in this model represents the annual maximum recharge in mm/day generated within the upslope contributing area of each model element. This corresponds to the wettest conditions expected annually, which would provide the highest pore-water pressure in a year. Details of this approach can be found in Strauch et al. (2018).</p>
<div class="section" id="2.6.1-Select-recharge-method-from-the-component">
<h4>2.6.1 Select recharge method from the component<a class="headerlink" href="#2.6.1-Select-recharge-method-from-the-component" title="Permalink to this headline">¶</a></h4>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">distribution</span> <span class="o">=</span> <span class="s1">&#39;data_driven_spatial&#39;</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="2.6.2-Load-pre-processed-routed-flows-dictionaries">
<h4>2.6.2 Load pre-processed routed flows dictionaries<a class="headerlink" href="#2.6.2-Load-pre-processed-routed-flows-dictionaries" title="Permalink to this headline">¶</a></h4>
<p>These contain HSD_id and fractional drainage at each node and recharge dictionaries. HSD is the Hydrologic Source Domain, which is the VIC hydrologic model data in this case study at ~5x6 km2 grid size. The ‘pickle’ utility loads existing dictionaries.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># dict of node id (key) and HSD_ids (values)</span>
<span class="n">HSD_id_dict</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="n">data_folder</span><span class="o">+</span><span class="s1">&#39;/dict_uniq_ids.p&#39;</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">),</span><span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;latin1&#39;</span><span class="p">)</span>
<span class="c1"># dict of node id (key) and fractions (values)</span>
<span class="n">fract_dict</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="n">data_folder</span><span class="o">+</span><span class="s1">&#39;/dict_coeff.p&#39;</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">),</span><span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;latin1&#39;</span><span class="p">)</span>
<span class="c1"># dict of HSD id (key) with arrays of recharge (values)</span>
<span class="n">HSD_dict</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="n">data_folder</span><span class="o">+</span><span class="s1">&#39;/HSD_dict.p&#39;</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">),</span><span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;latin1&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="2.6.3-Combine-dictionaries-into-ordered-parameters">
<h4>2.6.3 Combine dictionaries into <strong>ordered</strong> parameters<a class="headerlink" href="#2.6.3-Combine-dictionaries-into-ordered-parameters" title="Permalink to this headline">¶</a></h4>
<p>This sequence of parameters is required for <em>data driven spatial</em> distribution in the component. Recharge is this model is unique to each node represented by an array.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">HSD_inputs</span> <span class="o">=</span> <span class="p">[</span><span class="n">HSD_dict</span><span class="p">,</span> <span class="n">HSD_id_dict</span><span class="p">,</span> <span class="n">fract_dict</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="2.7.-Set-Number-of-iterations-to-run-Monte-Carlo-simulation">
<h3>2.7. Set Number of iterations to run Monte Carlo simulation<a class="headerlink" href="#2.7.-Set-Number-of-iterations-to-run-Monte-Carlo-simulation" title="Permalink to this headline">¶</a></h3>
<p>The landslide component employes the infinite slope model to calculate factor-of-safety index values using a Monte Carlo simulation, which randomly selects input values from parameter distributions. You can specify the number of Monte Carlo samples, but the default is 250. The larger the Monte Carlos sample size, the longer the program runs, but the more precise the probability of failure results become. Strauch et al. (2018) sampled 3,000 times for each parameter in each model grid.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">iterations</span> <span class="o">=</span> <span class="mi">250</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="3.-Results">
<h2>3. Results<a class="headerlink" href="#3.-Results" title="Permalink to this headline">¶</a></h2>
<div class="section" id="3.1.-Run-the-Landlab-LandslideProbability-Component-in-Thunder-Creek-for-pre-fire-conditions">
<h3>3.1. Run the Landlab LandslideProbability Component in Thunder Creek for pre-fire conditions<a class="headerlink" href="#3.1.-Run-the-Landlab-LandslideProbability-Component-in-Thunder-Creek-for-pre-fire-conditions" title="Permalink to this headline">¶</a></h3>
<div class="section" id="3.1.1-Initialize-Pre-fire">
<h4>3.1.1 Initialize Pre-fire<a class="headerlink" href="#3.1.1-Initialize-Pre-fire" title="Permalink to this headline">¶</a></h4>
<p>To run the landslide model, we first instantiate the LandslideProbability component with the above parameters, as well as the grid and number of samples we specified before. Instantiation creates an instance of a class called LS_prob.</p>
<p>No outputs are generated by this command as it is setting up the recharge and instantiating the component.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">LS_prob</span> <span class="o">=</span> <span class="n">LandslideProbability</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span>
    <span class="n">number_of_iterations</span><span class="o">=</span><span class="n">iterations</span><span class="p">,</span>
    <span class="n">groudwater__recharge_distribution</span><span class="o">=</span><span class="n">distribution</span><span class="p">,</span>
    <span class="n">groudwater__recharge_HSD_inputs</span><span class="o">=</span><span class="n">HSD_inputs</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="3.1.2-Run-the-Pre-fire-model">
<h4>3.1.2 Run the Pre-fire model<a class="headerlink" href="#3.1.2-Run-the-Pre-fire-model" title="Permalink to this headline">¶</a></h4>
<p>Once the component has been instantiated, we generate outputs from running the component by calling the component’s ‘calculate_landslide_probability’ method using the class instance (e.g., LS_prob). The cell below runs the model; in the following section we will assessing the results. These calculations will take a few minutes given the size of the modeling domain represented by core nodes.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">LS_prob</span><span class="o">.</span><span class="n">calculate_landslide_probability</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Landslide probability successfully calculated&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>What is the maximum probabilty of failure we found?</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">at_node</span><span class="p">[</span><span class="s1">&#39;landslide__probability_of_failure&#39;</span><span class="p">][</span><span class="n">grid</span><span class="o">.</span><span class="n">core_nodes</span><span class="p">])</span>
</pre></div>
</div>
</div>
<p>The outputs of landslide model simulation are:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">sorted</span><span class="p">(</span><span class="n">LS_prob</span><span class="o">.</span><span class="n">output_var_names</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>This simulation generates a probability value for each core node.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">grid</span><span class="o">.</span><span class="n">at_node</span><span class="p">[</span><span class="s1">&#39;landslide__probability_of_failure&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<p>This simulation generates a probability of saturation value for each core node as well.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">grid</span><span class="o">.</span><span class="n">at_node</span><span class="p">[</span><span class="s1">&#39;soil__probability_of_saturation&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<p>-9999 means there is no data for that cell, it is a closed node.</p>
</div>
</div>
<div class="section" id="3.2.-Run-the-Landlab-LandslideProbability-Component-in-Thunder-Creek-for-fire-conditions">
<h3>3.2. Run the Landlab LandslideProbability Component in Thunder Creek for fire conditions<a class="headerlink" href="#3.2.-Run-the-Landlab-LandslideProbability-Component-in-Thunder-Creek-for-fire-conditions" title="Permalink to this headline">¶</a></h3>
<p>Make a ‘grid_fire’ version of ‘grid’ for which we will give post-fire cohesion parameter values 30% of the original cohesion. This is a crude estimation of the lowest root cohesion after tree removal based on a combined decay and regrowth model (e.g., Sidle, 1992).</p>
<p>Sidle, R. C. (1992), A theoretical model of the effects of timber harvesting on slope stability, Water Resour. Res., 28(7), 1897–1910.</p>
<div class="section" id="3.2.1-Make-a-Post-fire-copy-of-the-grid">
<h4>3.2.1 Make a Post-fire copy of the grid<a class="headerlink" href="#3.2.1-Make-a-Post-fire-copy-of-the-grid" title="Permalink to this headline">¶</a></h4>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">copy</span>
<span class="n">grid_fire</span><span class="o">=</span><span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">grid</span><span class="p">)</span>
<span class="n">grid_fire</span><span class="o">.</span><span class="n">at_node</span><span class="p">[</span><span class="s1">&#39;soil__mode_total_cohesion&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">grid</span><span class="o">.</span><span class="n">at_node</span><span class="p">[</span><span class="s1">&#39;soil__mode_total_cohesion&#39;</span><span class="p">]</span><span class="o">*</span><span class="mf">0.3</span>
<span class="n">grid_fire</span><span class="o">.</span><span class="n">at_node</span><span class="p">[</span><span class="s1">&#39;soil__minimum_total_cohesion&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">grid</span><span class="o">.</span><span class="n">at_node</span><span class="p">[</span><span class="s1">&#39;soil__minimum_total_cohesion&#39;</span><span class="p">]</span><span class="o">*</span><span class="mf">0.3</span>
<span class="n">grid_fire</span><span class="o">.</span><span class="n">at_node</span><span class="p">[</span><span class="s1">&#39;soil__maximum_total_cohesion&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">grid</span><span class="o">.</span><span class="n">at_node</span><span class="p">[</span><span class="s1">&#39;soil__maximum_total_cohesion&#39;</span><span class="p">]</span><span class="o">*</span><span class="mf">0.3</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="3.2.2-Change-the-Post-fire-cohesion-values">
<h4>3.2.2 Change the Post-fire cohesion values<a class="headerlink" href="#3.2.2-Change-the-Post-fire-cohesion-values" title="Permalink to this headline">¶</a></h4>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;this is the highest mode value for coehsion before fire across the domain&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">at_node</span><span class="p">[</span><span class="s1">&#39;soil__mode_total_cohesion&#39;</span><span class="p">][</span><span class="n">grid</span><span class="o">.</span><span class="n">core_nodes</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;this is the lowest mode value for coehsion before fire across the domain&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">at_node</span><span class="p">[</span><span class="s1">&#39;soil__mode_total_cohesion&#39;</span><span class="p">][</span><span class="n">grid</span><span class="o">.</span><span class="n">core_nodes</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;this is the highest mode value for coehsion after fire across the domain&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">grid_fire</span><span class="o">.</span><span class="n">at_node</span><span class="p">[</span><span class="s1">&#39;soil__mode_total_cohesion&#39;</span><span class="p">][</span><span class="n">grid</span><span class="o">.</span><span class="n">core_nodes</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;this is the lowest mode value for coehsion after fire across the domain&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">grid_fire</span><span class="o">.</span><span class="n">at_node</span><span class="p">[</span><span class="s1">&#39;soil__mode_total_cohesion&#39;</span><span class="p">][</span><span class="n">grid</span><span class="o">.</span><span class="n">core_nodes</span><span class="p">]))</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="3.2.3-Initialize-the-Post-fire-model">
<h4>3.2.3 Initialize the Post-fire model<a class="headerlink" href="#3.2.3-Initialize-the-Post-fire-model" title="Permalink to this headline">¶</a></h4>
<p>Now we’ll run the landslide component with the adjusted cohesion, everything else kept constant.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">LS_probFire</span> <span class="o">=</span> <span class="n">LandslideProbability</span><span class="p">(</span><span class="n">grid_fire</span><span class="p">,</span><span class="n">number_of_iterations</span><span class="o">=</span><span class="n">iterations</span><span class="p">,</span>
    <span class="n">groudwater__recharge_distribution</span><span class="o">=</span><span class="n">distribution</span><span class="p">,</span>
    <span class="n">groudwater__recharge_HSD_inputs</span><span class="o">=</span><span class="n">HSD_inputs</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Post-fire cohesion successfully instantiated&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="3.2.4-Run-the-Post-fire-model">
<h4>3.2.4 Run the Post-fire model<a class="headerlink" href="#3.2.4-Run-the-Post-fire-model" title="Permalink to this headline">¶</a></h4>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">LS_probFire</span><span class="o">.</span><span class="n">calculate_landslide_probability</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Landslide probability successfully calculated&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">grid_fire</span><span class="o">.</span><span class="n">at_node</span><span class="p">[</span><span class="s1">&#39;landslide__probability_of_failure&#39;</span><span class="p">][</span><span class="n">grid</span><span class="o">.</span><span class="n">core_nodes</span><span class="p">])</span>
</pre></div>
</div>
</div>
<p>The outputs of landslide model simulation are:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">sorted</span><span class="p">(</span><span class="n">LS_probFire</span><span class="o">.</span><span class="n">output_var_names</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>This simulation generates a probability value for each core node.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">grid_fire</span><span class="o">.</span><span class="n">at_node</span><span class="p">[</span><span class="s1">&#39;landslide__probability_of_failure&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="3.3.-Display-and-visualize-results-of-stability-analysis">
<h3>3.3. Display and visualize results of stability analysis<a class="headerlink" href="#3.3.-Display-and-visualize-results-of-stability-analysis" title="Permalink to this headline">¶</a></h3>
<p>Set plotting parameters</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;xtick.labelsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">15</span>
<span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;ytick.labelsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">15</span>
<span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;lines.linewidth&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;axes.labelsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">18</span>
<span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;legend.fontsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">15</span>
</pre></div>
</div>
</div>
<p>Plot elevation</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="s1">&#39;Elevations from the DEM [m]&#39;</span><span class="p">)</span>
<span class="n">imshow_grid_at_node</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="s1">&#39;topographic__elevation&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;terrain&#39;</span><span class="p">,</span>
                 <span class="n">grid_units</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;coordinates&#39;</span><span class="p">,</span> <span class="s1">&#39;coordinates&#39;</span><span class="p">),</span>
                 <span class="n">shrink</span><span class="o">=</span><span class="mf">0.75</span><span class="p">,</span> <span class="n">var_name</span><span class="o">=</span><span class="s1">&#39;Elevation&#39;</span><span class="p">,</span> <span class="n">var_units</span><span class="o">=</span><span class="s1">&#39;m&#39;</span><span class="p">,</span><span class="n">color_for_closed</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">25000</span><span class="p">,</span> <span class="mi">55000</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">30000</span><span class="p">,</span> <span class="mi">55000</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;NOCA_elevation.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Excluded areas from the analysis are shown in white, including outside the park and inside the park areas that are water bodies, snow, glaciers, wetlands, exposed bedrock, and slopes &lt;= 17 degrees.</p>
<p>Plot slope overlaid with mapped landslide types. Takes about a few minutes.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="s1">&#39;Landslides&#39;</span><span class="p">)</span>
<span class="n">ls_mask1</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">at_node</span><span class="p">[</span><span class="s1">&#39;landslides&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="mf">1.0</span>
<span class="n">ls_mask2</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">at_node</span><span class="p">[</span><span class="s1">&#39;landslides&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="mf">2.0</span>
<span class="n">ls_mask3</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">at_node</span><span class="p">[</span><span class="s1">&#39;landslides&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="mf">3.0</span>
<span class="n">ls_mask4</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">at_node</span><span class="p">[</span><span class="s1">&#39;landslides&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="mf">4.0</span>
<span class="n">overlay_landslide1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">at_node</span><span class="p">[</span><span class="s1">&#39;landslides&#39;</span><span class="p">],</span> <span class="n">mask</span><span class="o">=</span><span class="n">ls_mask1</span><span class="p">)</span>
<span class="n">overlay_landslide2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">at_node</span><span class="p">[</span><span class="s1">&#39;landslides&#39;</span><span class="p">],</span> <span class="n">mask</span><span class="o">=</span><span class="n">ls_mask2</span><span class="p">)</span>
<span class="n">overlay_landslide3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">at_node</span><span class="p">[</span><span class="s1">&#39;landslides&#39;</span><span class="p">],</span> <span class="n">mask</span><span class="o">=</span><span class="n">ls_mask3</span><span class="p">)</span>
<span class="n">overlay_landslide4</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">at_node</span><span class="p">[</span><span class="s1">&#39;landslides&#39;</span><span class="p">],</span> <span class="n">mask</span><span class="o">=</span><span class="n">ls_mask4</span><span class="p">)</span>
<span class="n">imshow_grid_at_node</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="s1">&#39;topographic__slope&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;pink&#39;</span><span class="p">,</span>
                 <span class="n">grid_units</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;coordinates&#39;</span><span class="p">,</span> <span class="s1">&#39;coordinates&#39;</span><span class="p">),</span> <span class="n">vmax</span><span class="o">=</span><span class="mf">2.</span><span class="p">,</span>
                 <span class="n">shrink</span><span class="o">=</span><span class="mf">0.75</span><span class="p">,</span> <span class="n">var_name</span><span class="o">=</span><span class="s1">&#39;Slope&#39;</span><span class="p">,</span> <span class="n">var_units</span><span class="o">=</span><span class="s1">&#39;m/m&#39;</span><span class="p">,</span><span class="n">color_for_closed</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,)</span>
<span class="n">imshow_grid_at_node</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="n">overlay_landslide1</span><span class="p">,</span> <span class="n">color_for_closed</span><span class="o">=</span><span class="s1">&#39;None&#39;</span><span class="p">,</span>
                 <span class="n">allow_colorbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;cool&#39;</span><span class="p">)</span>
<span class="n">imshow_grid_at_node</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="n">overlay_landslide2</span><span class="p">,</span> <span class="n">color_for_closed</span><span class="o">=</span><span class="s1">&#39;None&#39;</span><span class="p">,</span>
                 <span class="n">allow_colorbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;autumn&#39;</span><span class="p">)</span>
<span class="n">imshow_grid_at_node</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="n">overlay_landslide3</span><span class="p">,</span> <span class="n">color_for_closed</span><span class="o">=</span><span class="s1">&#39;None&#39;</span><span class="p">,</span>
                 <span class="n">allow_colorbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;winter&#39;</span><span class="p">)</span>
<span class="n">imshow_grid_at_node</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="n">overlay_landslide4</span><span class="p">,</span> <span class="n">color_for_closed</span><span class="o">=</span><span class="s1">&#39;None&#39;</span><span class="p">,</span>
                 <span class="n">allow_colorbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;summer&#39;</span><span class="p">)</span>
<span class="c1">#plt.savefig(&#39;NOCA_Landslides_on_Slope.png&#39;)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">25000</span><span class="p">,</span> <span class="mi">55000</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">30000</span><span class="p">,</span> <span class="mi">55000</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Legend to mapped landslides: blue - debris avalanches, cyan - falls/topples, red - debris torrents, and green - slumps/creeps</p>
<p>Plot of soil depth (m)</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="s1">&#39;Soil Thickness&#39;</span><span class="p">)</span>
<span class="n">imshow_grid_at_node</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="s1">&#39;soil__thickness&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;copper_r&#39;</span><span class="p">,</span>
                 <span class="n">grid_units</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;coordinates&#39;</span><span class="p">,</span> <span class="s1">&#39;coordinates&#39;</span><span class="p">),</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">0.75</span><span class="p">,</span>
                 <span class="n">var_name</span><span class="o">=</span><span class="s1">&#39;Soil Thickness&#39;</span><span class="p">,</span> <span class="n">var_units</span><span class="o">=</span><span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="n">color_for_closed</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">25000</span><span class="p">,</span> <span class="mi">55000</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">30000</span><span class="p">,</span> <span class="mi">55000</span><span class="p">)</span>
<span class="c1">#plt.savefig(&#39;NOCA_SoilDepth.png&#39;)</span>
</pre></div>
</div>
</div>
<p>Plot probability of saturation</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="s1">&#39;Probability of Saturation&#39;</span><span class="p">)</span>
<span class="n">xticks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">)</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">221</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">imshow_grid</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="s1">&#39;soil__probability_of_saturation&#39;</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;YlGnBu&#39;</span><span class="p">,</span>
                 <span class="n">limits</span><span class="o">=</span><span class="p">((</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">)),</span><span class="n">plot_name</span><span class="o">=</span><span class="s1">&#39;Pre-Fire&#39;</span><span class="p">,</span>
                 <span class="n">allow_colorbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">grid_units</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;coordinates&#39;</span><span class="p">,</span> <span class="s1">&#39;coordinates&#39;</span><span class="p">),</span> <span class="n">color_for_closed</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">25000</span><span class="p">,</span> <span class="mi">55000</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">30000</span><span class="p">,</span> <span class="mi">55000</span><span class="p">)</span>
<span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">222</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">imshow_grid</span><span class="p">(</span><span class="n">grid_fire</span><span class="p">,</span> <span class="s1">&#39;soil__probability_of_saturation&#39;</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;YlGnBu&#39;</span><span class="p">,</span>
                 <span class="n">limits</span><span class="o">=</span><span class="p">((</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">)),</span><span class="n">plot_name</span><span class="o">=</span><span class="s1">&#39;Post-Fire&#39;</span><span class="p">,</span><span class="n">grid_units</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;coordinates&#39;</span><span class="p">,</span> <span class="s1">&#39;coordinates&#39;</span><span class="p">),</span> <span class="n">color_for_closed</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">25000</span><span class="p">,</span> <span class="mi">55000</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">30000</span><span class="p">,</span> <span class="mi">55000</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>This map shows the probability of saturation as high throughout much of the area because we modeled the annual maximum recharge, which is esssentially the worst case conditions that might lead to instability.</p>
<p>Plot probability of failure; Compare this with the elevation and slope maps.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="s1">&#39;Probability of Failure&#39;</span><span class="p">)</span>
<span class="n">xticks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">)</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">221</span><span class="p">)</span>
<span class="c1">#ax1.xaxis.set_visible(False)</span>
<span class="n">imshow_grid</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="s1">&#39;landslide__probability_of_failure&#39;</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;OrRd&#39;</span><span class="p">,</span>
                 <span class="n">limits</span><span class="o">=</span><span class="p">((</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">)),</span><span class="n">plot_name</span><span class="o">=</span><span class="s1">&#39;Pre-fire&#39;</span><span class="p">,</span>
                 <span class="n">allow_colorbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">grid_units</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;coordinates&#39;</span><span class="p">,</span> <span class="s1">&#39;coordinates&#39;</span><span class="p">),</span> <span class="n">color_for_closed</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">25000</span><span class="p">,</span> <span class="mi">55000</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">30000</span><span class="p">,</span> <span class="mi">55000</span><span class="p">)</span>
<span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">222</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">imshow_grid</span><span class="p">(</span><span class="n">grid_fire</span><span class="p">,</span> <span class="s1">&#39;landslide__probability_of_failure&#39;</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;OrRd&#39;</span><span class="p">,</span>
                 <span class="n">limits</span><span class="o">=</span><span class="p">((</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">)),</span><span class="n">plot_name</span><span class="o">=</span><span class="s1">&#39;Post-fire&#39;</span><span class="p">,</span><span class="n">grid_units</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;coordinates&#39;</span><span class="p">,</span> <span class="s1">&#39;coordinates&#39;</span><span class="p">),</span> <span class="n">color_for_closed</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">25000</span><span class="p">,</span> <span class="mi">55000</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">30000</span><span class="p">,</span> <span class="mi">55000</span><span class="p">)</span>

<span class="c1">#plt.savefig(&#39;Probability_of_Failure_Original_Fire.png&#39;)</span>
</pre></div>
</div>
</div>
<p>The map of probability of failure shows higher probabilities in a post-fire scenario with reduced cohesion.</p>
<p>We can compare the range of probabilities before and after the simulated fire using a cumulative distribution plot.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">X1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">at_node</span><span class="p">[</span><span class="s1">&#39;landslide__probability_of_failure&#39;</span><span class="p">][</span><span class="n">grid</span><span class="o">.</span><span class="n">core_nodes</span><span class="p">]))</span>
<span class="n">Y1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">X1</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">X1</span><span class="p">)</span>
<span class="n">X2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">grid_fire</span><span class="o">.</span><span class="n">at_node</span><span class="p">[</span><span class="s1">&#39;landslide__probability_of_failure&#39;</span><span class="p">][</span><span class="n">grid</span><span class="o">.</span><span class="n">core_nodes</span><span class="p">]))</span>
<span class="n">Y2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">X2</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">X2</span><span class="p">)</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="s1">&#39;Empirical CDF of Probability of Failure&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X1</span><span class="p">,</span><span class="n">Y1</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Pre-fire&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X2</span><span class="p">,</span><span class="n">Y2</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Post-fire&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Probability of Failure&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Fraction of Area&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p>We can interpret this figure as a higher fraction of the landscape has a higher probability of failure (red) after fire than before fire (black).</p>
<p>To review the fields assigned to the grid, simply execute the following command.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">grid</span><span class="o">.</span><span class="n">at_node</span>
</pre></div>
</div>
</div>
<p>Export data from model run: FS probability, mean Reletive wetness, probability of saturation</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="n">core_nodes</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">core_nodes</span>
<span class="n">data_extracted</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Prob_fail_std&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                 <span class="n">grid</span><span class="o">.</span><span class="n">at_node</span><span class="p">[</span><span class="s1">&#39;landslide__probability_of_failure&#39;</span><span class="p">][</span><span class="n">grid</span><span class="o">.</span><span class="n">core_nodes</span><span class="p">]),</span>
                 <span class="s1">&#39;mean_RW_std&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">at_node</span><span class="p">[</span><span class="s1">&#39;soil__mean_relative_wetness&#39;</span><span class="p">]</span>
                 <span class="p">[</span><span class="n">grid</span><span class="o">.</span><span class="n">core_nodes</span><span class="p">]),</span><span class="s1">&#39;prob_sat_std&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                 <span class="n">grid</span><span class="o">.</span><span class="n">at_node</span><span class="p">[</span><span class="s1">&#39;soil__probability_of_saturation&#39;</span><span class="p">][</span><span class="n">grid</span><span class="o">.</span><span class="n">core_nodes</span><span class="p">]),</span>
                 <span class="s1">&#39;Prob_fail_fire&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                 <span class="n">grid_fire</span><span class="o">.</span><span class="n">at_node</span><span class="p">[</span><span class="s1">&#39;landslide__probability_of_failure&#39;</span><span class="p">][</span><span class="n">grid_fire</span><span class="o">.</span><span class="n">core_nodes</span><span class="p">]),</span>
                 <span class="s1">&#39;mean_RW_fire&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">grid_fire</span><span class="o">.</span><span class="n">at_node</span><span class="p">[</span><span class="s1">&#39;soil__mean_relative_wetness&#39;</span><span class="p">]</span>
                 <span class="p">[</span><span class="n">grid_fire</span><span class="o">.</span><span class="n">core_nodes</span><span class="p">]),</span><span class="s1">&#39;prob_sat_fire&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                 <span class="n">grid_fire</span><span class="o">.</span><span class="n">at_node</span><span class="p">[</span><span class="s1">&#39;soil__probability_of_saturation&#39;</span><span class="p">][</span><span class="n">grid_fire</span><span class="o">.</span><span class="n">core_nodes</span><span class="p">])}</span>
<span class="n">headers</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Prob_fail_std&#39;</span><span class="p">,</span><span class="s1">&#39;mean_RW_std&#39;</span><span class="p">,</span><span class="s1">&#39;prob_sat_std&#39;</span><span class="p">,</span><span class="s1">&#39;Prob_fail_fire&#39;</span><span class="p">,</span><span class="s1">&#39;mean_RW_fire&#39;</span><span class="p">,</span><span class="s1">&#39;prob_sat_fire&#39;</span><span class="p">]</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data_extracted</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">core_nodes</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">(</span><span class="n">headers</span><span class="p">))</span>
<span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;Landslide_std_fire.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Make ascii files for raster creation in GIS</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">write_esri_ascii</span><span class="p">(</span><span class="s1">&#39;prob_fail_std.txt&#39;</span><span class="p">,</span><span class="n">grid</span><span class="p">,</span><span class="n">names</span><span class="o">=</span><span class="s1">&#39;landslide__probability_of_failure&#39;</span><span class="p">)</span>
<span class="n">write_esri_ascii</span><span class="p">(</span><span class="s1">&#39;mean_RW_std.txt&#39;</span><span class="p">,</span><span class="n">grid</span><span class="p">,</span><span class="n">names</span><span class="o">=</span><span class="s1">&#39;soil__mean_relative_wetness&#39;</span><span class="p">)</span>
<span class="n">write_esri_ascii</span><span class="p">(</span><span class="s1">&#39;prob_sat_std.txt&#39;</span><span class="p">,</span><span class="n">grid</span><span class="p">,</span><span class="n">names</span><span class="o">=</span><span class="s1">&#39;soil__probability_of_saturation&#39;</span><span class="p">)</span>
<span class="n">write_esri_ascii</span><span class="p">(</span><span class="s1">&#39;prob_fail_fire.txt&#39;</span><span class="p">,</span><span class="n">grid_fire</span><span class="p">,</span><span class="n">names</span><span class="o">=</span><span class="s1">&#39;landslide__probability_of_failure&#39;</span><span class="p">)</span>
<span class="n">write_esri_ascii</span><span class="p">(</span><span class="s1">&#39;mean_RW_fire.txt&#39;</span><span class="p">,</span><span class="n">grid_fire</span><span class="p">,</span><span class="n">names</span><span class="o">=</span><span class="s1">&#39;soil__mean_relative_wetness&#39;</span><span class="p">)</span>
<span class="n">write_esri_ascii</span><span class="p">(</span><span class="s1">&#39;prob_sat_fire.txt&#39;</span><span class="p">,</span><span class="n">grid_fire</span><span class="p">,</span><span class="n">names</span><span class="o">=</span><span class="s1">&#39;soil__probability_of_saturation&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>How long did the code above take to run?</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Elapsed time is </span><span class="si">%3.2f</span><span class="s1"> seconds&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">st</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="4.0.-Save-the-results-back-into-HydroShare">
<h2>4.0. Save the results back into HydroShare<a class="headerlink" href="#4.0.-Save-the-results-back-into-HydroShare" title="Permalink to this headline">¶</a></h2>
<p>Using the <code class="docutils literal notranslate"><span class="pre">hs_utils</span></code> library, the results of the Geoprocessing steps above can be saved back into HydroShare. First, define all of the required metadata for resource creation, i.e. <em>title</em>, <em>abstract</em>, <em>keywords</em>, <em>content files</em>. In addition, we must define the type of resource that will be created, in this case <em>genericresource</em>.</p>
<p><strong>Note:</strong> Make sure you save the notebook at this point, so that all notebook changes will be saved into the new HydroShare resource.</p>
<p><strong>Option A</strong> : define the resource from which this “NEW” content has been derived. This is one method for tracking resource provenance.</p>
<p>Create list of files to save to HydroShare. Verify location and names.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">ThisNotebook</span><span class="o">=</span><span class="s1">&#39;replicate_landslide_model_for_fire.ipynb&#39;</span> <span class="c1">#check name for consistency</span>
<span class="n">files</span><span class="o">=</span><span class="p">[</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">homedir</span><span class="p">,</span> <span class="n">ThisNotebook</span><span class="p">),</span>
       <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">homedir</span><span class="p">,</span> <span class="s1">&#39;Landslide_std_fire.csv&#39;</span><span class="p">),</span>
       <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">homedir</span><span class="p">,</span> <span class="s1">&#39;prob_fail_std.txt&#39;</span><span class="p">),</span>
       <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">homedir</span><span class="p">,</span> <span class="s1">&#39;mean_RW_std.txt&#39;</span><span class="p">),</span>
       <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">homedir</span><span class="p">,</span> <span class="s1">&#39;prob_sat_std.txt&#39;</span><span class="p">),</span>
       <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">homedir</span><span class="p">,</span> <span class="s1">&#39;prob_fail_fire.txt&#39;</span><span class="p">),</span>
       <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">homedir</span><span class="p">,</span> <span class="s1">&#39;mean_RW_fire.txt&#39;</span><span class="p">),</span>
       <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">homedir</span><span class="p">,</span> <span class="s1">&#39;prob_sat_fire.txt&#39;</span><span class="p">)]</span>

<span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">[ERROR] invalid path: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">f</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">help</span><span class="p">(</span><span class="n">hs</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Save the results back to HydroShare</span>

<span class="c1"># title for the new resource</span>
<span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Landslide Model run with Monte Carlo from NOCA Observatory - Thunder Creek with Fire&#39;</span>

<span class="c1"># abstract for the new resource</span>
<span class="n">abstract</span> <span class="o">=</span> <span class="s1">&#39;This a reproducible demonstration of the landslide modeling results from eSurf paper: Strauch et al. (2018) &#39;</span>

<span class="c1"># keywords for the new resource</span>
<span class="n">keywords</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;landslide&#39;</span><span class="p">,</span> <span class="s1">&#39;climate&#39;</span><span class="p">,</span> <span class="s1">&#39;VIC&#39;</span><span class="p">,</span><span class="s1">&#39;saturation&#39;</span><span class="p">,</span><span class="s1">&#39;relative wetness&#39;</span><span class="p">,</span><span class="s1">&#39;fire&#39;</span><span class="p">,</span><span class="s1">&#39;Geohackweek&#39;</span><span class="p">]</span>

<span class="c1"># Hydroshare resource type</span>
<span class="n">rtype</span> <span class="o">=</span> <span class="s1">&#39;compositeresource&#39;</span>

<span class="c1"># create the new resource</span>
<span class="n">resource_id</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">createHydroShareResource</span><span class="p">(</span><span class="n">abstract</span><span class="p">,</span>
                                          <span class="n">title</span><span class="p">,</span>
                                          <span class="n">keywords</span><span class="o">=</span><span class="n">keywords</span><span class="p">,</span>
                                          <span class="n">resource_type</span><span class="o">=</span><span class="n">rtype</span><span class="p">,</span>
                                          <span class="n">content_files</span><span class="o">=</span><span class="n">files</span><span class="p">,</span>
                                          <span class="n">public</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="Acknowledgements">
<h3>Acknowledgements<a class="headerlink" href="#Acknowledgements" title="Permalink to this headline">¶</a></h3>
<p><a class="reference external" href="https://zenodo.org/badge/latestdoi/187289993"><img alt="DOI" src="https://zenodo.org/badge/187289993.svg" /></a></p>
<p>This Notebooks serves as content for:</p>
<p>Bandaragoda, C. J., A. Castronova, E. Istanbulluoglu, R. Strauch, S. S. Nudurupati, J. Phuong, J. M. Adams, et al. “Enabling Collaborative Numerical Modeling in Earth Sciences Using Knowledge Infrastructure.” Environmental Modelling &amp; Software, April 24, 2019. <a class="reference external" href="https://doi.org/10.1016/j.envsoft.2019.03.020">https://doi.org/10.1016/j.envsoft.2019.03.020</a>.</p>
<p>and</p>
<p>Bandaragoda, C., A. M. Castronova, J. Phuong, E. Istanbulluoglu, S. S. Nudurupati, R. Strauch, N. Lyons, K. Barnhart (2019). Enabling Collaborative Numerical Modeling in Earth Sciences using Knowledge Infrastructure: Landlab Notebooks, HydroShare, <a class="reference external" href="http://www.hydroshare.org/resource/fdc3a06e6ad842abacfa5b896df73a76">http://www.hydroshare.org/resource/fdc3a06e6ad842abacfa5b896df73a76</a></p>
<p>This notebook was developed from code written by Ronda Strauch as part of her Ph.D. disseration at the University of Washington.</p>
<p>Use or citation of this notebook should also reference:</p>
<p>Strauch R., Istanbulluoglu E., Nudurupati S.S., Bandaragoda C., Gasparini N.M., and G.E. Tucker (2018). A hydro-climatological approach to predicting regional landslide probability using Landlab. Earth Surf. Dynam., 6, 1–26. <a class="reference external" href="https://www.earth-surf-dynam.net/6/1/2018/">https://www.earth-surf-dynam.net/6/1/2018/</a></p>
</div>
</div>
</div>


           </div>
           
          </div>
          <!-- 
This file modifies the default sphinx_rtd_theme footer
-->



<footer>
  

  <hr/>

  <div role="contentinfo">
    <p>

    </p>
  </div>
  <!-- your html code here -->


</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>