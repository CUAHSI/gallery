

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Introduction &mdash; CUAHSI Gallery</title>
  

  
  <link rel="stylesheet" href="../../../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../_static/graphviz.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../_static/copybutton.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../_static/tabs.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../_static/css/custom.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../_static/panels-bootstrap.5fd3999ee7762ccc51105388f4a9d115.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../_static/contentui.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../_static/sphinxcontrib-images/LightBox2/lightbox2/css/lightbox.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../../../" src="../../../../../_static/documentation_options.js"></script>
        <script src="../../../../../_static/jquery.js"></script>
        <script src="../../../../../_static/underscore.js"></script>
        <script src="../../../../../_static/doctools.js"></script>
        <script src="../../../../../_static/language_data.js"></script>
        <script src="../../../../../_static/clipboard.min.js"></script>
        <script src="../../../../../_static/copybutton.js"></script>
        <script src="../../../../../_static/js/custom.js"></script>
        <script src="../../../../../_static/contentui.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
        <script src="../../../../../_static/sphinxcontrib-images/LightBox2/lightbox2/js/jquery-1.11.0.min.js"></script>
        <script src="../../../../../_static/sphinxcontrib-images/LightBox2/lightbox2/js/lightbox.min.js"></script>
        <script src="../../../../../_static/sphinxcontrib-images/LightBox2/lightbox2-customize/jquery-noconflict.js"></script>
    
    <script type="text/javascript" src="../../../../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../../../index.html">
          

          
            
            <img src="../../../../../_static/cuahsi-logo.png" class="logo" alt="Logo"/>
          
          </a>

          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Galleries</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../Python/index.html">Python</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../Python/index.html#research-examples">Research Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../Python/index.html#reproducible-science-examples">Reproducible Science Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../Python/index.html#instructional-examples">Instructional Examples</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../index.html">R</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../index.html#instructional-examples">Instructional Examples</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../RShiny/index.html">RShiny</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../RShiny/index.html#research-examples">Research Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../RShiny/index.html#instructional-examples">Instructional Examples</a></li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../../index.html">CUAHSI Gallery</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          <!--
The purpose of this template is to override (i.e. supress) the breadcrumbs that appear at the top of each page.
-->


          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container,
div.nbinput.container div.prompt,
div.nbinput.container div.input_area,
div.nbinput.container div[class*=highlight],
div.nbinput.container div[class*=highlight] pre,
div.nboutput.container,
div.nboutput.container div.prompt,
div.nboutput.container div.output_area,
div.nboutput.container div[class*=highlight],
div.nboutput.container div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    background: #f5f5f5;
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<p># Chemical Properties of Rivers: Impacts of Mining on Specific Conductance and pH</p>
<p>This lesson was adapted from educational material written by <a class="reference external" href="https://www.hydroshare.org/user/4912/">Dr. Kateri Salk</a> for her Fall 2019 Hydrologic Data Analysis course at Duke University.</p>
<div class="section" id="Introduction">
<h1>Introduction<a class="headerlink" href="#Introduction" title="Permalink to this headline">¶</a></h1>
<p>The hydrologic impacts on mining can cause cause damage to a landscape in an area much larger than the mining site itself. Water-pollution problems caused by mining include acid mine drainage, metal contamination, and increased sediment levels. The devastating effects of mining impact fisheries, swimming, domestic water supply, irrigation, and other uses of streams. For more information on the environmental impacts of mining, please visit
<a class="reference external" href="http://www.pollutionissues.com/Li-Na/Mining.html#ixzz6jGlfrX9m">http://www.pollutionissues.com/Li-Na/Mining.html#ixzz6jGlfrX9m</a></p>
</div>
<div class="section" id="Learning-Objectives">
<h1>Learning Objectives<a class="headerlink" href="#Learning-Objectives" title="Permalink to this headline">¶</a></h1>
<p>After successfully completing this exercise, you will be able to:</p>
<ol class="arabic simple">
<li><p>Execute queries to pull a variety of National Water Information System (NWIS) and Water Quality Portal (WQP) data into R.</p></li>
<li><p>Analyze inorganic aspects of water quality following a watershed disturbance such as mining.</p></li>
</ol>
</div>
<div class="section" id="Requirements-to-Complete-Lesson">
<h1>Requirements to Complete Lesson<a class="headerlink" href="#Requirements-to-Complete-Lesson" title="Permalink to this headline">¶</a></h1>
<div class="section" id="Packages">
<h2>Packages<a class="headerlink" href="#Packages" title="Permalink to this headline">¶</a></h2>
<p>This lesson requires the installation of the following R packages to run the provided script: - <code class="docutils literal notranslate"><span class="pre">tidyverse</span></code>- Version 1.3.0. A collection of R packages designed for data science. - <code class="docutils literal notranslate"><span class="pre">lubridate</span></code>- Version 1.7.9. Functions for working with dates/times. - <code class="docutils literal notranslate"><span class="pre">ggplot2</span></code>- Version 3.3.3. Creates elegant data visualisations using the Grammar of Graphics. - <code class="docutils literal notranslate"><span class="pre">scales</span></code>- Version 1.1.1. Graphical scales provide methods for automatically determining breaks and labels for axes and legends. -
<code class="docutils literal notranslate"><span class="pre">dataRetrieval</span></code>- Version 2.7.6. Retrieval Functions for USGS and EPA Hydrologic and Water Quality Data. - <code class="docutils literal notranslate"><span class="pre">cowplot</span></code>- Version 1.1.1. Provides various features that help with creating publication-quality figures with ‘ggplot2’, such as a set of themes, functions to align plots and arrange them into complex compound figures, and functions that make it easy to annotate plots and or mix plots with images.</p>
</div>
<div class="section" id="Data-and-Code">
<h2>Data and Code<a class="headerlink" href="#Data-and-Code" title="Permalink to this headline">¶</a></h2>
<p>This lesson will import water quality data for two rivers in West Virginia, Twelvepole Creek and Kanawha River, for the entire period of record using the <code class="docutils literal notranslate"><span class="pre">dataRetrieval</span></code> package. The package was created to make querying and downloading hydrologic data from the USGS National Water Information System (NWIS) and the multi-agency database, Water Quality Portal (WQP) easier. NWIS contains streamflow, peak flow, rating curves, groundwater, and water quality data data collected by or for the USGS.
WQP only contains water quality data.</p>
<p>It should be noted that the databases are not static as data is constantly being added. For more in-depth information on the <code class="docutils literal notranslate"><span class="pre">dataRetrieval</span></code> package, please visit <a class="reference external" href="https://cran.r-project.org/web/packages/dataRetrieval/vignettes/dataRetrieval.html">https://cran.r-project.org/web/packages/dataRetrieval/vignettes/dataRetrieval.html</a>.</p>
<p>The code provided in this resource was developed using R version 3.6.1.</p>
</div>
<div class="section" id="Set-Working-Directory">
<h2>Set Working Directory<a class="headerlink" href="#Set-Working-Directory" title="Permalink to this headline">¶</a></h2>
<p>In R, the working directory is the directory where R starts when looking for any file to open (as directed by a file path) and where it saves any output. This lesson assumes that you have set your working directory to the folder location of the downloaded and unzipped data subsets.</p>
</div>
<div class="section" id="Load-Packages-and-set-ggplot-theme">
<h2>Load Packages and set ggplot theme<a class="headerlink" href="#Load-Packages-and-set-ggplot-theme" title="Permalink to this headline">¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[179]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span><span class="nf">options</span><span class="p">(</span><span class="n">warn</span><span class="o">=</span><span class="m">-1</span><span class="p">)</span>

<span class="nf">library</span><span class="p">(</span><span class="n">tidyverse</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">lubridate</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">ggplot2</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">scales</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">dataRetrieval</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">cowplot</span><span class="p">)</span>

<span class="nf">theme_set</span><span class="p">(</span><span class="nf">theme_gray</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="Specific-Conductance-and-pH">
<h1>Specific Conductance and pH<a class="headerlink" href="#Specific-Conductance-and-pH" title="Permalink to this headline">¶</a></h1>
<p><strong>pH</strong> is a measure of the acidity of water. Most natural rivers have pH close to 7 (neutral), but depending on the geology of the watershed they drain, pH can be higher or lower. Most aquatic life has difficulty living in pH less than 6. In areas high in limestone, such as much of the southern Appalachian mountain range, pH tends to be between 7.5 and 8.</p>
<p><strong>Specific conductance</strong> is a measure of water’s ability to conduct electricity. Because conductivity depends on the number of ions in solution, specific conductance is an inexpensive estimate of how many salts are in solution. Specific conductance is dependant on the total ionic strength of the water, and cannot be directly converted to concentrations of any one ion. In general though, saltier water will have higher specific conductance. Units for specific conductance in freshwater are
microsiemens per centimeter at 25 degrees Celsius.</p>
</div>
<div class="section" id="Import-Water-Quality-Data-from-the-Kanawha-River-&amp;-Twelvepole-Creek">
<h1>Import Water Quality Data from the Kanawha River &amp; Twelvepole Creek<a class="headerlink" href="#Import-Water-Quality-Data-from-the-Kanawha-River-&-Twelvepole-Creek" title="Permalink to this headline">¶</a></h1>
</div>
<div class="section" id="readNWISqw">
<h1><code class="docutils literal notranslate"><span class="pre">readNWISqw</span></code><a class="headerlink" href="#readNWISqw" title="Permalink to this headline">¶</a></h1>
<p>Use the <code class="docutils literal notranslate"><span class="pre">readNWISqw</span></code> function to import NWIS water quality data. You can access the complete list of NWIS parameter codes here: <a class="reference external" href="https://nwis.waterdata.usgs.gov/nwis/pmcodes/">https://nwis.waterdata.usgs.gov/nwis/pmcodes/</a>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[180]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span><span class="n">data.raw</span> <span class="o">&lt;-</span> <span class="nf">readNWISqw</span><span class="p">(</span><span class="n">siteNumbers</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="s">&quot;03201300&quot;</span><span class="p">,</span><span class="s">&quot;03206790&quot;</span><span class="p">),</span> <span class="c1">#Kanawha River &amp; Twelvepole Creek</span>
                     <span class="n">parameterCd</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="s">&quot;00095&quot;</span><span class="p">,</span> <span class="s">&quot;00400&quot;</span><span class="p">),</span> <span class="c1">#Specific Conductance &amp; pH</span>
                     <span class="n">startDate</span> <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="p">,</span>
                     <span class="n">endDate</span> <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[181]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span><span class="nf">head</span><span class="p">(</span><span class="n">data.raw</span><span class="p">)</span> <span class="c1">#view first six lines of data frame</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<table>
<caption>A data.frame: 6 × 34</caption>
<thead>
    <tr><th></th><th scope=col>agency_cd</th><th scope=col>site_no</th><th scope=col>sample_dt</th><th scope=col>sample_tm</th><th scope=col>sample_end_dt</th><th scope=col>sample_end_tm</th><th scope=col>sample_start_time_datum_cd</th><th scope=col>tm_datum_rlbty_cd</th><th scope=col>coll_ent_cd</th><th scope=col>medium_cd</th><th scope=col>⋯</th><th scope=col>rpt_lev_va</th><th scope=col>rpt_lev_cd</th><th scope=col>lab_std_va</th><th scope=col>prep_set_no</th><th scope=col>prep_dt</th><th scope=col>anl_set_no</th><th scope=col>anl_dt</th><th scope=col>result_lab_cm_tx</th><th scope=col>anl_ent_cd</th><th scope=col>startDateTime</th></tr>
    <tr><th></th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;date&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;date&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>⋯</th><th scope=col>&lt;lgl&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;lgl&gt;</th><th scope=col>&lt;lgl&gt;</th><th scope=col>&lt;lgl&gt;</th><th scope=col>&lt;lgl&gt;</th><th scope=col>&lt;lgl&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;dttm&gt;</th></tr>
</thead>
<tbody>
    <tr><th scope=row>1</th><td>USGS</td><td>03206790</td><td>1969-09-09</td><td>11:00</td><td>NA</td><td>NA</td><td>EDT</td><td>T</td><td>USGS-WRD</td><td>WS</td><td>⋯</td><td>NA</td><td>NA</td><td>NA</td><td>NA</td><td>NA</td><td>NA</td><td>NA</td><td>NA</td><td>NA</td><td>1969-09-09 11:00:00</td></tr>
    <tr><th scope=row>2</th><td>USGS</td><td>03206790</td><td>1969-12-09</td><td>10:45</td><td>NA</td><td>NA</td><td>EST</td><td>T</td><td>USGS-WRD</td><td>WS</td><td>⋯</td><td>NA</td><td>NA</td><td>NA</td><td>NA</td><td>NA</td><td>NA</td><td>NA</td><td>NA</td><td>NA</td><td>1969-12-09 10:45:00</td></tr>
    <tr><th scope=row>3</th><td>USGS</td><td>03206790</td><td>1969-12-09</td><td>10:45</td><td>NA</td><td>NA</td><td>EST</td><td>T</td><td>USGS-WRD</td><td>WS</td><td>⋯</td><td>NA</td><td>NA</td><td>NA</td><td>NA</td><td>NA</td><td>NA</td><td>NA</td><td>NA</td><td>NA</td><td>1969-12-09 10:45:00</td></tr>
    <tr><th scope=row>4</th><td>USGS</td><td>03206790</td><td>1969-12-31</td><td>13:10</td><td>NA</td><td>NA</td><td>EST</td><td>T</td><td>USGS-WRD</td><td>WS</td><td>⋯</td><td>NA</td><td>NA</td><td>NA</td><td>NA</td><td>NA</td><td>NA</td><td>NA</td><td>NA</td><td>NA</td><td>1969-12-31 13:10:00</td></tr>
    <tr><th scope=row>5</th><td>USGS</td><td>03206790</td><td>1969-12-31</td><td>13:10</td><td>NA</td><td>NA</td><td>EST</td><td>T</td><td>USGS-WRD</td><td>WS</td><td>⋯</td><td>NA</td><td>NA</td><td>NA</td><td>NA</td><td>NA</td><td>NA</td><td>NA</td><td>NA</td><td>NA</td><td>1969-12-31 13:10:00</td></tr>
    <tr><th scope=row>6</th><td>USGS</td><td>03206790</td><td>1970-01-20</td><td>11:15</td><td>NA</td><td>NA</td><td>EST</td><td>T</td><td>USGS-WRD</td><td>WS</td><td>⋯</td><td>NA</td><td>NA</td><td>NA</td><td>NA</td><td>NA</td><td>NA</td><td>NA</td><td>NA</td><td>NA</td><td>1970-01-20 11:15:00</td></tr>
</tbody>
</table></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[182]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span><span class="nf">str</span><span class="p">(</span><span class="n">dat.raw</span><span class="p">,</span> <span class="n">give.attr</span> <span class="o">=</span> <span class="kc">FALSE</span><span class="p">)</span> <span class="c1">#view internal structure of data frame</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&#39;data.frame&#39;:   1378 obs. of  34 variables:
 $ agency_cd                 : chr  &#34;USGS&#34; &#34;USGS&#34; &#34;USGS&#34; &#34;USGS&#34; ...
 $ site_no                   : chr  &#34;03206790&#34; &#34;03206790&#34; &#34;03206790&#34; &#34;03206790&#34; ...
 $ sample_dt                 : Date, format: &#34;1969-09-09&#34; &#34;1969-12-09&#34; ...
 $ sample_tm                 : chr  &#34;11:00&#34; &#34;10:45&#34; &#34;10:45&#34; &#34;13:10&#34; ...
 $ sample_end_dt             : Date, format: NA NA ...
 $ sample_end_tm             : chr  NA NA NA NA ...
 $ sample_start_time_datum_cd: chr  &#34;EDT&#34; &#34;EST&#34; &#34;EST&#34; &#34;EST&#34; ...
 $ tm_datum_rlbty_cd         : chr  &#34;T&#34; &#34;T&#34; &#34;T&#34; &#34;T&#34; ...
 $ coll_ent_cd               : chr  &#34;USGS-WRD&#34; &#34;USGS-WRD&#34; &#34;USGS-WRD&#34; &#34;USGS-WRD&#34; ...
 $ medium_cd                 : chr  &#34;WS&#34; &#34;WS&#34; &#34;WS&#34; &#34;WS&#34; ...
 $ project_cd                : chr  NA NA NA NA ...
 $ aqfr_cd                   : chr  NA NA NA NA ...
 $ tu_id                     : chr  NA NA NA NA ...
 $ body_part_id              : chr  NA NA NA NA ...
 $ hyd_cond_cd               : chr  &#34;A&#34; &#34;A&#34; &#34;A&#34; &#34;A&#34; ...
 $ samp_type_cd              : chr  &#34;9&#34; &#34;9&#34; &#34;9&#34; &#34;9&#34; ...
 $ hyd_event_cd              : chr  &#34;9&#34; &#34;9&#34; &#34;9&#34; &#34;9&#34; ...
 $ sample_lab_cm_tx          : chr  NA NA NA NA ...
 $ parm_cd                   : chr  &#34;00095&#34; &#34;00095&#34; &#34;00400&#34; &#34;00095&#34; ...
 $ remark_cd                 : chr  NA NA NA NA ...
 $ result_va                 : num  118 90 7.2 48 6.8 75 6.8 65 7 65 ...
 $ val_qual_tx               : chr  NA NA NA NA ...
 $ meth_cd                   : chr  NA NA NA NA ...
 $ dqi_cd                    : chr  &#34;A&#34; &#34;A&#34; &#34;A&#34; &#34;A&#34; ...
 $ rpt_lev_va                : logi  NA NA NA NA NA NA ...
 $ rpt_lev_cd                : chr  NA NA NA NA ...
 $ lab_std_va                : logi  NA NA NA NA NA NA ...
 $ prep_set_no               : logi  NA NA NA NA NA NA ...
 $ prep_dt                   : logi  NA NA NA NA NA NA ...
 $ anl_set_no                : logi  NA NA NA NA NA NA ...
 $ anl_dt                    : logi  NA NA NA NA NA NA ...
 $ result_lab_cm_tx          : chr  NA NA NA NA ...
 $ anl_ent_cd                : chr  NA NA NA NA ...
 $ startDateTime             : POSIXct, format: &#34;1969-09-09 11:00:00&#34; &#34;1969-12-09 10:45:00&#34; ...
</pre></div></div>
</div>
</div>
<div class="section" id="Regroup-data-frame-to-put-pH-and-Specific-Conductance-(SpC)-in-separate-columns,-grouped-by-Date,-Parameter,-and-Site">
<h1>Regroup data frame to put pH and Specific Conductance (SpC) in separate columns, grouped by Date, Parameter, and Site<a class="headerlink" href="#Regroup-data-frame-to-put-pH-and-Specific-Conductance-(SpC)-in-separate-columns,-grouped-by-Date,-Parameter,-and-Site" title="Permalink to this headline">¶</a></h1>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[183]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span><span class="n">data</span> <span class="o">&lt;-</span> <span class="n">data.raw</span> <span class="o">%&gt;%</span>
  <span class="nf">select</span><span class="p">(</span><span class="n">Site</span> <span class="o">=</span> <span class="n">site_no</span><span class="p">,</span>
         <span class="n">Date</span> <span class="o">=</span> <span class="n">sample_dt</span><span class="p">,</span>
         <span class="n">Parameter</span> <span class="o">=</span> <span class="n">parm_cd</span><span class="p">,</span>
         <span class="n">Value</span> <span class="o">=</span> <span class="n">result_va</span><span class="p">)</span> <span class="o">%&gt;%</span>
  <span class="nf">group_by</span><span class="p">(</span><span class="n">Date</span><span class="p">,</span> <span class="n">Parameter</span><span class="p">,</span> <span class="n">Site</span><span class="p">)</span> <span class="o">%&gt;%</span>
  <span class="nf">summarize</span><span class="p">(</span><span class="n">Value</span> <span class="o">=</span> <span class="nf">mean</span><span class="p">(</span><span class="n">Value</span><span class="p">))</span> <span class="o">%&gt;%</span>
  <span class="nf">spread</span><span class="p">(</span><span class="n">key</span> <span class="o">=</span> <span class="n">Parameter</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="n">Value</span><span class="p">)</span> <span class="o">%&gt;%</span>
  <span class="nf">rename</span><span class="p">(</span><span class="n">SpC</span> <span class="o">=</span> <span class="s">&#39;00095&#39;</span><span class="p">,</span> <span class="n">pH</span> <span class="o">=</span> <span class="s">&#39;00400&#39;</span><span class="p">)</span> <span class="o">%&gt;%</span>
  <span class="nf">mutate</span><span class="p">(</span><span class="n">Site</span> <span class="o">=</span> <span class="nf">case_when</span><span class="p">(</span><span class="n">Site</span> <span class="o">==</span> <span class="s">&quot;03201300&quot;</span> <span class="o">~</span> <span class="s">&quot;Kanawha River&quot;</span><span class="p">,</span>
                          <span class="n">Site</span> <span class="o">==</span> <span class="s">&quot;03206790&quot;</span> <span class="o">~</span> <span class="s">&quot;Twelvepole Creek&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
`summarise()` regrouping output by &#39;Date&#39;, &#39;Parameter&#39; (override with `.groups` argument)

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[184]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span><span class="nf">head</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="c1">#only show first six rows of data</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<table>
<caption>A grouped_df: 6 × 4</caption>
<thead>
    <tr><th scope=col>Date</th><th scope=col>Site</th><th scope=col>SpC</th><th scope=col>pH</th></tr>
    <tr><th scope=col>&lt;date&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th></tr>
</thead>
<tbody>
    <tr><td>1956-10-01</td><td>Kanawha River</td><td>250</td><td>6.9</td></tr>
    <tr><td>1956-10-11</td><td>Kanawha River</td><td>278</td><td>7.0</td></tr>
    <tr><td>1956-10-21</td><td>Kanawha River</td><td>309</td><td>7.0</td></tr>
    <tr><td>1956-11-01</td><td>Kanawha River</td><td>162</td><td>6.8</td></tr>
    <tr><td>1956-11-11</td><td>Kanawha River</td><td>239</td><td>6.9</td></tr>
    <tr><td>1956-11-21</td><td>Kanawha River</td><td>270</td><td>6.7</td></tr>
</tbody>
</table></div>
</div>
<div class="section" id="Filter-out-data-from-before-1977">
<h2>Filter out data from before 1977<a class="headerlink" href="#Filter-out-data-from-before-1977" title="Permalink to this headline">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[185]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span><span class="n">data.early</span> <span class="o">&lt;-</span> <span class="n">data</span> <span class="o">%&gt;%</span>
  <span class="nf">filter</span><span class="p">(</span><span class="n">Date</span> <span class="o">&lt;</span> <span class="s">&quot;1977-01-01&quot;</span><span class="p">)</span>

<span class="nf">head</span><span class="p">(</span><span class="n">data.early</span><span class="p">)</span> <span class="c1">#only show first six rows of data</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<table>
<caption>A grouped_df: 6 × 4</caption>
<thead>
    <tr><th scope=col>Date</th><th scope=col>Site</th><th scope=col>SpC</th><th scope=col>pH</th></tr>
    <tr><th scope=col>&lt;date&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th></tr>
</thead>
<tbody>
    <tr><td>1956-10-01</td><td>Kanawha River</td><td>250</td><td>6.9</td></tr>
    <tr><td>1956-10-11</td><td>Kanawha River</td><td>278</td><td>7.0</td></tr>
    <tr><td>1956-10-21</td><td>Kanawha River</td><td>309</td><td>7.0</td></tr>
    <tr><td>1956-11-01</td><td>Kanawha River</td><td>162</td><td>6.8</td></tr>
    <tr><td>1956-11-11</td><td>Kanawha River</td><td>239</td><td>6.9</td></tr>
    <tr><td>1956-11-21</td><td>Kanawha River</td><td>270</td><td>6.7</td></tr>
</tbody>
</table></div>
</div>
</div>
</div>
<div class="section" id="Plot-the-pH-of-Twelvepole-Creek-and-Kanawha-River-prior-to-1977">
<h1>Plot the pH of Twelvepole Creek and Kanawha River prior to 1977<a class="headerlink" href="#Plot-the-pH-of-Twelvepole-Creek-and-Kanawha-River-prior-to-1977" title="Permalink to this headline">¶</a></h1>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[186]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span><span class="n">pH.plot</span> <span class="o">&lt;-</span> <span class="nf">ggplot</span><span class="p">(</span><span class="n">data.early</span><span class="p">,</span> <span class="nf">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">Date</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">pH</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">Site</span><span class="p">))</span> <span class="o">+</span>
  <span class="nf">geom_point</span><span class="p">()</span> <span class="o">+</span>
  <span class="nf">geom_smooth</span><span class="p">()</span><span class="o">+</span>
  <span class="nf">scale_color_manual</span><span class="p">(</span><span class="n">values</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="s">&quot;steelblue4&quot;</span><span class="p">,</span> <span class="s">&quot;darkorange4&quot;</span><span class="p">))</span> <span class="o">+</span>
  <span class="nf">ggtitle</span><span class="p">(</span><span class="s">&quot;pH of Two West Virginia Rivers 1956:1976&quot;</span><span class="p">)</span><span class="o">+</span>
<span class="nf">theme</span><span class="p">(</span><span class="n">plot.title</span> <span class="o">=</span> <span class="nf">element_text</span><span class="p">(</span><span class="n">margin</span> <span class="o">=</span> <span class="nf">margin</span><span class="p">(</span><span class="n">b</span> <span class="o">=</span> <span class="m">10</span><span class="p">),</span> <span class="n">size</span> <span class="o">=</span> <span class="m">18</span><span class="p">,</span> <span class="n">hjust</span><span class="o">=</span><span class="m">0.5</span><span class="p">,</span> <span class="n">vjust</span><span class="o">=</span><span class="m">0.5</span><span class="p">,</span> <span class="n">face</span><span class="o">=</span><span class="s">&#39;bold&#39;</span><span class="p">),</span><span class="n">axis.text.x</span> <span class="o">=</span> <span class="nf">element_text</span><span class="p">(</span><span class="n">color</span> <span class="o">=</span> <span class="s">&quot;black&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="m">10</span><span class="p">),</span> <span class="n">axis.text.y</span> <span class="o">=</span> <span class="nf">element_text</span><span class="p">(</span><span class="n">color</span> <span class="o">=</span> <span class="s">&quot;black&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="m">10</span><span class="p">))</span>

<span class="nf">print</span><span class="p">(</span><span class="n">pH.plot</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
`geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;

</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../../../_images/gallery_R_Instructional_Impact_of_Mining_on_River_Water_Quality_notebooks_Impact_of_Mining_on_River_Water_Quality__25_1.png" class="no-scaled-link" src="../../../../../_images/gallery_R_Instructional_Impact_of_Mining_on_River_Water_Quality_notebooks_Impact_of_Mining_on_River_Water_Quality__25_1.png" style="width: 420px; height: 420px;" />
</div>
</div>
</div>
<div class="section" id="Plot-the-Specific-Conductance-of-Twelvepole-Creek-and-Kanawha-River-prior-to-1977">
<h1>Plot the Specific Conductance of Twelvepole Creek and Kanawha River prior to 1977<a class="headerlink" href="#Plot-the-Specific-Conductance-of-Twelvepole-Creek-and-Kanawha-River-prior-to-1977" title="Permalink to this headline">¶</a></h1>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[187]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span><span class="n">SpC.plot</span> <span class="o">&lt;-</span> <span class="nf">ggplot</span><span class="p">(</span><span class="n">data.early</span><span class="p">,</span> <span class="nf">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">Date</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SpC</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">Site</span><span class="p">))</span> <span class="o">+</span>
  <span class="nf">geom_point</span><span class="p">()</span> <span class="o">+</span>
  <span class="nf">geom_smooth</span><span class="p">()</span><span class="o">+</span>
  <span class="nf">labs</span><span class="p">(</span><span class="n">y</span> <span class="o">=</span> <span class="nf">expression</span><span class="p">(</span><span class="s">&quot;Specific Conductance (&quot;</span><span class="o">*</span><span class="n">mu</span><span class="o">*</span><span class="n">S</span> <span class="o">*</span> <span class="n">cm</span><span class="o">**</span><span class="m">-1</span><span class="o">*</span><span class="s">&quot;)&quot;</span><span class="p">))</span> <span class="o">+</span>
  <span class="nf">scale_color_manual</span><span class="p">(</span><span class="n">values</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="s">&quot;steelblue4&quot;</span><span class="p">,</span> <span class="s">&quot;darkorange4&quot;</span><span class="p">))</span> <span class="o">+</span>
    <span class="nf">ggtitle</span><span class="p">(</span><span class="s">&quot;Specific Conductance of Two West Virginia Rivers 1956:1976&quot;</span><span class="p">)</span><span class="o">+</span>
<span class="nf">theme</span><span class="p">(</span><span class="n">plot.title</span> <span class="o">=</span> <span class="nf">element_text</span><span class="p">(</span><span class="n">margin</span> <span class="o">=</span> <span class="nf">margin</span><span class="p">(</span><span class="n">b</span> <span class="o">=</span> <span class="m">10</span><span class="p">),</span> <span class="n">size</span> <span class="o">=</span> <span class="m">15</span><span class="p">,</span> <span class="n">hjust</span><span class="o">=</span><span class="m">0.5</span><span class="p">,</span> <span class="n">vjust</span><span class="o">=</span><span class="m">0.5</span><span class="p">,</span> <span class="n">face</span><span class="o">=</span><span class="s">&#39;bold&#39;</span><span class="p">),</span><span class="n">axis.text.x</span> <span class="o">=</span> <span class="nf">element_text</span><span class="p">(</span><span class="n">color</span> <span class="o">=</span> <span class="s">&quot;black&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="m">10</span><span class="p">),</span> <span class="n">axis.text.y</span> <span class="o">=</span> <span class="nf">element_text</span><span class="p">(</span><span class="n">color</span> <span class="o">=</span> <span class="s">&quot;black&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="m">10</span><span class="p">))</span>


<span class="nf">print</span><span class="p">(</span><span class="n">SpC.plot</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
`geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;

</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../../../_images/gallery_R_Instructional_Impact_of_Mining_on_River_Water_Quality_notebooks_Impact_of_Mining_on_River_Water_Quality__27_1.png" class="no-scaled-link" src="../../../../../_images/gallery_R_Instructional_Impact_of_Mining_on_River_Water_Quality_notebooks_Impact_of_Mining_on_River_Water_Quality__27_1.png" style="width: 420px; height: 420px;" />
</div>
</div>
<p>What differences do you see? &gt;</p>
<p>Why might mining be causing the changes you see? &gt;</p>
<p>What is the data frequency of these water quality samples? Why don’t we have daily values? How does this inform your interpretation of the data? &gt;</p>
</div>
<div class="section" id="What-can-legislative-protections-do-for-water-quality?">
<h1>What can legislative protections do for water quality?<a class="headerlink" href="#What-can-legislative-protections-do-for-water-quality?" title="Permalink to this headline">¶</a></h1>
<p>In 1977 the Surface Mining Control and Reclamation Act (SMCRA) was passed. Take a look at how water quality changed after 1977.</p>
</div>
<div class="section" id="Plot-pH-over-entire-period-of-record-and-annotate-the-graph-with-a-vertical-line-at-1977">
<h1>Plot pH over entire period of record and annotate the graph with a vertical line at 1977<a class="headerlink" href="#Plot-pH-over-entire-period-of-record-and-annotate-the-graph-with-a-vertical-line-at-1977" title="Permalink to this headline">¶</a></h1>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[188]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span><span class="n">pH.plot.2</span> <span class="o">&lt;-</span> <span class="nf">ggplot</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="nf">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">Date</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">pH</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">Site</span><span class="p">))</span> <span class="o">+</span>
  <span class="nf">geom_point</span><span class="p">()</span> <span class="o">+</span>
  <span class="nf">geom_smooth</span><span class="p">()</span> <span class="o">+</span>
  <span class="nf">geom_vline</span><span class="p">(</span><span class="n">xintercept</span> <span class="o">=</span> <span class="m">1977</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s">&quot;black&quot;</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="m">0.8</span><span class="p">,</span> <span class="n">lwd</span> <span class="o">=</span> <span class="m">2</span><span class="p">,</span> <span class="n">lty</span> <span class="o">=</span> <span class="m">2</span><span class="p">)</span> <span class="o">+</span> <span class="c1">#add vertical reference line to annotate plot</span>
  <span class="nf">scale_color_manual</span><span class="p">(</span><span class="n">values</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="s">&quot;steelblue4&quot;</span><span class="p">,</span> <span class="s">&quot;darkorange4&quot;</span><span class="p">))</span> <span class="o">+</span>
    <span class="nf">ggtitle</span><span class="p">(</span><span class="s">&quot;pH of Two West Virginia Rivers 1956:2000&quot;</span><span class="p">)</span><span class="o">+</span>
<span class="nf">theme</span><span class="p">(</span><span class="n">plot.title</span> <span class="o">=</span> <span class="nf">element_text</span><span class="p">(</span><span class="n">margin</span> <span class="o">=</span> <span class="nf">margin</span><span class="p">(</span><span class="n">b</span> <span class="o">=</span> <span class="m">10</span><span class="p">),</span> <span class="n">size</span> <span class="o">=</span> <span class="m">18</span><span class="p">,</span> <span class="n">hjust</span><span class="o">=</span><span class="m">0.5</span><span class="p">,</span> <span class="n">vjust</span><span class="o">=</span><span class="m">0.5</span><span class="p">,</span> <span class="n">face</span><span class="o">=</span><span class="s">&#39;bold&#39;</span><span class="p">),</span><span class="n">axis.text.x</span> <span class="o">=</span> <span class="nf">element_text</span><span class="p">(</span><span class="n">color</span> <span class="o">=</span> <span class="s">&quot;black&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="m">10</span><span class="p">),</span> <span class="n">axis.text.y</span> <span class="o">=</span> <span class="nf">element_text</span><span class="p">(</span><span class="n">color</span> <span class="o">=</span> <span class="s">&quot;black&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="m">10</span><span class="p">))</span>


<span class="nf">print</span><span class="p">(</span><span class="n">pH.plot.2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
`geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;

</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../../../_images/gallery_R_Instructional_Impact_of_Mining_on_River_Water_Quality_notebooks_Impact_of_Mining_on_River_Water_Quality__31_1.png" class="no-scaled-link" src="../../../../../_images/gallery_R_Instructional_Impact_of_Mining_on_River_Water_Quality_notebooks_Impact_of_Mining_on_River_Water_Quality__31_1.png" style="width: 420px; height: 420px;" />
</div>
</div>
</div>
<div class="section" id="Plot-Specific-Conductance-over-entire-period-of-record-and-annotate-the-graph-with-a-vertical-line-at-1977">
<h1>Plot Specific Conductance over entire period of record and annotate the graph with a vertical line at 1977<a class="headerlink" href="#Plot-Specific-Conductance-over-entire-period-of-record-and-annotate-the-graph-with-a-vertical-line-at-1977" title="Permalink to this headline">¶</a></h1>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[189]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span><span class="n">SpC.plot2</span> <span class="o">&lt;-</span> <span class="nf">ggplot</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="nf">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">Date</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SpC</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">Site</span><span class="p">))</span> <span class="o">+</span>
  <span class="nf">geom_point</span><span class="p">()</span> <span class="o">+</span>
  <span class="nf">geom_smooth</span><span class="p">()</span> <span class="o">+</span>
  <span class="nf">geom_vline</span><span class="p">(</span><span class="n">xintercept</span> <span class="o">=</span> <span class="m">1977</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s">&quot;grey&quot;</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="m">0.8</span><span class="p">,</span> <span class="n">lwd</span> <span class="o">=</span> <span class="m">2</span><span class="p">,</span> <span class="n">lty</span> <span class="o">=</span> <span class="m">2</span><span class="p">)</span> <span class="o">+</span> <span class="c1">#add vertical reference line to annotate plot</span>
  <span class="nf">labs</span><span class="p">(</span><span class="n">y</span> <span class="o">=</span> <span class="nf">expression</span><span class="p">(</span><span class="s">&quot;Specific Conductance (&quot;</span><span class="o">*</span><span class="n">mu</span><span class="o">*</span><span class="n">S</span> <span class="o">*</span> <span class="n">cm</span><span class="o">**</span><span class="m">-1</span><span class="o">*</span><span class="s">&quot;)&quot;</span><span class="p">))</span> <span class="o">+</span>
  <span class="nf">scale_color_manual</span><span class="p">(</span><span class="n">values</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="s">&quot;steelblue4&quot;</span><span class="p">,</span> <span class="s">&quot;darkorange4&quot;</span><span class="p">))</span> <span class="o">+</span>
    <span class="nf">ggtitle</span><span class="p">(</span><span class="s">&quot;Specific Conductance of Two West Virginia Rivers 1956:2000&quot;</span><span class="p">)</span><span class="o">+</span>
<span class="nf">theme</span><span class="p">(</span><span class="n">plot.title</span> <span class="o">=</span> <span class="nf">element_text</span><span class="p">(</span><span class="n">margin</span> <span class="o">=</span> <span class="nf">margin</span><span class="p">(</span><span class="n">b</span> <span class="o">=</span> <span class="m">10</span><span class="p">),</span> <span class="n">size</span> <span class="o">=</span> <span class="m">15</span><span class="p">,</span> <span class="n">hjust</span><span class="o">=</span><span class="m">0.5</span><span class="p">,</span> <span class="n">vjust</span><span class="o">=</span><span class="m">0.5</span><span class="p">,</span> <span class="n">face</span><span class="o">=</span><span class="s">&#39;bold&#39;</span><span class="p">),</span><span class="n">axis.text.x</span> <span class="o">=</span> <span class="nf">element_text</span><span class="p">(</span><span class="n">color</span> <span class="o">=</span> <span class="s">&quot;black&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="m">10</span><span class="p">),</span> <span class="n">axis.text.y</span> <span class="o">=</span> <span class="nf">element_text</span><span class="p">(</span><span class="n">color</span> <span class="o">=</span> <span class="s">&quot;black&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="m">10</span><span class="p">))</span>


<span class="nf">print</span><span class="p">(</span><span class="n">SpC.plot2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
`geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;

</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../../../_images/gallery_R_Instructional_Impact_of_Mining_on_River_Water_Quality_notebooks_Impact_of_Mining_on_River_Water_Quality__33_1.png" class="no-scaled-link" src="../../../../../_images/gallery_R_Instructional_Impact_of_Mining_on_River_Water_Quality_notebooks_Impact_of_Mining_on_River_Water_Quality__33_1.png" style="width: 420px; height: 420px;" />
</div>
</div>
<p>What differences are visible in the magnitude of pH and specific conductance over time? &gt;</p>
</div>
<div class="section" id="Analyze-the-yearly-average-concentrations-of-pH-and-SpC-in-Kanawha-River-before-and-after-1977">
<h1>Analyze the yearly average concentrations of pH and SpC in Kanawha River before and after 1977<a class="headerlink" href="#Analyze-the-yearly-average-concentrations-of-pH-and-SpC-in-Kanawha-River-before-and-after-1977" title="Permalink to this headline">¶</a></h1>
<p>We will first filter the main data frame for only Kanawha River observations, create a Year column and group all observations by year, summarize the SpC and pH columns by mean, and then create a new column indicating whether the observation was collected before 1977 (“Pre”) or after 1977 (“Post”).</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[190]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span><span class="n">Kanawha.yearly.averages</span> <span class="o">&lt;-</span> <span class="n">data</span> <span class="o">%&gt;%</span>
  <span class="nf">filter</span><span class="p">(</span><span class="n">Site</span> <span class="o">==</span> <span class="s">&quot;Kanawha River&quot;</span><span class="p">)</span> <span class="o">%&gt;%</span>
  <span class="nf">group_by</span><span class="p">(</span><span class="n">Year</span> <span class="o">=</span> <span class="nf">year</span><span class="p">(</span><span class="n">Date</span><span class="p">))</span> <span class="o">%&gt;%</span>
  <span class="nf">select</span><span class="p">(</span><span class="o">-</span><span class="n">Site</span><span class="p">,</span> <span class="o">-</span><span class="n">Date</span><span class="p">)</span> <span class="o">%&gt;%</span>
  <span class="nf">summarize_all</span><span class="p">(</span><span class="n">mean</span><span class="p">)</span> <span class="o">%&gt;%</span>
  <span class="nf">mutate</span><span class="p">(</span><span class="n">bin</span> <span class="o">=</span> <span class="nf">case_when</span><span class="p">(</span><span class="n">Year</span> <span class="o">%in%</span> <span class="nf">c</span><span class="p">(</span><span class="m">1956</span><span class="o">:</span><span class="m">1977</span><span class="p">)</span> <span class="o">~</span> <span class="s">&quot;Pre&quot;</span><span class="p">,</span>
                         <span class="n">Year</span> <span class="o">%in%</span> <span class="nf">c</span><span class="p">(</span><span class="m">1978</span><span class="o">:</span><span class="m">2000</span><span class="p">)</span> <span class="o">~</span> <span class="s">&quot;Post&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[191]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span><span class="n">Kanawha.yearly.averages</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<table>
<caption>A tibble: 42 × 4</caption>
<thead>
    <tr><th scope=col>Year</th><th scope=col>SpC</th><th scope=col>pH</th><th scope=col>bin</th></tr>
    <tr><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;chr&gt;</th></tr>
</thead>
<tbody>
    <tr><td>1956</td><td>233.5556</td><td>6.877778</td><td>Pre </td></tr>
    <tr><td>1957</td><td>232.1852</td><td>7.011111</td><td>Pre </td></tr>
    <tr><td>1959</td><td>215.6667</td><td>6.833333</td><td>Pre </td></tr>
    <tr><td>1960</td><td>267.3333</td><td>      NA</td><td>Pre </td></tr>
    <tr><td>1961</td><td>218.9375</td><td>      NA</td><td>Pre </td></tr>
    <tr><td>1962</td><td>275.9412</td><td>      NA</td><td>Pre </td></tr>
    <tr><td>1963</td><td>383.2125</td><td>      NA</td><td>Pre </td></tr>
    <tr><td>1964</td><td>      NA</td><td>6.834426</td><td>Pre </td></tr>
    <tr><td>1965</td><td>      NA</td><td>6.718750</td><td>Pre </td></tr>
    <tr><td>1966</td><td>401.4222</td><td>6.640000</td><td>Pre </td></tr>
    <tr><td>1967</td><td>298.8889</td><td>6.877778</td><td>Pre </td></tr>
    <tr><td>1968</td><td>334.5556</td><td>6.922222</td><td>Pre </td></tr>
    <tr><td>1969</td><td>322.9444</td><td>6.752778</td><td>Pre </td></tr>
    <tr><td>1970</td><td>284.6667</td><td>6.970370</td><td>Pre </td></tr>
    <tr><td>1972</td><td>195.5000</td><td>7.183333</td><td>Pre </td></tr>
    <tr><td>1974</td><td>218.1250</td><td>7.262500</td><td>Pre </td></tr>
    <tr><td>1975</td><td>      NA</td><td>7.520000</td><td>Pre </td></tr>
    <tr><td>1976</td><td>258.8889</td><td>      NA</td><td>Pre </td></tr>
    <tr><td>1977</td><td>241.0833</td><td>      NA</td><td>Pre </td></tr>
    <tr><td>1978</td><td>213.7500</td><td>7.350000</td><td>Post</td></tr>
    <tr><td>1979</td><td>147.5455</td><td>7.136364</td><td>Post</td></tr>
    <tr><td>1980</td><td>233.0769</td><td>7.107692</td><td>Post</td></tr>
    <tr><td>1981</td><td>211.9000</td><td>7.260000</td><td>Post</td></tr>
    <tr><td>1982</td><td>189.0952</td><td>7.116667</td><td>Post</td></tr>
    <tr><td>1983</td><td>188.7500</td><td>7.075000</td><td>Post</td></tr>
    <tr><td>1984</td><td>154.0000</td><td>6.850000</td><td>Post</td></tr>
    <tr><td>1985</td><td>180.0000</td><td>7.425000</td><td>Post</td></tr>
    <tr><td>1986</td><td>187.7500</td><td>7.525000</td><td>Post</td></tr>
    <tr><td>1987</td><td>185.2500</td><td>7.425000</td><td>Post</td></tr>
    <tr><td>1988</td><td>210.0000</td><td>7.300000</td><td>Post</td></tr>
    <tr><td>1989</td><td>161.3333</td><td>7.213333</td><td>Post</td></tr>
    <tr><td>1990</td><td>211.2500</td><td>7.700000</td><td>Post</td></tr>
    <tr><td>1991</td><td>201.2500</td><td>7.400000</td><td>Post</td></tr>
    <tr><td>1992</td><td>163.2500</td><td>7.150000</td><td>Post</td></tr>
    <tr><td>1993</td><td>193.3333</td><td>7.300000</td><td>Post</td></tr>
    <tr><td>1994</td><td>162.2500</td><td>7.375000</td><td>Post</td></tr>
    <tr><td>1995</td><td>192.6667</td><td>7.033333</td><td>Post</td></tr>
    <tr><td>1996</td><td>161.8750</td><td>7.325000</td><td>Post</td></tr>
    <tr><td>1997</td><td>201.0714</td><td>7.557143</td><td>Post</td></tr>
    <tr><td>1998</td><td>191.1875</td><td>7.456250</td><td>Post</td></tr>
    <tr><td>1999</td><td>237.3333</td><td>7.091667</td><td>Post</td></tr>
    <tr><td>2000</td><td>222.3333</td><td>7.466667</td><td>Post</td></tr>
</tbody>
</table></div>
</div>
</div>
<div class="section" id="Plot-Histogram-of-yearly-average-Specific-Conductance-concentrations">
<h1>Plot Histogram of yearly average Specific Conductance concentrations<a class="headerlink" href="#Plot-Histogram-of-yearly-average-Specific-Conductance-concentrations" title="Permalink to this headline">¶</a></h1>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[192]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span><span class="n">histograms</span> <span class="o">&lt;-</span> <span class="nf">ggplot</span><span class="p">(</span><span class="n">Kanawha.yearly.averages</span> <span class="o">%&gt;%</span> <span class="nf">filter</span><span class="p">(</span><span class="o">!</span><span class="nf">is.na</span><span class="p">(</span><span class="n">bin</span><span class="p">)),</span> <span class="c1">#remove missing values</span>
       <span class="nf">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">SpC</span><span class="p">,</span> <span class="n">fill</span> <span class="o">=</span> <span class="n">bin</span><span class="p">))</span> <span class="o">+</span>
  <span class="nf">geom_histogram</span><span class="p">(</span><span class="n">alpha</span> <span class="o">=</span> <span class="m">0.8</span><span class="p">)</span> <span class="o">+</span>
  <span class="nf">ggtitle</span><span class="p">(</span><span class="s">&quot;Annual Averages of Specific Conductance in the Kanawha River 1958:1997&quot;</span><span class="p">)</span> <span class="o">+</span>
<span class="nf">theme</span><span class="p">(</span><span class="n">plot.title</span> <span class="o">=</span> <span class="nf">element_text</span><span class="p">(</span><span class="n">margin</span> <span class="o">=</span> <span class="nf">margin</span><span class="p">(</span><span class="n">b</span> <span class="o">=</span> <span class="m">10</span><span class="p">),</span> <span class="n">size</span> <span class="o">=</span> <span class="m">10</span><span class="p">,</span> <span class="n">hjust</span><span class="o">=</span><span class="m">0.5</span><span class="p">,</span> <span class="n">vjust</span><span class="o">=</span><span class="m">0.5</span><span class="p">,</span> <span class="n">face</span><span class="o">=</span><span class="s">&#39;bold&#39;</span><span class="p">),</span><span class="n">axis.text.x</span> <span class="o">=</span> <span class="nf">element_text</span><span class="p">(</span><span class="n">color</span> <span class="o">=</span> <span class="s">&quot;black&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="m">10</span><span class="p">),</span> <span class="n">axis.text.y</span> <span class="o">=</span> <span class="nf">element_text</span><span class="p">(</span><span class="n">color</span> <span class="o">=</span> <span class="s">&quot;black&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="m">10</span><span class="p">))</span><span class="o">+</span>
  <span class="nf">labs</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="nf">expression</span><span class="p">(</span><span class="s">&quot;Specific Conductance (&quot;</span><span class="o">*</span><span class="n">mu</span><span class="o">*</span><span class="n">S</span> <span class="o">*</span> <span class="n">cm</span><span class="o">**</span><span class="m">-1</span><span class="o">*</span><span class="s">&quot;)&quot;</span><span class="p">),</span>
       <span class="n">y</span> <span class="o">=</span> <span class="s">&quot;Count&quot;</span><span class="p">)</span> <span class="o">+</span>
  <span class="nf">scale_fill_manual</span><span class="p">(</span><span class="n">values</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="s">&quot;plum4&quot;</span><span class="p">,</span> <span class="s">&quot;seagreen4&quot;</span><span class="p">),</span>
                    <span class="n">name</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span>
                    <span class="n">breaks</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;Pre&quot;</span><span class="p">,</span> <span class="s">&quot;Post&quot;</span><span class="p">),</span>
                    <span class="n">labels</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;20 years before SMCRA&quot;</span><span class="p">,</span> <span class="s">&quot;20 years after SMCRA&quot;</span><span class="p">))</span>

<span class="nf">print</span><span class="p">(</span><span class="n">histograms</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.

</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../../../_images/gallery_R_Instructional_Impact_of_Mining_on_River_Water_Quality_notebooks_Impact_of_Mining_on_River_Water_Quality__39_1.png" class="no-scaled-link" src="../../../../../_images/gallery_R_Instructional_Impact_of_Mining_on_River_Water_Quality_notebooks_Impact_of_Mining_on_River_Water_Quality__39_1.png" style="width: 420px; height: 420px;" />
</div>
</div>
</div>
<div class="section" id="Plot-Density-Estimate-of-yearly-average-Specific-Conductance-concentrations">
<h1>Plot Density Estimate of yearly average Specific Conductance concentrations<a class="headerlink" href="#Plot-Density-Estimate-of-yearly-average-Specific-Conductance-concentrations" title="Permalink to this headline">¶</a></h1>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[193]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span><span class="n">densityplots</span> <span class="o">&lt;-</span> <span class="nf">ggplot</span><span class="p">(</span><span class="n">Kanawha.yearly.averages</span> <span class="o">%&gt;%</span> <span class="nf">filter</span><span class="p">(</span><span class="o">!</span><span class="nf">is.na</span><span class="p">(</span><span class="n">bin</span><span class="p">)),</span>
       <span class="nf">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">SpC</span><span class="p">,</span> <span class="n">fill</span> <span class="o">=</span> <span class="n">bin</span><span class="p">))</span> <span class="o">+</span>
  <span class="nf">geom_density</span><span class="p">(</span><span class="n">alpha</span> <span class="o">=</span> <span class="m">0.8</span><span class="p">)</span> <span class="o">+</span>
  <span class="nf">ggtitle</span><span class="p">(</span><span class="s">&quot;Annual Averages of Specific Conductance in the Kanawha River 1958:1997&quot;</span><span class="p">)</span> <span class="o">+</span>
<span class="nf">theme</span><span class="p">(</span><span class="n">plot.title</span> <span class="o">=</span> <span class="nf">element_text</span><span class="p">(</span><span class="n">margin</span> <span class="o">=</span> <span class="nf">margin</span><span class="p">(</span><span class="n">b</span> <span class="o">=</span> <span class="m">10</span><span class="p">),</span> <span class="n">size</span> <span class="o">=</span> <span class="m">10</span><span class="p">,</span> <span class="n">hjust</span><span class="o">=</span><span class="m">0.5</span><span class="p">,</span> <span class="n">vjust</span><span class="o">=</span><span class="m">0.5</span><span class="p">,</span> <span class="n">face</span><span class="o">=</span><span class="s">&#39;bold&#39;</span><span class="p">),</span><span class="n">axis.text.x</span> <span class="o">=</span> <span class="nf">element_text</span><span class="p">(</span><span class="n">color</span> <span class="o">=</span> <span class="s">&quot;black&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="m">10</span><span class="p">),</span> <span class="n">axis.text.y</span> <span class="o">=</span> <span class="nf">element_text</span><span class="p">(</span><span class="n">color</span> <span class="o">=</span> <span class="s">&quot;black&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="m">10</span><span class="p">))</span><span class="o">+</span>
  <span class="nf">labs</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="nf">expression</span><span class="p">(</span><span class="s">&quot;Specific Conductance (&quot;</span><span class="o">*</span><span class="n">mu</span><span class="o">*</span><span class="n">S</span> <span class="o">*</span> <span class="n">cm</span><span class="o">**</span><span class="m">-1</span><span class="o">*</span><span class="s">&quot;)&quot;</span><span class="p">),</span>
       <span class="n">y</span> <span class="o">=</span> <span class="s">&quot;Probability Density&quot;</span><span class="p">)</span> <span class="o">+</span>
  <span class="nf">scale_fill_manual</span><span class="p">(</span><span class="n">values</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="s">&quot;plum4&quot;</span><span class="p">,</span> <span class="s">&quot;seagreen4&quot;</span><span class="p">),</span>
                    <span class="n">name</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span>
                    <span class="n">breaks</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;Pre&quot;</span><span class="p">,</span> <span class="s">&quot;Post&quot;</span><span class="p">),</span>
                    <span class="n">labels</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;20 years before SMCRA&quot;</span><span class="p">,</span> <span class="s">&quot;20 years after SMCRA&quot;</span><span class="p">))</span>

<span class="nf">print</span><span class="p">(</span><span class="n">densityplots</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../../../_images/gallery_R_Instructional_Impact_of_Mining_on_River_Water_Quality_notebooks_Impact_of_Mining_on_River_Water_Quality__41_0.png" class="no-scaled-link" src="../../../../../_images/gallery_R_Instructional_Impact_of_Mining_on_River_Water_Quality_notebooks_Impact_of_Mining_on_River_Water_Quality__41_0.png" style="width: 420px; height: 420px;" />
</div>
</div>
<p>How did Specific Conductance change after SMCRA was enacted? &gt;</p>
</div>
<div class="section" id="Plot-Histogram-of-yearly-average-pH-concentrations">
<h1>Plot Histogram of yearly average pH concentrations<a class="headerlink" href="#Plot-Histogram-of-yearly-average-pH-concentrations" title="Permalink to this headline">¶</a></h1>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[194]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span><span class="n">histograms2</span> <span class="o">&lt;-</span> <span class="nf">ggplot</span><span class="p">(</span><span class="n">Kanawha.yearly.averages</span> <span class="o">%&gt;%</span> <span class="nf">filter</span><span class="p">(</span><span class="o">!</span><span class="nf">is.na</span><span class="p">(</span><span class="n">bin</span><span class="p">)),</span> <span class="c1">#remove missing values</span>
       <span class="nf">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">pH</span><span class="p">,</span> <span class="n">fill</span> <span class="o">=</span> <span class="n">bin</span><span class="p">))</span> <span class="o">+</span>
  <span class="nf">geom_histogram</span><span class="p">(</span><span class="n">alpha</span> <span class="o">=</span> <span class="m">0.8</span><span class="p">)</span> <span class="o">+</span>
  <span class="nf">ggtitle</span><span class="p">(</span><span class="s">&quot;Annual Averages of pH in the Kanawha River 1958:1997&quot;</span><span class="p">)</span> <span class="o">+</span>
<span class="nf">theme</span><span class="p">(</span><span class="n">plot.title</span> <span class="o">=</span> <span class="nf">element_text</span><span class="p">(</span><span class="n">margin</span> <span class="o">=</span> <span class="nf">margin</span><span class="p">(</span><span class="n">b</span> <span class="o">=</span> <span class="m">10</span><span class="p">),</span> <span class="n">size</span> <span class="o">=</span> <span class="m">13</span><span class="p">,</span> <span class="n">hjust</span><span class="o">=</span><span class="m">0.5</span><span class="p">,</span> <span class="n">vjust</span><span class="o">=</span><span class="m">0.5</span><span class="p">,</span> <span class="n">face</span><span class="o">=</span><span class="s">&#39;bold&#39;</span><span class="p">),</span><span class="n">axis.text.x</span> <span class="o">=</span> <span class="nf">element_text</span><span class="p">(</span><span class="n">color</span> <span class="o">=</span> <span class="s">&quot;black&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="m">10</span><span class="p">),</span> <span class="n">axis.text.y</span> <span class="o">=</span> <span class="nf">element_text</span><span class="p">(</span><span class="n">color</span> <span class="o">=</span> <span class="s">&quot;black&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="m">10</span><span class="p">))</span><span class="o">+</span>
  <span class="nf">labs</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="nf">expression</span><span class="p">(</span><span class="s">&quot;pH&quot;</span><span class="p">),</span>
       <span class="n">y</span> <span class="o">=</span> <span class="s">&quot;Count&quot;</span><span class="p">)</span> <span class="o">+</span>
  <span class="nf">scale_fill_manual</span><span class="p">(</span><span class="n">values</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="s">&quot;plum4&quot;</span><span class="p">,</span> <span class="s">&quot;seagreen4&quot;</span><span class="p">),</span>
                    <span class="n">name</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span>
                    <span class="n">breaks</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;Pre&quot;</span><span class="p">,</span> <span class="s">&quot;Post&quot;</span><span class="p">),</span>
                    <span class="n">labels</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;20 years before SMCRA&quot;</span><span class="p">,</span> <span class="s">&quot;20 years after SMCRA&quot;</span><span class="p">))</span>

<span class="nf">print</span><span class="p">(</span><span class="n">histograms2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.

</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../../../_images/gallery_R_Instructional_Impact_of_Mining_on_River_Water_Quality_notebooks_Impact_of_Mining_on_River_Water_Quality__44_1.png" class="no-scaled-link" src="../../../../../_images/gallery_R_Instructional_Impact_of_Mining_on_River_Water_Quality_notebooks_Impact_of_Mining_on_River_Water_Quality__44_1.png" style="width: 420px; height: 420px;" />
</div>
</div>
</div>
<div class="section" id="Plot-Density-Estimate-of-yearly-average-pH-concentrations">
<h1>Plot Density Estimate of yearly average pH concentrations<a class="headerlink" href="#Plot-Density-Estimate-of-yearly-average-pH-concentrations" title="Permalink to this headline">¶</a></h1>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[195]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span><span class="n">densityplots2</span> <span class="o">&lt;-</span> <span class="nf">ggplot</span><span class="p">(</span><span class="n">Kanawha.yearly.averages</span> <span class="o">%&gt;%</span> <span class="nf">filter</span><span class="p">(</span><span class="o">!</span><span class="nf">is.na</span><span class="p">(</span><span class="n">bin</span><span class="p">)),</span>
       <span class="nf">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">pH</span><span class="p">,</span> <span class="n">fill</span> <span class="o">=</span> <span class="n">bin</span><span class="p">))</span> <span class="o">+</span>
  <span class="nf">geom_density</span><span class="p">(</span><span class="n">alpha</span> <span class="o">=</span> <span class="m">0.8</span><span class="p">)</span> <span class="o">+</span>
  <span class="nf">ggtitle</span><span class="p">(</span><span class="s">&quot;Annual Averages of pH in the Kanawha River 1958:1997&quot;</span><span class="p">)</span> <span class="o">+</span>
<span class="nf">theme</span><span class="p">(</span><span class="n">plot.title</span> <span class="o">=</span> <span class="nf">element_text</span><span class="p">(</span><span class="n">margin</span> <span class="o">=</span> <span class="nf">margin</span><span class="p">(</span><span class="n">b</span> <span class="o">=</span> <span class="m">10</span><span class="p">),</span> <span class="n">size</span> <span class="o">=</span> <span class="m">13</span><span class="p">,</span> <span class="n">hjust</span><span class="o">=</span><span class="m">0.5</span><span class="p">,</span> <span class="n">vjust</span><span class="o">=</span><span class="m">0.5</span><span class="p">,</span> <span class="n">face</span><span class="o">=</span><span class="s">&#39;bold&#39;</span><span class="p">),</span><span class="n">axis.text.x</span> <span class="o">=</span> <span class="nf">element_text</span><span class="p">(</span><span class="n">color</span> <span class="o">=</span> <span class="s">&quot;black&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="m">10</span><span class="p">),</span> <span class="n">axis.text.y</span> <span class="o">=</span> <span class="nf">element_text</span><span class="p">(</span><span class="n">color</span> <span class="o">=</span> <span class="s">&quot;black&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="m">10</span><span class="p">))</span><span class="o">+</span>
  <span class="nf">labs</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="nf">expression</span><span class="p">(</span><span class="s">&quot;pH&quot;</span><span class="p">),</span>
       <span class="n">y</span> <span class="o">=</span> <span class="s">&quot;Probability Density&quot;</span><span class="p">)</span> <span class="o">+</span>
  <span class="nf">scale_fill_manual</span><span class="p">(</span><span class="n">values</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="s">&quot;plum4&quot;</span><span class="p">,</span> <span class="s">&quot;seagreen4&quot;</span><span class="p">),</span>
                    <span class="n">name</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span>
                    <span class="n">breaks</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;Pre&quot;</span><span class="p">,</span> <span class="s">&quot;Post&quot;</span><span class="p">),</span>
                    <span class="n">labels</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;20 years before SMCRA&quot;</span><span class="p">,</span> <span class="s">&quot;20 years after SMCRA&quot;</span><span class="p">))</span>

<span class="nf">print</span><span class="p">(</span><span class="n">densityplots2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../../../_images/gallery_R_Instructional_Impact_of_Mining_on_River_Water_Quality_notebooks_Impact_of_Mining_on_River_Water_Quality__46_0.png" class="no-scaled-link" src="../../../../../_images/gallery_R_Instructional_Impact_of_Mining_on_River_Water_Quality_notebooks_Impact_of_Mining_on_River_Water_Quality__46_0.png" style="width: 420px; height: 420px;" />
</div>
</div>
<p>How did pH change after SMCRA was enacted? &gt;</p>
</div>


           </div>
           
          </div>
          <!-- 
This file modifies the default sphinx_rtd_theme footer
-->



<footer>
  

  <hr/>

  <div role="contentinfo">
    <p>

    </p>
  </div>
  <!-- your html code here -->


</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>